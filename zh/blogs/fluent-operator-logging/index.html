<!doctype html><html lang=en-US><head><meta charset=utf-8><title>Fluent Operator å…¥é—¨æ•™ç¨‹</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Fluent Operator å¯ä»¥å•ç‹¬éƒ¨ç½² Fluent Bit æˆ–è€… Fluentdï¼Œå¹¶ä¸ä¼šå¼ºåˆ¶è¦æ±‚ä½¿ç”¨ Fluent Bit æˆ– Fluentdï¼ŒåŒæ—¶è¿˜æ”¯æŒä½¿ç”¨ Fluentd æ¥æ”¶ Fluent Bit è½¬å‘çš„æ—¥å¿—æµè¿›è¡Œå¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»ï¼Œè¿™æå¤§åœ°å¢åŠ äº†éƒ¨ç½²çš„çµæ´»æ€§å’Œå¤šæ ·æ€§ã€‚"><meta name=keywords content="Kubernetes,KubeSphere,Fluent Operator,æ—¥å¿—é‡‡é›†,æ—¥å¿—æŸ¥è¯¢"><meta property="og:type" content="article"><meta property="og:title" content="Fluent Operator å…¥é—¨æ•™ç¨‹"><meta property="og:description" content="Fluent Operator å¯ä»¥å•ç‹¬éƒ¨ç½² Fluent Bit æˆ–è€… Fluentdï¼Œå¹¶ä¸ä¼šå¼ºåˆ¶è¦æ±‚ä½¿ç”¨ Fluent Bit æˆ– Fluentdï¼ŒåŒæ—¶è¿˜æ”¯æŒä½¿ç”¨ Fluentd æ¥æ”¶ Fluent Bit è½¬å‘çš„æ—¥å¿—æµè¿›è¡Œå¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»ï¼Œè¿™æå¤§åœ°å¢åŠ äº†éƒ¨ç½²çš„çµæ´»æ€§å’Œå¤šæ ·æ€§ã€‚"><meta property="og:image" content="https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-logging-cover.png"><meta property="og:url" content="https://openksc.github.io/zh/blogs/fluent-operator-logging/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@KubeSphere"><meta property="twitter:image" content="https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-logging-cover.png"><meta name=docsearch:language content="zh-CN"><meta name=docsearch:version content><link rel=canonical href=https://kubesphere.io/zh/blogs/fluent-operator-logging/><link rel="shortcut icon" href=/images/favicons/favicon.ico><link rel=apple-touch-icon href=/images/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/svg+xml href=/images/favicons/favicon.svg><link rel=icon type=image/png href=/images/favicons/favicon.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg color=#00ad6e><meta name=msapplication-config content='/images/favicons/browserconfig.xml'><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/fonts/Roboto/stylesheet.css><link rel=stylesheet href=/fonts/ProximaNova/stylesheet.css><link rel=stylesheet href=/css/jquery.modal.min.css><link rel=stylesheet href=/css/viewer.min.css><link rel=stylesheet href=/swiper/swiper-bundle.min.css><link rel=stylesheet href=/scss/common.min.0c3fdcc05ec210321169846714f74b11c4a1baf09a1833fa9273b2347c81e636.css><script src=/js/jquery-3.7.1.min.js></script><script src=/js/viewer.min.js></script><script src=/js/jquery.modal.min.js></script><script src=/swiper/swiper-bundle.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?0888981f1fa45d241b1fb6962da2963e",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YYCVN36HT5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YYCVN36HT5")</script><script type=text/javascript>!function(e,t,n,s,o){e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},n=t.createElement("script"),tag=t.getElementsByTagName("script")[0],n.async=1,n.src=("https:"==document.location.protocol?"https://":"http://")+s,tag.parentNode.insertBefore(n,tag)}(window,document,"script","assets.giocdn.com/2.1/gio.js","gio"),gio("init","8a24ae300cbf8b8c",{}),gio("send")</script><link rel=stylesheet href=/scss/content.min.f73b326fbf8c5bd331900b0de21c7dde608a4926f482f6465f9ae1d9049b83ad.css><link rel=stylesheet href=/scss/markdown.min.db47186481122431dffae72d17dbbd51f90b66f022cc163458645709924e4eac.css></head><body><header class=navigation><div class=join-div><div class=content>ğŸš€ KubeSphere v4.1.3 å‘å¸ƒï¼Œå¤šé¡¹ä¼˜åŒ–ä¸æ”¹è¿›ï¼Œæ¬¢è¿ä½“éªŒï¼<a href=/zh/docs/v4.1/20-release-notes/release-v413/ target=_blank rel="noopener noreferrer">è¯·æŸ¥çœ‹ Release notes â†’</a>
<img id=close-join src=/images/header/close.svg alt=close></div></div><div class=common-layout><div class=header-container><a href=/zh/ aria-label=logo><img src=/images/header/logo.svg alt class=logo></a><ul class=nav><li class=menu-li><span class=menu-span>åº”ç”¨åœºæ™¯</span><ul class="dropdown-menu menu-2"><li><a href=/zh/devops/>æ‹¥æŠ±ä¸€ç«™å¼ DevOps å·¥ä½œæµ</a></li><li><a href=/zh/service-mesh/>åœ¨ Kubernetes è¿è¡Œå¾®æœåŠ¡</a></li><li><a href=/zh/observability/>æ„å»ºä¸°å¯Œçš„äº‘åŸç”Ÿå¯è§‚æµ‹æ€§</a></li></ul></li><li class=menu-li><span class=menu-span>èµ„æº</span><ul class="dropdown-menu menu-3"><li><a href=/zh/projects/>å¼€æºé¡¹ç›®</a></li><li><a href=/zh/conferences/>å¼€æºå³°ä¼š</a></li><li><a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a></li><li><a href=/zh/videos/>è§†é¢‘èµ„æº</a></li><li><a href=/zh/learn/>äº‘åŸç”Ÿå®æˆ˜</a></li></ul></li><li class=menu-li><span class=menu-span>æ–‡æ¡£ä¸­å¿ƒ</span><ul class="dropdown-menu menu-4"><li><a href=/zh/docs/v4.1>v4.1 <img src=/images/header/star.svg alt=star></a></li><li><a href=/zh/docs/v3.4>v3.4</a></li><li><a href=/zh/docs/v3.3>v3.3</a></li><li><a href=https://dev-guide.kubesphere.io/extension-dev-guide/zh/ target=_blank rel="noopener noreferrer">æ‰©å±•ç»„ä»¶å¼€å‘</a></li><li><a href=https://kube.design/ target=_blank rel="noopener noreferrer">Kube Design</a></li></ul></li><li class=menu-li><span class=menu-span>å¼€æºç¤¾åŒº</span><ul class="dropdown-menu menu-5"><li><a href=/zh/contribution/>å‚ä¸è´¡çŒ®</a></li><li><a href=/zh/live/>ç¤¾åŒºæ´»åŠ¨</a></li><li><a href=/zh/case/>æ¡ˆä¾‹å­¦ä¹ </a></li><li><a href=/zh/partner/>åˆä½œä¼™ä¼´</a></li><li><a href=/zh/user-group/>ç”¨æˆ·å§”å‘˜ä¼š</a></li><li><a href=/zh/news/>åŠ¨æ€</a></li><li><a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md target=_blank rel="noopener noreferrer">ç‰ˆæœ¬è®¡åˆ’</a></li><li><a href=https://www.kubesphere.io/zh/ target=_blank rel="noopener noreferrer">ä¸­å›½ç«™</a></li><li><a href=https://github.com/kubesphere/community/tree/master/sig-advocacy-and-outreach/ospp-2025 target=_blank rel="noopener noreferrer">å¼€æºä¹‹å¤ 2025</a></li></ul></li><li><a data-docs=ç”¨æˆ·è®ºå› href=https://ask.kubesphere.io/forum target=_blank rel="noopener noreferrer">ç”¨æˆ·è®ºå›</a></li><li><a data-docs=è®¤è¯ href=https://kubesphere.cloud/certification/ target=_blank rel="noopener noreferrer">è®¤è¯</a></li></ul><div class=right-menu><ul><li class=language-menu><div><img src=/images/header/black.svg alt>
<span>ç®€ä½“ä¸­æ–‡</span></div><ul class=dropdown-menu><li onclick='handleLangClick("zh","/zh/blogs/fluent-operator-logging/")'>ç®€ä½“ä¸­æ–‡</li></ul></li><li class=github-li><div class=github-star><a class=star-btn href=https://github.com/kubesphere/kubesphere rel="noopener noreferrer" target=_blank><span class=star-img></span>&nbsp;<span>Star</span>
</a><a class=social-count href=https://github.com/kubesphere/kubesphere/stargazers rel="noopener noreferrer" target=_blank></a></div></li><li class=menu-icon><img src=/images/header/menu.svg alt></li></ul></div></div></div><div id=modal-for-menu class=modal><ul class=nav><li data-check=0 class=menu-li><span class=menu-span>åº”ç”¨åœºæ™¯</span><ul class=dropdown-menu><li><a href=/zh/devops/>æ‹¥æŠ±ä¸€ç«™å¼ DevOps å·¥ä½œæµ</a></li><li><a href=/zh/service-mesh/>åœ¨ Kubernetes è¿è¡Œå¾®æœåŠ¡</a></li><li><a href=/zh/observability/>æ„å»ºä¸°å¯Œçš„äº‘åŸç”Ÿå¯è§‚æµ‹æ€§</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>èµ„æº</span><ul class=dropdown-menu><li><a href=/zh/projects/>å¼€æºé¡¹ç›®</a></li><li><a href=/zh/conferences/>å¼€æºå³°ä¼š</a></li><li><a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a></li><li><a href=/zh/videos/>è§†é¢‘èµ„æº</a></li><li><a href=/zh/learn/>äº‘åŸç”Ÿå®æˆ˜</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>æ–‡æ¡£ä¸­å¿ƒ</span><ul class=dropdown-menu><li><a href=/zh/docs/v4.1>v4.1 <img src=/images/header/star.svg alt=star></a></li><li><a href=/zh/docs/v3.4>v3.4</a></li><li><a href=/zh/docs/v3.3>v3.3</a></li><li><a href=https://dev-guide.kubesphere.io/extension-dev-guide/zh/>æ‰©å±•ç»„ä»¶å¼€å‘</a></li><li><a href=https://kube.design/>Kube Design</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>å¼€æºç¤¾åŒº</span><ul class=dropdown-menu><li><a href=/zh/contribution/>å‚ä¸è´¡çŒ®</a></li><li><a href=/zh/live/>ç¤¾åŒºæ´»åŠ¨</a></li><li><a href=/zh/case/>æ¡ˆä¾‹å­¦ä¹ </a></li><li><a href=/zh/partner/>åˆä½œä¼™ä¼´</a></li><li><a href=/zh/user-group/>ç”¨æˆ·å§”å‘˜ä¼š</a></li><li><a href=/zh/news/>åŠ¨æ€</a></li><li><a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md>ç‰ˆæœ¬è®¡åˆ’</a></li><li><a href=https://www.kubesphere.io/zh/>ä¸­å›½ç«™</a></li><li><a href=https://github.com/kubesphere/community/tree/master/sig-advocacy-and-outreach/ospp-2025>å¼€æºä¹‹å¤ 2025</a></li></ul></li><li><a data-docs=ç”¨æˆ·è®ºå› href=https://ask.kubesphere.io/forum>ç”¨æˆ·è®ºå›</a></li><li><a data-docs=è®¤è¯ href=https://kubesphere.cloud/certification/>è®¤è¯</a></li></ul><div class=link-div><a href=https://join.slack.com/t/kubesphere/shared_invite/zt-2b4t6rdb4-ico_4UJzCln_S2c1pcrIpQ target=_blank rel="noopener noreferrer" aria-label=slack><img src=/images/header/slack-hover.svg alt>
</a><a href=https://x.com/KubeSphere target=_blank rel="noopener noreferrer" aria-label=twitter><img src=/images/header/twitter-hover.svg alt>
</a><a href=https://github.com/kubesphere/kubesphere target=_blank rel="noopener noreferrer" aria-label=github><img src=/images/header/github-hover.svg alt></a></div></div></header><script>var bindNavMouseEvent,bindScrollChangeHeader,bindClickShowMenu,bindClickModalLi,bindClickClose,language,handleLangClick,githubApiLink="https://api.github.com/repos/kubesphere/kubesphere",getStar=function(){$(".social-count").hide(),$.getJSON(githubApiLink,function(e){$(".social-count").show().html(e.stargazers_count)})};getStar(),bindNavMouseEvent=function(e,t){t||(t=$(e));var n=!1;t.mouseenter(function(){if(n)return!1;n=!0,$(this).find(".dropdown-menu").fadeIn(200,function(){n=!1})}),t.mouseleave(function(){$(this).find(".dropdown-menu").fadeOut(200)})},bindScrollChangeHeader=function(){var t=100,e=$("header");window.addEventListener("scroll",function(){var t=window.scrollY;t>0?e.addClass("navigationScroll"):e.removeClass("navigationScroll")})},bindClickShowMenu=function(){$(".menu-icon").click(function(){$("#modal-for-menu").modal()})},bindClickModalLi=function(){$(".modal .menu-li").click(function(){var e=$(this).data("check");e===0?($(this).data("check",1),$(this).find(".dropdown-menu").slideDown(200)):($(this).data("check",0),$(this).find(".dropdown-menu").slideUp(200)),$(this).find(".menu-span").toggleClass("up")})},bindClickClose=function(){$("#close-join").click(function(){$(".navigation .join-div").hide(),$(".main-section").removeClass("padding")})},language="zh",bindClickClose(),bindScrollChangeHeader(),$(".header-container .menu-li").each(function(){bindNavMouseEvent("",$(this))}),bindNavMouseEvent(".header-container .language-menu"),bindNavMouseEvent(".header-container .btn-li"),bindClickShowMenu(),bindClickModalLi(),handleLangClick=function(e,t){try{localStorage.setItem("lang",e)}catch{}location.href=t}</script><section class=main-section><div class=common-layout><div class=breadcrumb><span><a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a> > </span><span>Fluent Operator å…¥é—¨æ•™ç¨‹</span></div><div class='main-div middle-div'><div class=author>ç¨‹å¾·æ˜Š</div><span class=date>å‘å¸ƒäºï¼š2022-04-14</span>&nbsp;&nbsp;&nbsp;
<span style=font-size:14px;color:#919aa3 id=busuanzi_container_page_pv>æœ¬æ–‡æ€»é˜…è¯»é‡ï¼š<span id=busuanzi_value_page_pv></span></span><h1>Fluent Operator å…¥é—¨æ•™ç¨‹</h1><div class=share-1><div class=share><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f&text=Fluent%20Operator%20%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" target=_blank rel="noopener noreferrer"><img src=/images/share/Twitter.svg alt="twitter icon">
</a><a href="https://reddit.com/submit?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f&title=Fluent%20Operator%20%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" target=_blank rel="noopener noreferrer"><img src=/images/share/Reddit.svg alt="reddit icon">
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Facebook.svg alt="facebook icon">
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Linkedin.svg alt="linkedin icon">
</a><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f&t=Fluent%20Operator%20%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" target=_blank rel="noopener noreferrer"><img src=/images/share/HackerNews.svg alt="hackernews icon"></a></div></div><div class=content><div class=md-body><h2 id=fluent-operator-ä»‹ç»>Fluent Operatorâ€‹ ä»‹ç»</h2><p>éšç€äº‘åŸç”ŸæŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼ŒæŠ€æœ¯çš„ä¸æ–­è¿­ä»£ï¼Œå¯¹äºæ—¥å¿—çš„é‡‡é›†ã€å¤„ç†åŠè½¬å‘æå‡ºäº†æ›´é«˜çš„è¦æ±‚ã€‚äº‘åŸç”Ÿæ¶æ„ä¸‹çš„æ—¥å¿—æ–¹æ¡ˆç›¸æ¯”åŸºäºç‰©ç†æœºæˆ–è€…æ˜¯è™šæ‹Ÿæœºåœºæ™¯çš„æ—¥å¿—æ¶æ„è®¾è®¡å­˜åœ¨å¾ˆå¤§å·®åˆ«ã€‚ä½œä¸º CNCF çš„æ¯•ä¸šé¡¹ç›®ï¼ŒFluent Bit æ— ç–‘ä¸ºè§£å†³äº‘ç¯å¢ƒä¸­çš„æ—¥å¿—è®°å½•é—®é¢˜çš„é¦–é€‰è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚ä½†æ˜¯åœ¨ Kubernetes ä¸­å®‰è£…éƒ¨ç½²ä»¥åŠé…ç½® Fluent Bit éƒ½å…·æœ‰ä¸€å®šçš„é—¨æ§›ï¼ŒåŠ å¤§äº†ç”¨æˆ·çš„ä½¿ç”¨æˆæœ¬ã€‚</p><p><strong>2019 å¹´ 1 æœˆ 21 æ—¥</strong>ï¼ŒKubeSphere ç¤¾åŒºä¸ºäº†æ»¡è¶³ä»¥äº‘åŸç”Ÿçš„æ–¹å¼ç®¡ç† Fluent Bit çš„éœ€æ±‚å¼€å‘äº† <strong>Fluentbit Operator</strong>ï¼Œå¹¶åœ¨ 2020 å¹´ 2 æœˆ 17 æ—¥å‘å¸ƒäº† v0.1.0 ç‰ˆæœ¬ã€‚æ­¤åäº§å“ä¸æ–­è¿­ä»£ï¼Œåœ¨ <strong>2021 å¹´ 8 æœˆ 4 æ—¥</strong> æ­£å¼å°† Fluentbit Operator æçŒ®ç»™ Fluent ç¤¾åŒºã€‚</p><p>Fluentbit Operator é™ä½äº† Fluent Bit çš„ä½¿ç”¨é—¨æ§›ï¼Œèƒ½é«˜æ•ˆã€å¿«æ·çš„å¤„ç†æ—¥å¿—ä¿¡æ¯ï¼Œä½†æ˜¯ Fluent Bit å¤„ç†æ—¥å¿—çš„èƒ½åŠ›ç¨å¼±ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰é›†æˆæ—¥å¿—å¤„ç†å·¥å…·ï¼Œæ¯”å¦‚ Fluentdï¼Œå®ƒæœ‰æ›´å¤šçš„æ’ä»¶å¯ä¾›ä½¿ç”¨ã€‚åŸºäºä»¥ä¸Šéœ€æ±‚ï¼ŒFluentbit Operator é›†æˆäº† Fluentdï¼Œæ—¨åœ¨å°† Fluentd é›†æˆä¸ºä¸€ä¸ªå¯é€‰çš„æ—¥å¿—èšåˆå’Œè½¬å‘å±‚ï¼Œå¹¶é‡æ–°å‘½åä¸º <strong>Fluent Operatorï¼ˆGitHub åœ°å€ï¼š <a href=https://github.com/fluent/fluent-operator target=_blank rel="noopener noreferrer">https://github.com/fluent/fluent-operator</a>ï¼‰</strong>ã€‚åœ¨ 2022 å¹´ 3 æœˆ 25 æ—¥ Fluent Operator å‘å¸ƒäº† v1.0.0 ç‰ˆæœ¬ï¼Œå¹¶å°†ç»§ç»­è¿­ä»£ Fluentd Operatorï¼Œé¢„è®¡åœ¨ 2022 å¹´ç¬¬ 2 å­£åº¦å‘å¸ƒ v1.1.0 ç‰ˆæœ¬ï¼Œå¢åŠ æ›´å¤šçš„åŠŸèƒ½ä¸äº®ç‚¹ã€‚</p><p>ä½¿ç”¨ Fluent Operator å¯ä»¥çµæ´»ä¸”æ–¹ä¾¿åœ°éƒ¨ç½²ã€é…ç½®åŠå¸è½½ Fluent Bit ä»¥åŠ Fluentdã€‚åŒæ—¶, ç¤¾åŒºè¿˜æä¾›æ”¯æŒ Fluentd ä»¥åŠ Fluent Bit çš„æµ·é‡æ’ä»¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œå®šåˆ¶åŒ–é…ç½®ã€‚å®˜æ–¹æ–‡æ¡£æä¾›äº†è¯¦ç»†çš„ç¤ºä¾‹ï¼Œææ˜“ä¸Šæ‰‹ï¼Œå¤§å¤§é™ä½äº† Fluent Bit ä»¥åŠ Fluentd çš„ä½¿ç”¨é—¨æ§›ã€‚</p><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-2022-1.png alt></p><h3 id=æ—¥å¿—æµæ°´çº¿çš„å„ä¸ªé˜¶æ®µ>æ—¥å¿—æµæ°´çº¿çš„å„ä¸ªé˜¶æ®µ</h3><p>Fluent Operator å¯ä»¥å•ç‹¬éƒ¨ç½² Fluent Bit æˆ–è€… Fluentdï¼Œå¹¶ä¸ä¼šå¼ºåˆ¶è¦æ±‚ä½¿ç”¨ Fluent Bit æˆ– Fluentdï¼ŒåŒæ—¶è¿˜æ”¯æŒä½¿ç”¨ Fluentd æ¥æ”¶ Fluent Bit è½¬å‘çš„æ—¥å¿—æµè¿›è¡Œå¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»ï¼Œè¿™æå¤§åœ°å¢åŠ äº†éƒ¨ç½²çš„çµæ´»æ€§å’Œå¤šæ ·æ€§ã€‚ ä¸ºäº†æ›´å…¨é¢çš„äº†è§£ Fluent Operatorï¼Œä¸‹å›¾ä»¥å®Œæ•´çš„æ—¥å¿—æµæ°´çº¿ä¸ºä¾‹ï¼Œå°†æµæ°´çº¿åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šé‡‡é›†å’Œè½¬å‘ã€è¿‡æ»¤ä»¥åŠè¾“å‡ºã€‚</p><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-2022-2.png alt></p><h4 id=é‡‡é›†å’Œè½¬å‘>é‡‡é›†å’Œè½¬å‘</h4><p>Fluent Bit ä¸ Fluentd å‡å¯ä»¥é‡‡é›†æ—¥å¿—ã€‚</p><p>å•ç‹¬éƒ¨ç½²æ—¶ï¼Œå¯ä»¥é€šè¿‡ Fluent Bit çš„ intput æ’ä»¶æˆ–è€… Fluentd çš„ forward ä»¥åŠ http ç­‰æ’ä»¶æ¥æ»¡è¶³å¯¹æ—¥å¿—æ”¶é›†çš„éœ€æ±‚ã€‚ä¸¤è€…ç»“åˆæ—¶ï¼ŒFluentd å¯ä½¿ç”¨ forward æ¥å— Fluent Bit çš„æ—¥å¿—æµè½¬å‘ã€‚</p><p>åœ¨æ€§èƒ½æ–¹é¢ï¼ŒFluent Bit ç›¸æ¯” Fluentd æ›´è½»é‡ï¼Œå†…å­˜æ¶ˆè€—æ›´å°ï¼ˆçº¦ä¸º 650KBï¼‰ï¼Œæ‰€ä»¥ä¸»è¦ç”± Fluent Bit è´Ÿè´£é‡‡é›†ä¸è½¬å‘æ—¥å¿—ã€‚åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šé€šè¿‡ä»¥ DaemonSet å½¢å¼å®‰è£…çš„ Fluent Bit æ¥æ”¶é›†å’Œè½¬å‘æ—¥å¿—ã€‚</p><h4 id=è¿‡æ»¤>è¿‡æ»¤</h4><p>æ—¥å¿—æ”¶é›†çš„æ•°æ®å¾€å¾€è¿‡äºæ‚ä¹±ä¸å†—ä½™ï¼Œè¿™è¦æ±‚æ—¥å¿—å¤„ç†ä¸­é—´ä»¶æä¾›å¯¹æ—¥å¿—ä¿¡æ¯è¿›è¡Œè¿‡æ»¤å’Œå¤„ç†çš„èƒ½åŠ›ã€‚Fluent Bit æˆ– Fluentd å‡æ”¯æŒ filter æ’ä»¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œæ•´åˆå’Œå®šåˆ¶æ—¥å¿—æ•°æ®ã€‚</p><h4 id=è¾“å‡º>è¾“å‡º</h4><p>Fluent Bit output æˆ– Fluentd output æ’ä»¶å°†å¤„ç†åçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°å¤šä¸ªç›®çš„åœ°ï¼Œç›®çš„åœ°å¯ä»¥æ˜¯ Kafkaã€Elasticsearch ç­‰ç¬¬ä¸‰æ–¹ç»„ä»¶ã€‚</p><h3 id=crd-ç®€ä»‹>CRD ç®€ä»‹</h3><p>Fluent Operator ä¸º Fluent Bit å’Œ Fluentd åˆ†åˆ«å®šä¹‰äº†ä¸¤ä¸ª Groupï¼šfluentbit.fluent.io å’Œ fluentd.fluent.ioã€‚</p><h4 id=fluentbitfluentio>fluentbit.fluent.io</h4><p>fluentbit.fluent.ioâ€‹ åˆ†ç»„ä¸‹åŒ…å«ä»¥ä¸‹ 6 ä¸ª CRDsï¼š</p><ul><li>Fluentbit CRD å®šä¹‰äº† Fluent Bit çš„å±æ€§ï¼Œæ¯”å¦‚é•œåƒç‰ˆæœ¬ã€æ±¡ç‚¹ã€äº²å’Œæ€§ç­‰å‚æ•°ã€‚</li><li>ClusterFluentbitConfig CRD å®šä¹‰äº† Fluent Bit çš„é…ç½®æ–‡ä»¶ã€‚</li><li>ClusterInput CRD å®šä¹‰äº† Fluent Bit çš„ input æ’ä»¶ï¼Œå³è¾“å…¥æ’ä»¶ã€‚é€šè¿‡è¯¥æ’ä»¶ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰é‡‡é›†ä½•ç§æ—¥å¿—ã€‚</li><li>ClusterFilter CRD å®šä¹‰äº† Fluent Bit çš„ filter æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£è¿‡æ»¤ä»¥åŠå¤„ç† fluentbit é‡‡é›†åˆ°çš„ä¿¡æ¯ã€‚</li><li>ClusterParser CRD å®šä¹‰äº† Fluent Bit çš„ parser æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£è§£ææ—¥å¿—ä¿¡æ¯ï¼Œå¯ä»¥å°†æ—¥å¿—ä¿¡æ¯è§£æä¸ºå…¶ä»–æ ¼å¼ã€‚</li><li>ClusterOutput CRD å®šä¹‰äº† Fluent Bit çš„ output æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£å°†å¤„ç†åçš„æ—¥å¿—ä¿¡æ¯è½¬å‘åˆ°ç›®çš„åœ°ã€‚</li></ul><h5 id=fluentdfluentio>fluentd.fluent.io</h5><p>fluentd.fluent.ioâ€‹ åˆ†ç»„ä¸‹åŒ…å«ä»¥ä¸‹ 7 ä¸ª CRDsï¼š</p><ul><li>Fluentd CRD å®šä¹‰äº† Fluentd çš„å±æ€§ï¼Œæ¯”å¦‚é•œåƒç‰ˆæœ¬ã€æ±¡ç‚¹ã€äº²å’Œæ€§ç­‰å‚æ•°ã€‚</li><li>ClusterFluentdConfig CRD å®šä¹‰äº† Fluentd é›†ç¾¤çº§åˆ«çš„é…ç½®æ–‡ä»¶ã€‚</li><li>FluentdConfig CRD å®šä¹‰äº† Fluentd çš„ namespace èŒƒå›´çš„é…ç½®æ–‡ä»¶ã€‚</li><li>ClusterFilter CRD å®šä¹‰äº† Fluentd é›†ç¾¤èŒƒå›´çš„ filter æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£è¿‡æ»¤ä»¥åŠå¤„ç† Fluentd é‡‡é›†åˆ°çš„ä¿¡æ¯ã€‚å¦‚æœå®‰è£…äº† Fluent Bitï¼Œåˆ™å¯ä»¥æ›´è¿›ä¸€æ­¥çš„å¤„ç†æ—¥å¿—ä¿¡æ¯ã€‚</li><li>Filter CRD è¯¥ CRD å®šä¹‰äº† Fluentd namespace çš„ filter æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£è¿‡æ»¤ä»¥åŠå¤„ç† Fluentd é‡‡é›†åˆ°çš„ä¿¡æ¯ã€‚å¦‚æœå®‰è£…äº† Fluent Bitï¼Œåˆ™å¯ä»¥æ›´è¿›ä¸€æ­¥çš„å¤„ç†æ—¥å¿—ä¿¡æ¯ã€‚</li><li>ClusterOutput CRD è¯¥ CRD å®šä¹‰äº† Fluentd çš„é›†ç¾¤èŒƒå›´çš„ output æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£å°†å¤„ç†åçš„æ—¥å¿—ä¿¡æ¯è½¬å‘åˆ°ç›®çš„åœ°ã€‚</li><li>Output CRD è¯¥ CRD å®šä¹‰äº† Fluentd çš„ namespace èŒƒå›´çš„ output æ’ä»¶ï¼Œè¯¥æ’ä»¶ä¸»è¦è´Ÿè´£å°†å¤„ç†åçš„æ—¥å¿—ä¿¡æ¯è½¬å‘åˆ°ç›®çš„åœ°ã€‚</li></ul><h3 id=ç¼–æ’åŸç†ç®€ä»‹-instance--mounted-secret--crd-çš„æŠ½è±¡èƒ½åŠ›>ç¼–æ’åŸç†ç®€ä»‹ (instance + mounted secret + CRD çš„æŠ½è±¡èƒ½åŠ›)</h3><p>å°½ç®¡ Fluent Bit ä¸ Fluentd éƒ½æœ‰æ”¶é›†ã€å¤„ç†ï¼ˆè§£æå’Œè¿‡æ»¤ï¼‰ä»¥åŠè¾“å‡ºæ—¥å¿—çš„èƒ½åŠ›ï¼Œä½†å®ƒä»¬æœ‰ç€ä¸åŒçš„ä¼˜ç‚¹ã€‚Fluent Bit ç›¸å¯¹ Fluentd æ›´ä¸ºè½»é‡ä¸é«˜æ•ˆï¼Œè€Œ Fluentd æ’ä»¶æ›´ä¸ºä¸°å¯Œã€‚</p><p>ä¸ºäº†å…¼é¡¾è¿™äº›ä¼˜ç‚¹ï¼ŒFluent Operator å…è®¸ç”¨æˆ·ä»¥å¤šç§æ–¹å¼çµæ´»åœ°ä½¿ç”¨ Fluent Bit å’Œ Fluentdï¼š</p><ul><li>Fluent Bit only æ¨¡å¼ï¼šå¦‚æœæ‚¨åªéœ€è¦åœ¨æ”¶é›†æ—¥å¿—å¹¶åœ¨ç®€å•å¤„ç†åå°†æ—¥å¿—å‘é€åˆ°æœ€ç»ˆç›®çš„åœ°ï¼Œæ‚¨åªéœ€è¦ Fluent Bitã€‚</li><li>Fluentd only æ¨¡å¼ï¼šå¦‚æœéœ€è¦é€šè¿‡ç½‘ç»œä»¥ HTTP æˆ– Syslog ç­‰æ–¹å¼æ¥æ”¶æ—¥å¿—ï¼Œç„¶åå°†æ—¥å¿—å¤„ç†å¹¶å‘é€åˆ°æœ€ç»ˆçš„ç›®çš„åœ°ï¼Œåˆ™åªéœ€è¦ Fluentdã€‚</li><li>Fluent Bit + Fluentd æ¨¡å¼ï¼šå¦‚æœä½ è¿˜éœ€è¦å¯¹æ”¶é›†åˆ°çš„æ—¥å¿—è¿›è¡Œä¸€äº›é«˜çº§å¤„ç†æˆ–è€…å‘é€åˆ°æ›´å¤šçš„ sinkï¼Œé‚£ä¹ˆä½ å¯ä»¥ç»„åˆä½¿ç”¨ Fluent Bit å’Œ Fluentdã€‚</li></ul><p>Fluent Operator å…è®¸æ‚¨æ ¹æ®éœ€è¦åœ¨ä¸Šè¿° 3 ç§æ¨¡å¼ä¸‹é…ç½®æ—¥å¿—å¤„ç†ç®¡é“ã€‚Fluentd ä¸ Fluent Bit å…·æœ‰ä¸°å¯Œçš„æ’ä»¶ä»¥æ»¡è¶³ç”¨æˆ·çš„å„ç§è‡ªå®šä¹‰åŒ–éœ€æ±‚ï¼Œç”±äº Fluentd ä¸ Fluent Bit çš„é…ç½®æŒ‚è½½æ–¹å¼ç›¸ä¼¼ï¼Œæ‰€ä»¥ä»¥ Fluent Bit é…ç½®æ–‡ä»¶çš„æŒ‚è½½æ–¹å¼æ¥è¿›è¡Œç®€å•ä»‹ç»ã€‚</p><p>åœ¨ Fluent Bit CRD ä¸­æ¯ä¸ª ClusterInput, ClusterParser, ClusterFilter,ClusterOutput ä»£è¡¨ä¸€ä¸ª Fluent Bit é…ç½®éƒ¨åˆ†ï¼Œç”± ClusterFluentBitConfig æ ‡ç­¾é€‰æ‹©å™¨é€‰æ‹©ã€‚Fluent Operator ç›‘è§†è¿™äº›å¯¹è±¡ï¼Œæ„å»ºæœ€ç»ˆé…ç½®ï¼Œæœ€ååˆ›å»ºä¸€ä¸ª Secret æ¥å­˜å‚¨å®‰è£…åˆ° Fluent Bit DaemonSet ä¸­çš„é…ç½®ã€‚æ•´ä¸ªå·¥ä½œæµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-2022-3.svg alt></p><p>å› ä¸º Fluent Bit æœ¬èº«æ²¡æœ‰é‡æ–°åŠ è½½æ¥å£ï¼ˆè¯¦ç»†ä¿¡æ¯è¯·å‚é˜…æ­¤<a href=https://github.com/fluent/fluent-bit/issues/365 title=å·²çŸ¥é—®é¢˜ target=_blank rel="noopener noreferrer">å·²çŸ¥é—®é¢˜</a>ï¼‰ï¼Œä¸ºäº†ä½¿ Fluent Bit èƒ½å¤Ÿåœ¨ Fluent Bit é…ç½®æ›´æ”¹æ—¶è·å–å¹¶ä½¿ç”¨æœ€æ–°é…ç½®ï¼Œæ·»åŠ äº†ä¸€ä¸ªåä¸º fluentbit watcher çš„åŒ…è£…å™¨ï¼Œä»¥ä¾¿åœ¨æ£€æµ‹åˆ° Fluent Bit é…ç½®æ›´æ”¹æ—¶ç«‹å³é‡æ–°å¯åŠ¨ Fluent Bit è¿›ç¨‹ã€‚è¿™æ ·ï¼Œæ— éœ€é‡æ–°å¯åŠ¨ Fluent Bit pod å³å¯é‡æ–°åŠ è½½æ–°é…ç½®ã€‚</p><p>ä¸ºäº†ä½¿ç”¨æˆ·é…ç½®æ›´ä¸ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬åŸºäº CRD å¼ºå¤§çš„æŠ½è±¡èƒ½åŠ›å°†åº”ç”¨ä»¥åŠé…ç½®çš„å‚æ•°æå–å‡ºæ¥ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å®šä¹‰çš„ CRD æ¥å¯¹ Fluent Bit ä»¥åŠ Fluentd è¿›è¡Œé…ç½®ã€‚Fluent Operator ç›‘æ§è¿™äº›å¯¹è±¡çš„å˜åŒ–ä»è€Œæ›´æ”¹ Fluent Bit ä»¥åŠ Fluentd çš„çŠ¶æ€åŠé…ç½®ã€‚ç‰¹åˆ«æ˜¯æ’ä»¶çš„å®šä¹‰ï¼Œä¸ºäº†ä½¿ç”¨æˆ·æ›´ä¸ºå¹³æ»‘åœ°è¿‡æ¸¡ï¼Œæˆ‘ä»¬åœ¨å‘½åä¸ŠåŸºæœ¬ä¸ Fluent Bit åŸæœ‰çš„å­—æ®µä¿æŒä¸€è‡´ï¼Œé™ä½ä½¿ç”¨çš„é—¨æ§›ã€‚</p><h3 id=å¦‚ä½•å®ç°å¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»>å¦‚ä½•å®ç°å¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»</h3><p>Fluent Bit å¯ä»¥é«˜æ•ˆçš„é‡‡é›†æ—¥å¿—ï¼Œä½†æ˜¯å¦‚æœéœ€è¦å¯¹æ—¥å¿—ä¿¡æ¯è¿›è¡Œå¤æ‚å¤„ç†ï¼ŒFluent Bit åˆ™ç¨æ˜¾åŠ›ä¸ä»å¿ƒï¼Œè€Œ Fluentd åˆ™å¯ä»¥å€ŸåŠ©å…¶ä¸°å¯Œçš„æ’ä»¶å®Œæˆå¯¹æ—¥å¿—ä¿¡æ¯çš„é«˜çº§å¤„ç†ã€‚fluent-operator ä¸ºæ­¤æŠ½è±¡äº† Fluentd çš„å„ç§æ’ä»¶ï¼Œä»¥ä¾¿å¯ä»¥å¯¹æ—¥å¿—ä¿¡æ¯è¿›è¡Œå¤„ç†æ¥æ»¡è¶³ç”¨æˆ·çš„è‡ªå®šä¹‰éœ€æ±‚ã€‚</p><p>ä»ä¸Šé¢ CRD çš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å°† Fluentd çš„ config åŠæ’ä»¶çš„ CRD åˆ†æˆäº† cluster çº§åˆ«ä¸ namespace çº§åˆ«çš„ CRDã€‚é€šè¿‡å°† CRD å®šä¹‰ä¸ºä¸¤ç§èŒƒå›´ï¼Œå€ŸåŠ© Fluentd çš„ label router æ’ä»¶ï¼Œå°±å¯ä»¥è¾¾åˆ°å¤šç§Ÿæˆ·éš”ç¦»çš„æ•ˆæœã€‚</p><p>æˆ‘ä»¬åœ¨ clusterfluentconfig æ·»åŠ äº† watchNamespace å­—æ®µï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©ç›‘å¬å“ªäº› namespaceï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºç›‘æ§æ‰€æœ‰çš„ namespaceã€‚è€Œ namesapce çº§åˆ«çš„ fluentconfig åªèƒ½ç›‘å¬è‡ªå·±æ‰€ä½äºçš„ namespace ä¸­çš„ CR åŠå…¨å±€çº§åˆ«çš„é…ç½®ã€‚æ‰€ä»¥ namespace çº§åˆ«çš„æ—¥å¿—æ—¢å¯ä»¥è¾“å‡ºåˆ°è¯¥ namespace ä¸­çš„ outputï¼Œä¹Ÿå¯ä»¥è¾“å‡ºåˆ° clsuter çº§åˆ«çš„ outputï¼Œä»è€Œè¾¾åˆ°å¤šç§Ÿæˆ·éš”ç¦»çš„ç›®çš„ã€‚</p><h2 id=fluent-operator-vs-logging-operator>Fluent Operator vs logging-operator</h2><h3 id=å·®åˆ«>å·®åˆ«</h3><ul><li>ä¸¤è€…çš†å¯è‡ªåŠ¨éƒ¨ç½² Fluent Bit ä¸ Fluentdã€‚logging-operator éœ€è¦åŒæ—¶éƒ¨ç½² Fluent Bit å’Œ Fluentdï¼Œè€Œ Fluent Operator æ”¯æŒå¯æ’æ‹”éƒ¨ç½² Fluent Bit ä¸ Fluentdï¼Œéå¼ºè€¦åˆï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªè¡Œé€‰æ‹©éƒ¨ç½² Fluentd æˆ–è€…æ˜¯ Fluent Bitï¼Œæ›´ä¸ºçµæ´»ã€‚</li><li>åœ¨ logging-operator ä¸­ Fluent Bit æ”¶é›†çš„æ—¥å¿—éƒ½å¿…é¡»ç»è¿‡ Fluentd æ‰èƒ½è¾“å‡ºåˆ°æœ€ç»ˆçš„ç›®çš„åœ°ï¼Œè€Œä¸”å¦‚æœæ•°æ®é‡è¿‡å¤§ï¼Œé‚£ä¹ˆ Fluentd å­˜åœ¨å•ç‚¹æ•…éšœéšæ‚£ã€‚Fluent Operator ä¸­ Fluent Bit å¯ä»¥ç›´æ¥å°†æ—¥å¿—ä¿¡æ¯å‘é€åˆ°ç›®çš„åœ°ï¼Œä»è€Œè§„é¿å•ç‚¹æ•…éšœçš„éšæ‚£ã€‚</li><li>logging-operator å®šä¹‰äº† loggingsï¼Œoutputsï¼Œflowsï¼Œclusteroutputs ä»¥åŠ clusterflows å››ç§ CRD,è€Œ Fluent Operator å®šä¹‰äº† 13 ç§ CRDã€‚ç›¸è¾ƒäº logging-operatorï¼ŒFluent Operator åœ¨ CRD å®šä¹‰ä¸Šæ›´åŠ å¤šæ ·ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æ›´çµæ´»çš„å¯¹ Fluentd ä»¥åŠ Fluent Bit è¿›è¡Œé…ç½®ã€‚åŒæ—¶åœ¨å®šä¹‰ CRD æ—¶ï¼Œé€‰å–ä¸ Fluentd ä»¥åŠ Fluent Bit é…ç½®ç±»ä¼¼çš„å‘½åï¼ŒåŠ›æ±‚å‘½åæ›´åŠ æ¸…æ™°ï¼Œä»¥ç¬¦åˆåŸç”Ÿçš„ç»„ä»¶å®šä¹‰ã€‚</li><li>ä¸¤è€…å‡å€Ÿé‰´äº† Fluentd çš„ label router æ’ä»¶å®ç°å¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»ã€‚</li></ul><h3 id=å±•æœ›>å±•æœ›</h3><ul><li>æ”¯æŒ HPA è‡ªåŠ¨ä¼¸ç¼©ï¼›</li><li>å®Œå–„ Helm Chartï¼Œå¦‚æ”¶é›† metrics ä¿¡æ¯ï¼›</li><li>...</li></ul><h2 id=ç”¨æ³•è¯¦è§£>ç”¨æ³•è¯¦è§£</h2><p>å€ŸåŠ© Fluent Operator å¯ä»¥å¯¹æ—¥å¿—è¿›è¡Œå¤æ‚å¤„ç†ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <a href=https://github.com/kubesphere-sigs/fluent-operator-walkthrough title=fluent-operator-walkthrough target=_blank rel="noopener noreferrer">fluent-operator-walkthrough</a> ä¸­å°†æ—¥å¿—è¾“å‡ºåˆ° elasticsearch ä¸ kafka çš„ä¾‹å­å¯¹ Fluent Operator çš„å®é™…åŠŸèƒ½è¿›è¡Œä»‹ç»ã€‚è¦è·å¾— Fluent Operator çš„ä¸€äº›å®é™…æ“ä½œç»éªŒï¼Œæ‚¨éœ€è¦ä¸€ä¸ª Kind é›†ç¾¤ã€‚åŒæ—¶ä½ è¿˜éœ€è¦åœ¨è¿™ç§ç±»å‹çš„é›†ç¾¤ä¸­è®¾ç½®ä¸€ä¸ª Kafka é›†ç¾¤å’Œä¸€ä¸ª Elasticsearch é›†ç¾¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># åˆ›å»ºä¸€ä¸ª kind çš„é›†ç¾¤å¹¶å‘½åä¸º fluent</span>
</span></span><span style=display:flex><span>./create-kind-cluster.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># åœ¨ Kafka namespace ä¸‹åˆ›å»ºä¸€ä¸ª Kafka é›†ç¾¤</span>
</span></span><span style=display:flex><span>./deploy-kafka.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># åœ¨ elastic namespace ä¸‹åˆ›å»ºä¸€ä¸ª Elasticsearch é›†ç¾¤</span>
</span></span><span style=display:flex><span>./deploy-es.sh
</span></span></code></pre></div><p>Fluent Operator æ§åˆ¶ Fluent Bit å’Œ Fluentd çš„ç”Ÿå‘½å‘¨æœŸã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬åœ¨ Fluent å‘½åç©ºé—´ä¸­å¯åŠ¨ Fluent Operatorï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>./deploy-fluent-operator.sh
</span></span></code></pre></div><p>Fluent Bit å’Œ Fluentd éƒ½å·²è¢«å®šä¹‰ä¸º Fluent Operator ä¸­çš„ CRDï¼Œæ‚¨å¯ä»¥é€šè¿‡å£°æ˜ FluentBit æˆ– Fluentd çš„ CR æ¥åˆ›å»º Fluent Bit DaemonSet æˆ– Fluentd StatefulSetã€‚</p><h3 id=fluent-bit-only-æ¨¡å¼>Fluent Bit Only æ¨¡å¼</h3><p>Fluent Bit Only å°†åªå¯ç”¨è½»é‡çº§çš„ Fluent Bit å¯¹æ—¥å¿—è¿›è¡Œé‡‡é›†ã€å¤„ç†ä»¥åŠè½¬å‘ã€‚</p><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-2022-4.png alt></p><h4 id=ä½¿ç”¨-fluent-bit-æ”¶é›†-kubelet-çš„æ—¥å¿—å¹¶è¾“å‡ºåˆ°-elasticsearch>ä½¿ç”¨ Fluent Bit æ”¶é›† kubelet çš„æ—¥å¿—å¹¶è¾“å‡ºåˆ° Elasticsearch</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>FluentBit</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluent-bit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluent-bit</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>kubesphere/fluent-bit:v1.8.11</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>positionDB</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>hostPath</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/var/lib/fluent-bit/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>10m</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>25Mi</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>500m</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>200Mi</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>fluentBitConfigName</span>: <span style=color:#ae81ff>fluent-bit-only-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tolerations</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>operator</span>: <span style=color:#ae81ff>Exists</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentBitConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluent-bit-only-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluent-bit</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>parsersFile</span>: <span style=color:#ae81ff>parsers.conf</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>inputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentbit-only&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>filterSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentbit-only&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentbit-only&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterInput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kubelet</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentbit-only&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>systemd</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>service.kubelet</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/var/log/journal</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>db</span>: <span style=color:#ae81ff>/fluent-bit/tail/kubelet.db</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dbSync</span>: <span style=color:#ae81ff>Normal</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>systemdFilter</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>_SYSTEMD_UNIT=kubelet.service</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFilter</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>systemd</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentbit-only&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>match</span>: <span style=color:#ae81ff>service.*</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>lua</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>script</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>key</span>: <span style=color:#ae81ff>systemd.lua</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluent-bit-lua</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>call</span>: <span style=color:#ae81ff>add_time</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>timeAsTable</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>data</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>systemd.lua</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    function add_time(tag, timestamp, record)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      new_record = {}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      timeStr = os.date(&#34;!*t&#34;, timestamp[&#34;sec&#34;])
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      t = string.format(&#34;%4d-%02d-%02dT%02d:%02d:%02d.%sZ&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    		timeStr[&#34;year&#34;], timeStr[&#34;month&#34;], timeStr[&#34;day&#34;],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    		timeStr[&#34;hour&#34;], timeStr[&#34;min&#34;], timeStr[&#34;sec&#34;],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    		timestamp[&#34;nsec&#34;])
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      kubernetes = {}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      kubernetes[&#34;pod_name&#34;] = record[&#34;_HOSTNAME&#34;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      kubernetes[&#34;container_name&#34;] = record[&#34;SYSLOG_IDENTIFIER&#34;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      kubernetes[&#34;namespace_name&#34;] = &#34;kube-system&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      new_record[&#34;time&#34;] = t
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      new_record[&#34;log&#34;] = record[&#34;MESSAGE&#34;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      new_record[&#34;kubernetes&#34;] = kubernetes
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      return 1, timestamp, new_record
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    end</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ConfigMap</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/component</span>: <span style=color:#ae81ff>operator</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluent-bit-lua</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluent-bit-lua</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>es</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentbit-only&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>matchRegex</span>: <span style=color:#ae81ff>(?:kube|service)\.(.*)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>es</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>generateID</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-fb-only</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeKey</span>: <span style=color:#e6db74>&#34;@timestamp&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=ä½¿ç”¨-fluent-bit-æ”¶é›†-kubernetes-çš„åº”ç”¨æ—¥å¿—å¹¶è¾“å‡ºåˆ°-kafka>ä½¿ç”¨ Fluent Bit æ”¶é›† kubernetes çš„åº”ç”¨æ—¥å¿—å¹¶è¾“å‡ºåˆ° Kafka</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>FluentBit</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluent-bit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluent-bit</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>kubesphere/fluent-bit:v1.8.11</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>positionDB</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>hostPath</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/var/lib/fluent-bit/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>10m</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>25Mi</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>500m</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>200Mi</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>fluentBitConfigName</span>: <span style=color:#ae81ff>fluent-bit-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tolerations</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>operator</span>: <span style=color:#ae81ff>Exists</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentBitConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluent-bit-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluent-bit</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>parsersFile</span>: <span style=color:#ae81ff>parsers.conf</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>inputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>filterSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterInput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tail</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>tail</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>kube.*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/var/log/containers/*.log</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>parser</span>: <span style=color:#ae81ff>docker</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>refreshIntervalSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>memBufLimit</span>: <span style=color:#ae81ff>5MB</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>skipLongLines</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>db</span>: <span style=color:#ae81ff>/fluent-bit/tail/pos.db</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dbSync</span>: <span style=color:#ae81ff>Normal</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFilter</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kubernetes</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>match</span>: <span style=color:#ae81ff>kube.*</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>kubernetes</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>kubeURL</span>: <span style=color:#ae81ff>https://kubernetes.default.svc:443</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>kubeCAFile</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/ca.crt</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>kubeTokenFile</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/token</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>annotations</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>nest</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>operation</span>: <span style=color:#ae81ff>lift</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>nestedUnder</span>: <span style=color:#ae81ff>kubernetes</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>addPrefix</span>: <span style=color:#ae81ff>kubernetes_</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>modify</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>remove</span>: <span style=color:#ae81ff>stream</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>remove</span>: <span style=color:#ae81ff>kubernetes_pod_id</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>remove</span>: <span style=color:#ae81ff>kubernetes_host</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>remove</span>: <span style=color:#ae81ff>kubernetes_container_hash</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>nest</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>operation</span>: <span style=color:#ae81ff>nest</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>wildcard</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>kubernetes_*</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>nestUnder</span>: <span style=color:#ae81ff>kubernetes</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>removePrefix</span>: <span style=color:#ae81ff>kubernetes_</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;false&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/mode</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>matchRegex</span>: <span style=color:#ae81ff>(?:kube|service)\.(.*)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kafka</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>brokers</span>: <span style=color:#ae81ff>my-cluster-kafka-bootstrap.kafka.svc:9091,my-cluster-kafka-bootstrap.kafka.svc:9092,my-cluster-kafka-bootstrap.kafka.svc:9093</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>topics</span>: <span style=color:#ae81ff>fluent-log</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h3 id=fluent-bit--fluentd-æ¨¡å¼>Fluent Bit + Fluentd æ¨¡å¼</h3><p>å‡­å€Ÿ Fluentd ä¸°å¯Œçš„æ’ä»¶ï¼ŒFluentd å¯ä»¥å……å½“æ—¥å¿—èšåˆå±‚ï¼Œæ‰§è¡Œæ›´é«˜çº§çš„æ—¥å¿—å¤„ç†ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Fluent Operator è½»æ¾åœ°å°†æ—¥å¿—ä» Fluent Bit è½¬å‘åˆ° Fluentdã€‚</p><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-2022-5.png alt></p><h4 id=å°†æ—¥å¿—ä»-fluent-bit-è½¬å‘åˆ°-fluentd>å°†æ—¥å¿—ä» Fluent Bit è½¬å‘åˆ° Fluentd</h4><p>è¦å°†æ—¥å¿—ä» Fluent Bit è½¬å‘åˆ° Fluentdï¼Œæ‚¨éœ€è¦å¯ç”¨ Fluent Bit çš„ forward æ’ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentbit.fluent.io/v1alpha2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluentd</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fluentbit.fluent.io/component</span>: <span style=color:#ae81ff>logging</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>matchRegex</span>: <span style=color:#ae81ff>(?:kube|service)\.(.*)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>forward</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>host</span>: <span style=color:#ae81ff>fluentd.fluent.svc</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>24224</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=éƒ¨ç½²-fluentd>éƒ¨ç½² Fluentd</h4><p>Fluentd forward Input æ’ä»¶ä¼šåœ¨éƒ¨ç½² Fluentd æ—¶é»˜è®¤å¯ç”¨ï¼Œå› æ­¤ä½ åªéœ€è¦éƒ¨ç½²ä¸‹åˆ— yaml æ¥éƒ¨ç½² Fluentdï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Fluentd</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluentd</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluentd</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>globalInputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>forward</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>bind</span>: <span style=color:#ae81ff>0.0.0.0</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>24224</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>kubesphere/fluentd:v1.14.4</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>fluentdCfgSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span></code></pre></div><h4 id=clusterfluentdconfig-fluentd-é›†ç¾¤èŒƒå›´çš„é…ç½®>ClusterFluentdConfig: Fluentd é›†ç¾¤èŒƒå›´çš„é…ç½®</h4><p>å¦‚æœä½ å®šä¹‰äº† ClusterFluentdConfigï¼Œé‚£ä¹ˆä½ å¯ä»¥æ”¶é›†ä»»æ„æˆ–è€…æ‰€æœ‰ namespace ä¸‹çš„æ—¥å¿—ã€‚æˆ‘ä¹ˆå¯ä»¥é€šè¿‡ watchedNamespaces å­—æ®µæ¥é€‰æ‹©æ‰€éœ€è¦é‡‡é›†æ—¥å¿—çš„ namespaceã€‚ä»¥ä¸‹é…ç½®æ˜¯é‡‡é›† <code>kube-system</code> ä»¥åŠ <code>default</code> namespace ä¸‹çš„æ—¥å¿—ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>watchedNamespaces</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>kube-system</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;cluster&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-output-es</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;cluster&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-cluster-fd</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=fluentdconfig-fluentd-namespace-èŒƒå›´çš„é…ç½®>FluentdConfig: Fluentd namespace èŒƒå›´çš„é…ç½®</h4><p>å¦‚æœä½ å®šä¹‰äº† FluentdConfigï¼Œé‚£ä¹ˆä½ åªèƒ½å°†ä¸è¯¥ FluentdConfig åŒä¸€ namespace ä¸‹çš„æ—¥å¿—å‘é€åˆ° Outputï¼Œé€šè¿‡è¿™ç§æ–¹å¼å®ç°äº†ä¸åŒ namespace ä¸‹çš„æ—¥å¿—éš”ç¦»ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>FluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>namespace-fluentd-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;namespace&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Output</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>namespace-fluentd-output-es</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;namespace&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-namespace-fd</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=æ ¹æ®-namespace-å°†æ—¥å¿—è·¯ç”±åˆ°ä¸åŒçš„-kafka-topic>æ ¹æ® namespace å°†æ—¥å¿—è·¯ç”±åˆ°ä¸åŒçš„ Kafka topic</h4><p>åŒæ ·æ‚¨å¯ä»¥ä½¿ç”¨ Fluentd çš„ filter æ’ä»¶æ ¹æ®ä¸åŒçš„ namespace å°†æ—¥å¿—åˆ†å‘åˆ°ä¸åŒçš„ topicã€‚åœ¨è¿™é‡Œæˆ‘ä»¬åŒ…å«åœ¨ Fluentd å†…æ ¸ä¸­çš„æ’ä»¶ recordTransformerï¼Œè¯¥æ’ä»¶å¯ä»¥å¯¹äº‹ä»¶è¿›è¡Œå¢åˆ æ”¹æŸ¥ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-config-kafka</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>watchedNamespaces</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>kube-system</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterFilterSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>filter.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>filter.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;kafka&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFilter</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-filter-k8s</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>filter.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>filter.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>recordTransformer</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>enableRuby</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>records</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>key</span>: <span style=color:#ae81ff>kubernetes_ns</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#ae81ff>${record[&#34;kubernetes&#34;][&#34;namespace_name&#34;]}</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-output-kafka</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;kafka&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>kafka</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>brokers</span>: <span style=color:#ae81ff>my-cluster-kafka-bootstrap.default.svc:9091,my-cluster-kafka-bootstrap.default.svc:9092,my-cluster-kafka-bootstrap.default.svc:9093</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>useEventTime</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>topicKey</span>: <span style=color:#ae81ff>kubernetes_ns</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=åŒæ—¶ä½¿ç”¨é›†ç¾¤èŒƒå›´ä¸-namespace-èŒƒå›´çš„-fluentdconfig>åŒæ—¶ä½¿ç”¨é›†ç¾¤èŒƒå›´ä¸ namespace èŒƒå›´çš„ FluentdConfig</h4><p>å½“ç„¶ï¼Œä½ å¯ä»¥åƒä¸‹é¢ä¸€æ ·åŒæ—¶ä½¿ç”¨ ClusterFluentdConfig ä¸ FluentdConfigã€‚FluentdConfig ä¼šå°† <code>fluent</code> namespace ä¸‹çš„æ—¥å¿—å‘é€åˆ° ClusterOutputï¼Œè€Œ ClusterFluentdConfig åŒæ—¶ä¹Ÿä¼šå°† watchedNamespaces å­—æ®µä¸‹çš„ namespaceï¼ˆå³ kube-system ä»¥åŠ default ä¸¤ä¸ª namespaceï¼‰å‘é€åˆ° ClusterOutputã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-config-hybrid</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>watchedNamespaces</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>kube-system</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;hybrid&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>FluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>namespace-fluentd-config-hybrid</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;hybrid&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-output-es-hybrid</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;hybrid&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-hybrid-fd</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=åœ¨å¤šç§Ÿæˆ·åœºæ™¯ä¸‹åŒæ—¶ä½¿ç”¨é›†ç¾¤èŒƒå›´ä¸-namespace-èŒƒå›´çš„-fluentdconfig>åœ¨å¤šç§Ÿæˆ·åœºæ™¯ä¸‹åŒæ—¶ä½¿ç”¨é›†ç¾¤èŒƒå›´ä¸ namespace èŒƒå›´çš„ FluentdConfig</h4><p>åœ¨å¤šç§Ÿæˆ·åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶ä½¿ç”¨é›†ç¾¤èŒƒå›´ä¸ namespace èŒƒå›´çš„ FluentdConfig è¾¾åˆ°æ—¥å¿—éš”ç¦»çš„æ•ˆæœã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>FluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>namespace-fluentd-config-user1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/user</span>: <span style=color:#e6db74>&#34;user1&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/user</span>: <span style=color:#e6db74>&#34;user1&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-config-cluster-only</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>watchedNamespaces</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>kube-system</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>kubesphere-system</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;cluster-only&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Output</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>namespace-fluentd-output-user1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/user</span>: <span style=color:#e6db74>&#34;user1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-user1-fd</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-output-user1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/user</span>: <span style=color:#e6db74>&#34;user1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-cluster-user1-fd</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-output-cluster-only</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/scope</span>: <span style=color:#e6db74>&#34;cluster-only&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-cluster-only-fd</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h4 id=ä¸º-fluentd-è¾“å‡ºä½¿ç”¨ç¼“å†²åŒº>ä¸º Fluentd è¾“å‡ºä½¿ç”¨ç¼“å†²åŒº</h4><p>æ‚¨å¯ä»¥æ·»åŠ ä¸€ä¸ªç¼“å†²åŒºæ¥ç¼“å­˜ output æ’ä»¶çš„æ—¥å¿—ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-config-buffer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>watchedNamespaces</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>kube-system</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterFilterSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>filter.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;buffer&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>filter.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterOutputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;buffer&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterFilter</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-filter-buffer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>filter.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;buffer&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>filter.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>recordTransformer</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>enableRuby</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>records</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>key</span>: <span style=color:#ae81ff>kubernetes_ns</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#ae81ff>${record[&#34;kubernetes&#34;][&#34;namespace_name&#34;]}</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterOutput</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cluster-fluentd-output-buffer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/type</span>: <span style=color:#e6db74>&#34;buffer&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>stdout</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>buffer</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>file</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/buffers/stdout.log</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>elasticsearch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>host</span>: <span style=color:#ae81ff>elasticsearch-master.elastic.svc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashFormat</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>logstashPrefix</span>: <span style=color:#ae81ff>fluent-log-buffer-fd</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>buffer</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>file</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/buffers/es.log</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><h3 id=fluentd-only-æ¨¡å¼>Fluentd Only æ¨¡å¼</h3><p>ä½ åŒæ ·å¯ä»¥å¼€å¯ Fluentd Only æ¨¡å¼ï¼Œè¯¥æ¨¡å¼åªä¼šéƒ¨ç½² Fluentd statefulsetã€‚</p><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/fluent-operator-2022-6.png alt></p><h4 id=ä½¿ç”¨-fluentd-ä»-http-æ¥æ”¶æ—¥å¿—å¹¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º>ä½¿ç”¨ Fluentd ä» HTTP æ¥æ”¶æ—¥å¿—å¹¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º</h4><p>å¦‚æœä½ æƒ³å•ç‹¬å¼€å¯ Fluentd æ’ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡ HTTP æ¥æ¥æ”¶æ—¥å¿—ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | kubectl apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Fluentd</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluentd-http</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>fluentd</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>globalInputs</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>bind</span>: <span style=color:#ae81ff>0.0.0.0</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9880</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>kubesphere/fluentd:v1.14.4</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>fluentdCfgSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>FluentdConfig</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluentd-only-config</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>filterSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>filter.fluentd.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentd-only&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>filter.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputSelector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/mode</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Filter</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluentd-only-filter</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>filter.fluentd.fluent.io/mode</span>: <span style=color:#e6db74>&#34;fluentd-only&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>filter.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>stdout</span>: {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>fluentd.fluent.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Output</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fluentd-only-stdout</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>fluent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output.fluentd.fluent.io/enabled</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>stdout</span>: {}
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div></div></div><div class=share-2><div class=share><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f&text=Fluent%20Operator%20%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" target=_blank rel="noopener noreferrer"><img src=/images/share/Twitter.svg alt="twitter icon">
</a><a href="https://reddit.com/submit?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f&title=Fluent%20Operator%20%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" target=_blank rel="noopener noreferrer"><img src=/images/share/Reddit.svg alt="reddit icon">
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Facebook.svg alt="facebook icon">
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Linkedin.svg alt="linkedin icon">
</a><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2ffluent-operator-logging%2f&t=Fluent%20Operator%20%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" target=_blank rel="noopener noreferrer"><img src=/images/share/HackerNews.svg alt="hackernews icon"></a></div></div></div><div class=aside><div class=inner-div><div class=title>ç›®å½•</div><div class=tabs><nav id=TableOfContents><ul><li><a href=#fluent-operator-ä»‹ç»>Fluent Operatorâ€‹ ä»‹ç»</a><ul><li><a href=#æ—¥å¿—æµæ°´çº¿çš„å„ä¸ªé˜¶æ®µ>æ—¥å¿—æµæ°´çº¿çš„å„ä¸ªé˜¶æ®µ</a></li><li><a href=#crd-ç®€ä»‹>CRD ç®€ä»‹</a></li><li><a href=#ç¼–æ’åŸç†ç®€ä»‹-instance--mounted-secret--crd-çš„æŠ½è±¡èƒ½åŠ›>ç¼–æ’åŸç†ç®€ä»‹ (instance + mounted secret + CRD çš„æŠ½è±¡èƒ½åŠ›)</a></li><li><a href=#å¦‚ä½•å®ç°å¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»>å¦‚ä½•å®ç°å¤šç§Ÿæˆ·æ—¥å¿—éš”ç¦»</a></li></ul></li><li><a href=#fluent-operator-vs-logging-operator>Fluent Operator vs logging-operator</a><ul><li><a href=#å·®åˆ«>å·®åˆ«</a></li><li><a href=#å±•æœ›>å±•æœ›</a></li></ul></li><li><a href=#ç”¨æ³•è¯¦è§£>ç”¨æ³•è¯¦è§£</a><ul><li><a href=#fluent-bit-only-æ¨¡å¼>Fluent Bit Only æ¨¡å¼</a></li><li><a href=#fluent-bit--fluentd-æ¨¡å¼>Fluent Bit + Fluentd æ¨¡å¼</a></li><li><a href=#fluentd-only-æ¨¡å¼>Fluentd Only æ¨¡å¼</a></li></ul></li></ul></nav></div></div></div></div></section><div class=SubscribeForm><div class=innerBox><img class=close src=/images/home/close.svg alt=close><p class=description>é€šè¿‡é‚®ä»¶æ¥æ”¶ KubeSphere æœ€æ–°çš„æŠ€æœ¯åšå®¢ä¸äº§å“æ›´æ–°çš„é€šçŸ¥</p><div id=blog_formAddress data-actionaddress="https://www.sendcloud.net/v3/api/subInvite/subscription?invitecode=1dc5a4fb-894c-4470-b01d-ca7fa9d47a46" data-usesendcloud=true data-lang=zh><input name=EMAIL id=email-input-blog type=text placeholder>
<button id=email-submit-blog>è®¢é˜…</button>
<span id=message_blog data-message1=è¯·æä¾›æ‚¨çš„é‚®ç®± data-message2=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€! data-message3=é‚®ç®±åœ°å€å·²ç»å­˜åœ¨ style=color:red></span><span id=message1_blog style=color:#00a971 data-success=è®¢é˜…æˆåŠŸå•¦ï¼Œæˆ‘ä»¬ä¿è¯ä¸ä¼šç»™ä½ å‘åƒåœ¾é‚®ä»¶çš„å•¦></span></div></div></div><footer><div class=footer><div class="footer-main common-layout"><div class=up-main><div class=left-div><img src=/images/logo.svg alt class=foot-logo><p>é€šè¿‡é‚®ä»¶æ¥æ”¶ KubeSphere æœ€æ–°çš„æŠ€æœ¯åšå®¢ä¸äº§å“æ›´æ–°çš„é€šçŸ¥</p><div id=formAddress data-actionaddress="https://www.sendcloud.net/v3/api/subInvite/subscription?invitecode=1dc5a4fb-894c-4470-b01d-ca7fa9d47a46" data-usesendcloud=true data-lang=zh><input name=EMAIL id=email-input type=text placeholder=è¯·è¾“å…¥æ‚¨çš„é‚®ç®±åœ°å€>
<button id=email-submit>è®¢é˜…</button></div><span id=message data-message1=è¯·æä¾›æ‚¨çš„é‚®ç®± data-message2=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€! data-message3=é‚®ç®±åœ°å€å·²ç»å­˜åœ¨></span><span id=message1 style=color:#00a971 data-success=è®¢é˜…æˆåŠŸå•¦ï¼Œæˆ‘ä»¬ä¿è¯ä¸ä¼šç»™ä½ å‘åƒåœ¾é‚®ä»¶çš„å•¦></span><script>var bindSubmit=function(){var e=$("#email-input");$("#email-submit").click(function(t){t.stopPropagation();var s,o,n=e.val(),i=$("#message").data("message1"),a=$("#message").data("message2"),r=$("#message").data("message3"),c=$("#message1").data("success");if(n)if(validateEmail(n)){if(s=$("#formAddress").data("usesendcloud"),!s)return;o=$("#formAddress").data("actionaddress"),$.post({type:"post",url:o,data:{email:$("#email-input").val().toString()},success:function(){showSuccessMessage(c),setTimeout(function(){$("#email-input").val("")},1e3)},error:function(){showMessage(r)}})}else t.preventDefault(),showMessage(a);else t.preventDefault(),showMessage(i)})},validateEmail=function(e){var t=/^[A-Za-z0-9]+([_.][A-Za-z0-9]+)*@([A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/;return t.test(e)},showMessage=function(e){$("#message").html(e).show()},showSuccessMessage=function(e){$("#message1").html(e).show()},bindHideMessage=function(){$(window).click(function(){$("#message").hide(),$("#message1").hide()})},bindClose=function(){$(".formBox .close").click(function(e){e.stopPropagation(),$(".formBox").fadeOut()})};bindSubmit(),bindClose(),bindHideMessage()</script><span id=message data-message1=è¯·æä¾›æ‚¨çš„é‚®ç®± data-message2=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€!></span></div><div class=right-div><ul class=common-flex-layout><li class=nowrap-li><div class=h3>åº”ç”¨åœºæ™¯</div><a href=/zh/devops/>æ‹¥æŠ±ä¸€ç«™å¼ DevOps</a>
<a href=/zh/service-mesh/>åœ¨ K8s è¿è¡Œå¾®æœåŠ¡</a>
<a href=/zh/observability/>æ„å»ºäº‘åŸç”Ÿå¯è§‚æµ‹æ€§</a>
<a href=https://github.com/kubesphere/kubekey target=_blank rel="noopener noreferrer">K8s ä¸€é”®éƒ¨ç½²ä¸è¿ç»´</a>
<a href=https://github.com/OpenFunction/OpenFunction target=_blank rel="noopener noreferrer">æ„å»º FaaS å¹³å°ä¸ Serverless æ¶æ„</a>
<a href=https://github.com/openpitrix/openpitrix target=_blank rel="noopener noreferrer">å¤šäº‘åº”ç”¨ç®¡ç†å¹³å°</a></li><li class=nowrap-li><div class=h3>èµ„æº</div><a href=/zh/projects/>å¼€æºé¡¹ç›®</a>
<a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a>
<a href=/zh/conferences/>å¼€æºå³°ä¼š</a>
<a href=/zh/videos/>è§†é¢‘èµ„æº</a>
<a href=/zh/learn/>äº‘åŸç”Ÿå®æˆ˜</a></li><li class=nowrap-li><div class=h3>æ–‡æ¡£ä¸­å¿ƒ</div><a href=/zh/docs/v4.1/01-intro/01-introduction/>äº§å“ä»‹ç»</a>
<a href=/zh/docs/v4.1/03-installation-and-upgrade/02-install-kubesphere/02-install-kubernetes-and-kubesphere/>å¦‚ä½•å®‰è£…</a>
<a href=/zh/docs/v4.1/02-quickstart/>å¿«é€Ÿå…¥é—¨</a>
<a href=/zh/docs/v3.4/reference/api-docs/>API æ–‡æ¡£</a></li><li class=nowrap-li><div class=h3>å¼€æºç¤¾åŒº</div><a href=/zh/contribution/>å‚ä¸è´¡çŒ®</a>
<a href=/zh/live/>ç¤¾åŒºæ´»åŠ¨</a>
<a href=/zh/case/>æ¡ˆä¾‹å­¦ä¹ </a>
<a href=/zh/partner/>åˆä½œä¼™ä¼´</a>
<a href=/zh/user-group/>ç”¨æˆ·å§”å‘˜ä¼š</a>
<a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md target=_blank rel="noopener noreferrer">ç‰ˆæœ¬è®¡åˆ’</a>
<a href=https://kubesphere.com.cn/ target=_blank rel="noopener noreferrer">ä¸­å›½ç«™</a>
<a href=https://ask.kubesphere.io/forum target=_blank rel="noopener noreferrer">ä¸­æ–‡è®ºå›</a>
<a href=https://kubesphere.io target=_blank rel="noopener noreferrer">å…¨çƒç«™</a></li><li class=nowrap-li><div class=h3>äº§å“ä¸æœåŠ¡</div><a href=https://aws.amazon.com/cn/quickstart/architecture/qingcloud-kubesphere/ target=_blank rel="noopener noreferrer">KubeSphere on AWS</a>
<a href=https://market.azure.cn/marketplace/apps/qingcloud.kubesphere target=_blank rel="noopener noreferrer">KubeSphere on Azure</a>
<a href=https://marketplace.digitalocean.com/apps/kubesphere target=_blank rel="noopener noreferrer">KubeSphere on DigitalOcean</a>
<a href=https://www.qingcloud.com/products/kubesphereqke target=_blank rel="noopener noreferrer">KubeSphere on QingCloud(QKE)</a>
<a href=https://kubesphere.com.cn/kse/ target=_blank rel="noopener noreferrer">KubeSphere ä¼ä¸šç‰ˆ</a>
<a href=https://kubesphere.cloud/ksv/ target=_blank rel="noopener noreferrer">KubeSphere è™šæ‹ŸåŒ–å¹³å°</a>
<a href=https://kubesphere.com.cn/marketplace/ target=_blank rel="noopener noreferrer">äº‘åŸç”Ÿæ‰©å±•ç»„ä»¶å¸‚åœº</a>
<a href=https://kubesphere.cloud target=_blank rel="noopener noreferrer">äº‘åŸç”Ÿåº”ç”¨æœåŠ¡å¹³å°</a>
<a href=https://m.qingcloud.com/p/aec50 target=_blank rel="noopener noreferrer">äº†è§£å•†ä¸šäº§å“ä¸å’¨è¯¢åˆä½œ</a></li></ul></div></div><div class=down-main><div class=img-div><a class=wechat href=javascript:void(0); aria-label=wechat><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28" height="28" viewBox="0 0 28 28"><defs><path id="a" d="M0 0h15.673v12.156H0z"/></defs><g fill="none" fill-rule="evenodd" transform="translate(1 1)"><circle cx="13" cy="13" r="13" stroke="#B6C2CD"/><g transform="translate(5 7)"><mask id="b" fill="#fff"><use xlink:href="#a"/></mask><path fill="currentColor" d="M15.673 7.898c0-2.061-2.173-3.74-4.619-3.74-2.59.0-4.625 1.679-4.625 3.74.0 2.066 2.035 3.738 4.625 3.738.542.0 1.09-.13 1.632-.256l1.493.776-.408-1.29c1.09-.776 1.902-1.81 1.902-2.968zm-6.119-.645c-.27.0-.541-.257-.541-.514.0-.256.27-.514.541-.514.41.0.681.258.681.514.0.257-.271.514-.681.514zm2.994.0c-.27.0-.541-.257-.541-.514.0-.256.27-.514.54-.514.41.0.681.258.681.514.0.257-.277.514-.68.514z" mask="url(#b)"/><path fill="currentColor" d="M10.602 3.674c.177.0.356.011.533.029C10.657 1.576 8.27.0 5.543.0 2.498.0.0 1.974.0 4.485c0 1.45.829 2.64 2.216 3.564l-.552 1.588 1.94-.929c.693.129 1.251.263 1.94.263.17.0.343-.005.515-.022a3.68 3.68.0 01-.172-1.104c0-2.302 2.081-4.171 4.715-4.171zM7.618 2.243c.417.0.693.263.693.66s-.276.66-.693.66c-.418.0-.835-.263-.835-.66.006-.398.423-.66.835-.66zm-3.88 1.319c-.417.0-.834-.263-.834-.66s.417-.66.834-.66c.418.0.695.263.695.66.0.392-.277.66-.695.66z" mask="url(#b)"/></g></g></svg><div class=hide-div><img src=/images/home/wechat.svg alt></div></a><a class=facebook-a href=https://www.facebook.com/kubesphere target=_blank aria-label=facebook></a><a class=twitter-a href=https://x.com/KubeSphere target=_blank aria-label=twitter rel="noopener noreferrer"></a><a class=linkedin-a href=https://www.linkedin.com/company/kubesphere/ target=_blank aria-label=linkedin rel="noopener noreferrer"></a><a class=bilibili-a href=https://space.bilibili.com/438908638 target=_blank aria-label=bilibili rel="noopener noreferrer"></a><a class=slack-a href=https://join.slack.com/t/kubesphere/shared_invite/zt-2b4t6rdb4-ico_4UJzCln_S2c1pcrIpQ target=_blank aria-label=slack rel="noopener noreferrer"></a><a class=github-a href=https://github.com/kubesphere/kubesphere target=_blank aria-label=github rel="noopener noreferrer"></a><a class=medium-a href=https://itnext.io/@kubesphere target=_blank aria-label=medium rel="noopener noreferrer"></a></div><p class=p1></p><p class=case><a href=http://www.beian.miit.gov.cn/ target=_blank rel="noopener noreferrer"><span>äº¬ICPå¤‡13019086å·</span>
</a><a target=_blank rel="noopener noreferrer" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502041003"><img src=/images/footer/case-icon.png alt=å¤‡æ¡ˆå›¾æ ‡>
<span>äº¬å…¬ç½‘å®‰å¤‡ 11010502041003å·</span></a></p></div></div></div><div class=cookie><div class=common-layout><p>æ‚¨çš„éšç§å¯¹æˆ‘ä»¬å¾ˆé‡è¦ã€‚æˆ‘ä»¬ä½¿ç”¨Cookieæ¥è®°ä½è®¢é˜…è¯¦ç»†ä¿¡æ¯ï¼Œä¼˜åŒ–ç½‘ç«™åŠŸèƒ½å¹¶äº¤ä»˜æ ¹æ®æ‚¨çš„å…´è¶£é‡èº«å®šåˆ¶çš„å†…å®¹ã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„<a href=/zh/privacy>éšç§æ”¿ç­–</a>.</p><button>
æ¥å—å¹¶ç»§ç»­</button></div></div></footer><script>var lazyLoad=function(e,t){for(var n,o,i,s=0;s<t;s++){if(n=e.eq(s),o=n.attr("data-loaded"),o)continue;n.offset().top<parseInt($(window).height())+parseInt($(window).scrollTop())&&(i=n.attr("src"),n.attr("src",i),n.attr("data-loaded",!0))}},bindLayLoad=function(){var e=$("img"),t=e.length;lazyLoad(e,t),$(window).scroll(function(){lazyLoad(e,t)})},bindAddPadding=function(){var e=$("#close-join");e.length>0&&$(".main-section").addClass("padding")},docCookies={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t){return!!e&&!/^(?:expires|max-age|path|domain|secure)$/i.test(e)&&(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t),!0)}},bindHideCookie=function(){var t=docCookies.getItem("hasAuth"),e=$(".cookie");t?e.hide():e.show(),e.find("button").on("click",function(){docCookies.setItem("hasAuth","1"),e.hide()})};bindAddPadding(),bindHideCookie()</script><script type=text/javascript src=/js/aside.2d6977c0f16aef4ed3e886dd66675ce74bd0efcd467c2b2bcdb30b92d5e7c7c0e5c6e0c9d8f09a883c22f58df9e6b0b6347fcdd3c9a920b7faba6d7f91a201c3.js integrity="sha512-LWl3wPFq707T6IbdZmdc50vQ781GfCsrzbMLktXnx8DlxuDJ2PCaiDwi9Y355rC2NH/N08mpILf6um1/kaIBww=="></script><script type=text/javascript src=/js/markdown-tab.17f9f46b021adebc7250ce1b07134a577b307e7a436daa4aaf388f218e8463966f53770b26a64817c06c168738a887672d47fb4c29615adfc446e11d09a344cf.js integrity="sha512-F/n0awIa3rxyUM4bBxNKV3swfnpDbapKrziPIY6EY5ZvU3cLJqZIF8BsFoc4qIdnLUf7TClhWt/ERuEdCaNEzw=="></script><script>let forbidForm=!1;var viewer=new Viewer(document.querySelector(".md-body"),{url:"src"}),blogBindSubmit=function(){var e=$("#email-input-blog");$("#email-submit-blog").click(function(t){t.stopPropagation();var s,o,n=e.val(),i=$("#message_blog").data("message1"),a=$("#message_blog").data("message2"),r=$("#message_blog").data("message3"),c=$("#message1_blog").data("success");if(n)if(validateEmail(n)){if(s=$("#blog_formAddress").data("usesendcloud"),!s)return;o=$("#blog_formAddress").data("actionaddress"),$.post({type:"post",url:o,data:{email:n.toString()},success:function(){showSuccessMessage_blog(c),setTimeout(function(){window.onscroll="",$(".SubscribeForm").hide(),$("#email-input-blog").val("")},5e3)},error:function(){showMessage_blog(r)}})}else t.preventDefault(),$("#message_blog").html(a).show();else t.preventDefault(),$("#message_blog").html(i).show()})},validateEmail=function(e){var t=/^[A-Za-z0-9]+([_.][A-Za-z0-9]+)*@([A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/;return t.test(e)},bindHideMessageBlog=function(){$(window).click(function(){$("#message_blog").hide()})},bindCloseBlog=function(){$(".SubscribeForm .close").click(function(e){e.stopPropagation(),$(".SubscribeForm").fadeOut(),window.onscroll=""})},showMessage_blog=function(e){$("#message_blog").html(e).show()},showSuccessMessage_blog=function(e){$("#message1_blog").html(e).show()};window.onscroll=()=>{var e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.scrollHeight||document.body.scrollHeight;forbidForm&&(window.onscroll=""),e+t>n-710?$(".SubscribeForm").hide():$(".SubscribeForm").show()},blogBindSubmit(),bindCloseBlog(),bindHideMessageBlog()</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>