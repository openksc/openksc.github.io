<!doctype html><html lang=en-US><head><meta charset=utf-8><title>KubeSphere éƒ¨ç½²å‘é‡æ•°æ®åº“ Milvus å®æˆ˜æŒ‡å—</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å¦‚ä½•åœ¨ KubeSphere ç®¡ç†çš„ Kubernetes é›†ç¾¤ä¸Šï¼Œé«˜æ•ˆåœ°éƒ¨ç½²å’Œç®¡ç† Milvus é›†ç¾¤ï¼Œè®©æ‚¨çš„åº”ç”¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ Milvus çš„å¼ºå¤§åŠŸèƒ½ã€‚"><meta name=keywords content="Kubernetes,KubeSphere,Milvus"><meta property="og:type" content="article"><meta property="og:title" content="KubeSphere éƒ¨ç½²å‘é‡æ•°æ®åº“ Milvus å®æˆ˜æŒ‡å—"><meta property="og:description" content="å¦‚ä½•åœ¨ KubeSphere ç®¡ç†çš„ Kubernetes é›†ç¾¤ä¸Šï¼Œé«˜æ•ˆåœ°éƒ¨ç½²å’Œç®¡ç† Milvus é›†ç¾¤ï¼Œè®©æ‚¨çš„åº”ç”¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ Milvus çš„å¼ºå¤§åŠŸèƒ½ã€‚"><meta property="og:image" content="https://pek3b.qingstor.com/kubesphere-community/images/milvus-kubesphere-20240730-cover.png"><meta property="og:url" content="https://openksc.github.io/zh/blogs/deploy-milvus-on-kubesphere/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@KubeSphere"><meta property="twitter:image" content="https://pek3b.qingstor.com/kubesphere-community/images/milvus-kubesphere-20240730-cover.png"><meta name=docsearch:language content="zh-CN"><meta name=docsearch:version content><link rel=canonical href=https://kubesphere.io/zh/blogs/deploy-milvus-on-kubesphere/><link rel="shortcut icon" href=/images/favicons/favicon.ico><link rel=apple-touch-icon href=/images/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/svg+xml href=/images/favicons/favicon.svg><link rel=icon type=image/png href=/images/favicons/favicon.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg color=#00ad6e><meta name=msapplication-config content='/images/favicons/browserconfig.xml'><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/fonts/Roboto/stylesheet.css><link rel=stylesheet href=/fonts/ProximaNova/stylesheet.css><link rel=stylesheet href=/css/jquery.modal.min.css><link rel=stylesheet href=/css/viewer.min.css><link rel=stylesheet href=/swiper/swiper-bundle.min.css><link rel=stylesheet href=/scss/common.min.0c3fdcc05ec210321169846714f74b11c4a1baf09a1833fa9273b2347c81e636.css><script src=/js/jquery-3.7.1.min.js></script><script src=/js/viewer.min.js></script><script src=/js/jquery.modal.min.js></script><script src=/swiper/swiper-bundle.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?0888981f1fa45d241b1fb6962da2963e",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YYCVN36HT5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YYCVN36HT5")</script><script type=text/javascript>!function(e,t,n,s,o){e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},n=t.createElement("script"),tag=t.getElementsByTagName("script")[0],n.async=1,n.src=("https:"==document.location.protocol?"https://":"http://")+s,tag.parentNode.insertBefore(n,tag)}(window,document,"script","assets.giocdn.com/2.1/gio.js","gio"),gio("init","8a24ae300cbf8b8c",{}),gio("send")</script><link rel=stylesheet href=/scss/content.min.f73b326fbf8c5bd331900b0de21c7dde608a4926f482f6465f9ae1d9049b83ad.css><link rel=stylesheet href=/scss/markdown.min.db47186481122431dffae72d17dbbd51f90b66f022cc163458645709924e4eac.css></head><body><header class=navigation><div class=join-div><div class=content>ğŸš€ KubeSphere v4.1.3 å‘å¸ƒï¼Œå¤šé¡¹ä¼˜åŒ–ä¸æ”¹è¿›ï¼Œæ¬¢è¿ä½“éªŒï¼<a href=/zh/docs/v4.1/20-release-notes/release-v413/ target=_blank rel="noopener noreferrer">è¯·æŸ¥çœ‹ Release notes â†’</a>
<img id=close-join src=/images/header/close.svg alt=close></div></div><div class=common-layout><div class=header-container><a href=/zh/ aria-label=logo><img src=/images/header/logo.svg alt class=logo></a><ul class=nav><li class=menu-li><span class=menu-span>åº”ç”¨åœºæ™¯</span><ul class="dropdown-menu menu-2"><li><a href=/zh/devops/>æ‹¥æŠ±ä¸€ç«™å¼ DevOps å·¥ä½œæµ</a></li><li><a href=/zh/service-mesh/>åœ¨ Kubernetes è¿è¡Œå¾®æœåŠ¡</a></li><li><a href=/zh/observability/>æ„å»ºä¸°å¯Œçš„äº‘åŸç”Ÿå¯è§‚æµ‹æ€§</a></li></ul></li><li class=menu-li><span class=menu-span>èµ„æº</span><ul class="dropdown-menu menu-3"><li><a href=/zh/projects/>å¼€æºé¡¹ç›®</a></li><li><a href=/zh/conferences/>å¼€æºå³°ä¼š</a></li><li><a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a></li><li><a href=/zh/videos/>è§†é¢‘èµ„æº</a></li><li><a href=/zh/learn/>äº‘åŸç”Ÿå®æˆ˜</a></li></ul></li><li class=menu-li><span class=menu-span>æ–‡æ¡£ä¸­å¿ƒ</span><ul class="dropdown-menu menu-4"><li><a href=/zh/docs/v4.1>v4.1 <img src=/images/header/star.svg alt=star></a></li><li><a href=/zh/docs/v3.4>v3.4</a></li><li><a href=/zh/docs/v3.3>v3.3</a></li><li><a href=https://dev-guide.kubesphere.io/extension-dev-guide/zh/ target=_blank rel="noopener noreferrer">æ‰©å±•ç»„ä»¶å¼€å‘</a></li><li><a href=https://kube.design/ target=_blank rel="noopener noreferrer">Kube Design</a></li></ul></li><li class=menu-li><span class=menu-span>å¼€æºç¤¾åŒº</span><ul class="dropdown-menu menu-5"><li><a href=/zh/contribution/>å‚ä¸è´¡çŒ®</a></li><li><a href=/zh/live/>ç¤¾åŒºæ´»åŠ¨</a></li><li><a href=/zh/case/>æ¡ˆä¾‹å­¦ä¹ </a></li><li><a href=/zh/partner/>åˆä½œä¼™ä¼´</a></li><li><a href=/zh/user-group/>ç”¨æˆ·å§”å‘˜ä¼š</a></li><li><a href=/zh/news/>åŠ¨æ€</a></li><li><a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md target=_blank rel="noopener noreferrer">ç‰ˆæœ¬è®¡åˆ’</a></li><li><a href=https://www.kubesphere.io/zh/ target=_blank rel="noopener noreferrer">ä¸­å›½ç«™</a></li><li><a href=https://github.com/kubesphere/community/tree/master/sig-advocacy-and-outreach/ospp-2025 target=_blank rel="noopener noreferrer">å¼€æºä¹‹å¤ 2025</a></li></ul></li><li><a data-docs=ç”¨æˆ·è®ºå› href=https://ask.kubesphere.io/forum target=_blank rel="noopener noreferrer">ç”¨æˆ·è®ºå›</a></li><li><a data-docs=è®¤è¯ href=https://kubesphere.cloud/certification/ target=_blank rel="noopener noreferrer">è®¤è¯</a></li></ul><div class=right-menu><ul><li class=language-menu><div><img src=/images/header/black.svg alt>
<span>ç®€ä½“ä¸­æ–‡</span></div><ul class=dropdown-menu><li onclick='handleLangClick("zh","/zh/blogs/deploy-milvus-on-kubesphere/")'>ç®€ä½“ä¸­æ–‡</li></ul></li><li class=github-li><div class=github-star><a class=star-btn href=https://github.com/kubesphere/kubesphere rel="noopener noreferrer" target=_blank><span class=star-img></span>&nbsp;<span>Star</span>
</a><a class=social-count href=https://github.com/kubesphere/kubesphere/stargazers rel="noopener noreferrer" target=_blank></a></div></li><li class=menu-icon><img src=/images/header/menu.svg alt></li></ul></div></div></div><div id=modal-for-menu class=modal><ul class=nav><li data-check=0 class=menu-li><span class=menu-span>åº”ç”¨åœºæ™¯</span><ul class=dropdown-menu><li><a href=/zh/devops/>æ‹¥æŠ±ä¸€ç«™å¼ DevOps å·¥ä½œæµ</a></li><li><a href=/zh/service-mesh/>åœ¨ Kubernetes è¿è¡Œå¾®æœåŠ¡</a></li><li><a href=/zh/observability/>æ„å»ºä¸°å¯Œçš„äº‘åŸç”Ÿå¯è§‚æµ‹æ€§</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>èµ„æº</span><ul class=dropdown-menu><li><a href=/zh/projects/>å¼€æºé¡¹ç›®</a></li><li><a href=/zh/conferences/>å¼€æºå³°ä¼š</a></li><li><a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a></li><li><a href=/zh/videos/>è§†é¢‘èµ„æº</a></li><li><a href=/zh/learn/>äº‘åŸç”Ÿå®æˆ˜</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>æ–‡æ¡£ä¸­å¿ƒ</span><ul class=dropdown-menu><li><a href=/zh/docs/v4.1>v4.1 <img src=/images/header/star.svg alt=star></a></li><li><a href=/zh/docs/v3.4>v3.4</a></li><li><a href=/zh/docs/v3.3>v3.3</a></li><li><a href=https://dev-guide.kubesphere.io/extension-dev-guide/zh/>æ‰©å±•ç»„ä»¶å¼€å‘</a></li><li><a href=https://kube.design/>Kube Design</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>å¼€æºç¤¾åŒº</span><ul class=dropdown-menu><li><a href=/zh/contribution/>å‚ä¸è´¡çŒ®</a></li><li><a href=/zh/live/>ç¤¾åŒºæ´»åŠ¨</a></li><li><a href=/zh/case/>æ¡ˆä¾‹å­¦ä¹ </a></li><li><a href=/zh/partner/>åˆä½œä¼™ä¼´</a></li><li><a href=/zh/user-group/>ç”¨æˆ·å§”å‘˜ä¼š</a></li><li><a href=/zh/news/>åŠ¨æ€</a></li><li><a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md>ç‰ˆæœ¬è®¡åˆ’</a></li><li><a href=https://www.kubesphere.io/zh/>ä¸­å›½ç«™</a></li><li><a href=https://github.com/kubesphere/community/tree/master/sig-advocacy-and-outreach/ospp-2025>å¼€æºä¹‹å¤ 2025</a></li></ul></li><li><a data-docs=ç”¨æˆ·è®ºå› href=https://ask.kubesphere.io/forum>ç”¨æˆ·è®ºå›</a></li><li><a data-docs=è®¤è¯ href=https://kubesphere.cloud/certification/>è®¤è¯</a></li></ul><div class=link-div><a href=https://join.slack.com/t/kubesphere/shared_invite/zt-2b4t6rdb4-ico_4UJzCln_S2c1pcrIpQ target=_blank rel="noopener noreferrer" aria-label=slack><img src=/images/header/slack-hover.svg alt>
</a><a href=https://x.com/KubeSphere target=_blank rel="noopener noreferrer" aria-label=twitter><img src=/images/header/twitter-hover.svg alt>
</a><a href=https://github.com/kubesphere/kubesphere target=_blank rel="noopener noreferrer" aria-label=github><img src=/images/header/github-hover.svg alt></a></div></div></header><script>var bindNavMouseEvent,bindScrollChangeHeader,bindClickShowMenu,bindClickModalLi,bindClickClose,language,handleLangClick,githubApiLink="https://api.github.com/repos/kubesphere/kubesphere",getStar=function(){$(".social-count").hide(),$.getJSON(githubApiLink,function(e){$(".social-count").show().html(e.stargazers_count)})};getStar(),bindNavMouseEvent=function(e,t){t||(t=$(e));var n=!1;t.mouseenter(function(){if(n)return!1;n=!0,$(this).find(".dropdown-menu").fadeIn(200,function(){n=!1})}),t.mouseleave(function(){$(this).find(".dropdown-menu").fadeOut(200)})},bindScrollChangeHeader=function(){var t=100,e=$("header");window.addEventListener("scroll",function(){var t=window.scrollY;t>0?e.addClass("navigationScroll"):e.removeClass("navigationScroll")})},bindClickShowMenu=function(){$(".menu-icon").click(function(){$("#modal-for-menu").modal()})},bindClickModalLi=function(){$(".modal .menu-li").click(function(){var e=$(this).data("check");e===0?($(this).data("check",1),$(this).find(".dropdown-menu").slideDown(200)):($(this).data("check",0),$(this).find(".dropdown-menu").slideUp(200)),$(this).find(".menu-span").toggleClass("up")})},bindClickClose=function(){$("#close-join").click(function(){$(".navigation .join-div").hide(),$(".main-section").removeClass("padding")})},language="zh",bindClickClose(),bindScrollChangeHeader(),$(".header-container .menu-li").each(function(){bindNavMouseEvent("",$(this))}),bindNavMouseEvent(".header-container .language-menu"),bindNavMouseEvent(".header-container .btn-li"),bindClickShowMenu(),bindClickModalLi(),handleLangClick=function(e,t){try{localStorage.setItem("lang",e)}catch{}location.href=t}</script><section class=main-section><div class=common-layout><div class=breadcrumb><span><a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a> > </span><span>KubeSphere éƒ¨ç½²å‘é‡æ•°æ®åº“ Milvus å®æˆ˜æŒ‡å—</span></div><div class='main-div middle-div'><div class=author>è¿ç»´æœ‰æœ¯</div><span class=date>å‘å¸ƒäºï¼š2024-07-30</span>&nbsp;&nbsp;&nbsp;
<span style=font-size:14px;color:#919aa3 id=busuanzi_container_page_pv>æœ¬æ–‡æ€»é˜…è¯»é‡ï¼š<span id=busuanzi_value_page_pv></span></span><h1>KubeSphere éƒ¨ç½²å‘é‡æ•°æ®åº“ Milvus å®æˆ˜æŒ‡å—</h1><div class=share-1><div class=share><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f&text=KubeSphere%20%e9%83%a8%e7%bd%b2%e5%90%91%e9%87%8f%e6%95%b0%e6%8d%ae%e5%ba%93%20Milvus%20%e5%ae%9e%e6%88%98%e6%8c%87%e5%8d%97" target=_blank rel="noopener noreferrer"><img src=/images/share/Twitter.svg alt="twitter icon">
</a><a href="https://reddit.com/submit?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f&title=KubeSphere%20%e9%83%a8%e7%bd%b2%e5%90%91%e9%87%8f%e6%95%b0%e6%8d%ae%e5%ba%93%20Milvus%20%e5%ae%9e%e6%88%98%e6%8c%87%e5%8d%97" target=_blank rel="noopener noreferrer"><img src=/images/share/Reddit.svg alt="reddit icon">
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Facebook.svg alt="facebook icon">
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Linkedin.svg alt="linkedin icon">
</a><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f&t=KubeSphere%20%e9%83%a8%e7%bd%b2%e5%90%91%e9%87%8f%e6%95%b0%e6%8d%ae%e5%ba%93%20Milvus%20%e5%ae%9e%e6%88%98%e6%8c%87%e5%8d%97" target=_blank rel="noopener noreferrer"><img src=/images/share/HackerNews.svg alt="hackernews icon"></a></div></div><div class=content><div class=md-body><p>Milvus æ˜¯ä¸€ä¸ªä¸ºé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆGenAIï¼‰åº”ç”¨è€Œæ„å»ºçš„å¼€æºå‘é‡æ•°æ®åº“ã€‚å®ƒä»¥å“è¶Šçš„æ€§èƒ½å’Œçµæ´»æ€§ï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å¹³å°ï¼Œç”¨äºå­˜å‚¨ã€æœç´¢å’Œç®¡ç†å¤§è§„æ¨¡çš„å‘é‡æ•°æ®ã€‚Milvus èƒ½å¤Ÿæ‰§è¡Œé«˜é€Ÿæœç´¢ï¼Œå¹¶ä»¥æœ€å°çš„æ€§èƒ½æŸå¤±æ‰©å±•åˆ°æ•°ç™¾äº¿å‘é‡ã€‚å…¶åˆ†å¸ƒå¼æ¶æ„ç¡®ä¿äº†ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§å’Œæ°´å¹³å¯æ‰©å±•æ€§ï¼Œæ»¡è¶³ä¸æ–­å¢é•¿çš„æ•°æ®éœ€æ±‚ã€‚åŒæ—¶ï¼ŒMilvus æä¾›äº†ä¸°å¯Œçš„ API å’Œé›†æˆé€‰é¡¹ï¼Œä½¿å…¶æˆä¸ºæœºå™¨å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ç­‰ AI åº”ç”¨çš„ç†æƒ³é€‰æ‹©ã€‚</p><p>éšç€ AI å¤§æ¨¡å‹çš„å…´èµ·ï¼ŒMilvus æˆä¸ºäº†ä¼—å¤š AI åº”ç”¨çš„é¦–é€‰å‘é‡æ•°æ®åº“ã€‚æœ¬æ–‡å°†å¼•å¯¼æ‚¨æ¢ç´¢ï¼Œå¦‚ä½•åœ¨ KubeSphere ç®¡ç†çš„ Kubernetes é›†ç¾¤ä¸Šï¼Œé«˜æ•ˆåœ°éƒ¨ç½²å’Œç®¡ç† Milvus é›†ç¾¤ï¼Œè®©æ‚¨çš„åº”ç”¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ Milvus çš„å¼ºå¤§åŠŸèƒ½ã€‚</p><p><strong>å®æˆ˜æœåŠ¡å™¨é…ç½®(æ¶æ„ 1:1 å¤åˆ»å°è§„æ¨¡ç”Ÿäº§ç¯å¢ƒï¼Œé…ç½®ç•¥æœ‰ä¸åŒ)</strong></p><table><thead><tr><th style=text-align:center>ä¸»æœºå</th><th style=text-align:center>IP</th><th style=text-align:center>CPU</th><th style=text-align:center>å†…å­˜</th><th style=text-align:center>ç³»ç»Ÿç›˜</th><th style=text-align:center>æ•°æ®ç›˜</th><th style=text-align:center>ç”¨é€”</th></tr></thead><tbody><tr><td style=text-align:center>ksp-registry</td><td style=text-align:center>192.168.9.90</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>200</td><td style=text-align:center>Harbor é•œåƒä»“åº“</td></tr><tr><td style=text-align:center>ksp-control-1</td><td style=text-align:center>192.168.9.91</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>KubeSphere/k8s-control-plane</td></tr><tr><td style=text-align:center>ksp-control-2</td><td style=text-align:center>192.168.9.92</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>KubeSphere/k8s-control-plane</td></tr><tr><td style=text-align:center>ksp-control-3</td><td style=text-align:center>192.168.9.93</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>KubeSphere/k8s-control-plane</td></tr><tr><td style=text-align:center>ksp-worker-1</td><td style=text-align:center>192.168.9.94</td><td style=text-align:center>8</td><td style=text-align:center>16</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>k8s-worker/CI</td></tr><tr><td style=text-align:center>ksp-worker-2</td><td style=text-align:center>192.168.9.95</td><td style=text-align:center>8</td><td style=text-align:center>16</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>k8s-worker</td></tr><tr><td style=text-align:center>ksp-worker-3</td><td style=text-align:center>192.168.9.96</td><td style=text-align:center>8</td><td style=text-align:center>16</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>k8s-worker</td></tr><tr><td style=text-align:center>ksp-storage-1</td><td style=text-align:center>192.168.9.97</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>400+</td><td style=text-align:center>ElasticSearch/Longhorn/Ceph/NFS</td></tr><tr><td style=text-align:center>ksp-storage-2</td><td style=text-align:center>192.168.9.98</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>300+</td><td style=text-align:center>ElasticSearch/Longhorn/Ceph</td></tr><tr><td style=text-align:center>ksp-storage-3</td><td style=text-align:center>192.168.9.99</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>300+</td><td style=text-align:center>ElasticSearch/Longhorn/Ceph</td></tr><tr><td style=text-align:center>ksp-gpu-worker-1</td><td style=text-align:center>192.168.9.101</td><td style=text-align:center>4</td><td style=text-align:center>16</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>k8s-worker(GPU NVIDIA Tesla M40 24G)</td></tr><tr><td style=text-align:center>ksp-gpu-worker-2</td><td style=text-align:center>192.168.9.102</td><td style=text-align:center>4</td><td style=text-align:center>16</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>k8s-worker(GPU NVIDIA Tesla P100 16G)</td></tr><tr><td style=text-align:center>ksp-gateway-1</td><td style=text-align:center>192.168.9.103</td><td style=text-align:center>2</td><td style=text-align:center>4</td><td style=text-align:center>40</td><td style=text-align:center></td><td style=text-align:center>è‡ªå»ºåº”ç”¨æœåŠ¡ä»£ç†ç½‘å…³/VIPï¼š192.168.9.100</td></tr><tr><td style=text-align:center>ksp-gateway-2</td><td style=text-align:center>192.168.9.104</td><td style=text-align:center>2</td><td style=text-align:center>4</td><td style=text-align:center>40</td><td style=text-align:center></td><td style=text-align:center>è‡ªå»ºåº”ç”¨æœåŠ¡ä»£ç†ç½‘å…³/VIPï¼š192.168.9.100</td></tr><tr><td style=text-align:center>ksp-mid</td><td style=text-align:center>192.168.9.105</td><td style=text-align:center>4</td><td style=text-align:center>8</td><td style=text-align:center>40</td><td style=text-align:center>100</td><td style=text-align:center>éƒ¨ç½²åœ¨ k8s é›†ç¾¤ä¹‹å¤–çš„æœåŠ¡èŠ‚ç‚¹ï¼ˆGitlab ç­‰ï¼‰</td></tr><tr><td style=text-align:center>åˆè®¡</td><td style=text-align:center>15</td><td style=text-align:center>68</td><td style=text-align:center>152</td><td style=text-align:center>600</td><td style=text-align:center>2100+</td><td style=text-align:center></td></tr></tbody></table><p><strong>å®æˆ˜ç¯å¢ƒæ¶‰åŠè½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯</strong></p><ul><li>æ“ä½œç³»ç»Ÿï¼š<strong>openEuler 22.03 LTS SP3 x86_64</strong></li><li>KubeSphereï¼š<strong>v3.4.1</strong></li><li>Kubernetesï¼š<strong>v1.28.8</strong></li><li>KubeKey: <strong>v3.1.1</strong></li><li>Milvus Helm Chartsï¼š<strong>4.2.0</strong></li><li>Milvusï¼š <strong>v.2.4.6</strong></li></ul><h2 id=1-milvus-éƒ¨ç½²è§„åˆ’>1. Milvus éƒ¨ç½²è§„åˆ’</h2><p><strong>éƒ¨ç½²ç›®æ ‡ï¼šå®˜æ–¹æ¶æ„å›¾æ‰€ç¤ºçš„ Milvus é›†ç¾¤ï¼ˆä¸åŒ…å« Load Balancerï¼‰ã€‚</strong></p><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-architecture-overview.png alt=milvus-architecture-overview></p><p>ç”±äºæ˜¯åˆæ¬¡å®‰è£…éƒ¨ç½²ï¼Œå¯¹ Milvus çš„æ¶æ„ã€ç»„ä»¶å…³ç³»ä»…æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡éƒ¨ç½²åªåšå¦‚ä¸‹è€ƒè™‘ï¼š</p><ul><li>ä½¿ç”¨ Helm çš„æ–¹å¼ï¼Œå¤§éƒ¨åˆ†é…ç½®é‡‡ç”¨é»˜è®¤çš„ Values éƒ¨ç½²</li><li>æ›´æ”¹ç»„ä»¶é•œåƒåœ°å€ä¸ºæœ¬åœ°ç§æœ‰ä»“åº“</li><li>æŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨è‡ªå®šä¹‰çš„ NFS å­˜å‚¨ç±» <code>nfs-sc</code>ï¼ˆç”Ÿäº§ä¸å»ºè®®ç”¨ï¼Œå¯èƒ½ä¼šé€ æˆç£ç›˜ IO ä¸æ»¡è¶³ etcd çš„éœ€æ±‚ï¼‰</li><li>coordinators æ²¡æœ‰é€‰æ‹© <strong>mixCoordinator</strong>ï¼Œè€Œæ˜¯ä½¿ç”¨å¤šä¸ªç‹¬ç«‹çš„ <strong>coordinators</strong>ï¼Œè¿™ç§æ–¹æ¡ˆè¿ç»´æˆæœ¬é«˜ï¼Œç»´æŠ¤éº»çƒ¦</li><li>æ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨å®˜æ–¹é»˜è®¤æ¨èçš„ <strong>pulsar</strong>ï¼Œä¸é€‰æ‹© <strong>kafka</strong></li></ul><p>åç»­ä¼šæ·±å…¥ç ”ç©¶ï¼Œæ›´æ­£å¼çš„éƒ¨ç½²è€ƒè™‘ï¼š</p><ul><li>ä½¿ç”¨ Helm å’Œè‡ªå®šä¹‰ values ç”Ÿæˆéƒ¨ç½²èµ„æºæ¸…å•ï¼Œä¿®æ”¹æ¸…å•ï¼Œä½¿ç”¨åŸç”Ÿ kubectl æ–¹å¼éƒ¨ç½²</li><li>ä½¿ç”¨ Ceph æˆ–æ˜¯å…¶å®ƒé«˜æ€§èƒ½å­˜å‚¨ï¼Œä¸ä½¿ç”¨ NFS å­˜å‚¨</li><li>æ¶ˆæ¯é˜Ÿåˆ—ç»§ç»­ä½¿ç”¨å®˜æ–¹æ¨èçš„ <strong>pulsar</strong></li><li>ä½¿ç”¨ç¤¾åŒºå®˜æ–¹æ¨èçš„åŒ…å«æ‰€æœ‰ coordinators çš„ <strong>mixCoordinator</strong> ï¼Œé™ä½è¿ç»´æˆæœ¬</li><li>åˆç†è§„åˆ’ Minioã€Etcdã€pulsar ç­‰ç»„ä»¶ä½¿ç”¨æŒä¹…åŒ–å­˜å‚¨æ—¶æ‰€åˆ†é…çš„å­˜å‚¨ç©ºé—´ï¼Œé»˜è®¤é…ç½®ä¸å¯èƒ½æ»¡è¶³æ‰€æœ‰åœºæ™¯</li><li>Milvus æ—¥å¿—å­˜å‚¨åˆ°æŒä¹…åŒ–å­˜å‚¨ï¼Œé€‚é…æ²¡æœ‰é›†ä¸­æ—¥å¿—é‡‡é›†èƒ½åŠ›çš„ k8s é›†ç¾¤</li></ul><p><strong>é‡è¦è¯´æ˜ï¼š</strong> æœ¬æ–‡çš„å†…å®¹å¯¹äºå®‰è£…éƒ¨ç½² Milvus æœ‰ä¸€å®šçš„å€Ÿé‰´æ„ä¹‰ï¼Œä½†<strong>åˆ‡å‹¿å°†æœ¬æ–‡çš„å®æˆ˜è¿‡ç¨‹ç›´æ¥ç”¨äºä»»ä½•ç±»å‹çš„æ­£å¼ç¯å¢ƒ</strong>ã€‚</p><h2 id=2-å‰ç½®æ¡ä»¶>2. å‰ç½®æ¡ä»¶</h2><p>ä»¥ä¸‹å†…å®¹æ¥è‡ª <a href=https://milvus.io/docs/v2.3.x/prerequisite-helm.md target=_blank rel="noopener noreferrer">Milvus å®˜æ–¹ç¯å¢ƒéœ€æ±‚æ–‡æ¡£</a>ï¼Œæ¯”è¾ƒå¥½ç†è§£ï¼Œä¸åšç¿»è¯‘äº†ã€‚</p><h3 id=21-ç¡¬ä»¶éœ€æ±‚>2.1 ç¡¬ä»¶éœ€æ±‚</h3><table><thead><tr><th style=text-align:left>Component</th><th style=text-align:left>Requirement</th><th style=text-align:left>Recommendation</th><th style=text-align:left>Note</th></tr></thead><tbody><tr><td style=text-align:left>CPU</td><td style=text-align:left>Intel 2nd Gen Core CPU or higherApple Silicon</td><td style=text-align:left>Standalone: 4 core or moreCluster: 8 core or more</td><td style=text-align:left></td></tr><tr><td style=text-align:left>CPU instruction set</td><td style=text-align:left>SSE4.2AVXAVX2AVX-512</td><td style=text-align:left>SSE4.2AVXAVX2AVX-512</td><td style=text-align:left>Vector similarity search and index building within Milvus require CPU's support of single instruction, multiple data (SIMD) extension sets. Ensure that the CPU supports at least one of the SIMD extensions listed. See <a href=https://en.wikipedia.org/wiki/Advanced_Vector_Extensions#CPUs_with_AVX target=_blank rel="noopener noreferrer">CPUs with AVX</a> for more information.</td></tr><tr><td style=text-align:left>RAM</td><td style=text-align:left>Standalone: 8GCluster: 32G</td><td style=text-align:left>Standalone: 16GCluster: 128G</td><td style=text-align:left>The size of RAM depends on the data volume.</td></tr><tr><td style=text-align:left>Hard drive</td><td style=text-align:left>SATA 3.0 SSD or CloudStorage</td><td style=text-align:left>NVMe SSD or higher</td><td style=text-align:left>The size of hard drive depends on the data volume.</td></tr></tbody></table><h3 id=22-è½¯ä»¶éœ€æ±‚>2.2 è½¯ä»¶éœ€æ±‚</h3><table><thead><tr><th style=text-align:left>Operating system</th><th style=text-align:left>Software</th><th style=text-align:left>Note</th></tr></thead><tbody><tr><td style=text-align:left>Linux platforms</td><td style=text-align:left>Kubernetes 1.16 or laterkubectlHelm 3.0.0 or laterminikube (for Milvus standalone)Docker 19.03 or later (for Milvus standalone)</td><td style=text-align:left>See <a href=https://helm.sh/docs/ target=_blank rel="noopener noreferrer">Helm Docs</a> for more information.</td></tr></tbody></table><table><thead><tr><th style=text-align:left>Software</th><th style=text-align:left>Version</th><th style=text-align:left>Note</th></tr></thead><tbody><tr><td style=text-align:left>etcd</td><td style=text-align:left>3.5.0</td><td style=text-align:left>See <a href=https://milvus.io/docs/v2.3.x/prerequisite-helm.md#Additional-disk-requirements target=_blank rel="noopener noreferrer">additional disk requirements</a>.</td></tr><tr><td style=text-align:left>MinIO</td><td style=text-align:left>RELEASE.2023-03-20T20-16-18Z</td><td style=text-align:left></td></tr><tr><td style=text-align:left>Pulsar</td><td style=text-align:left>2.8.2</td><td style=text-align:left></td></tr></tbody></table><h3 id=23-ç£ç›˜éœ€æ±‚>2.3 ç£ç›˜éœ€æ±‚</h3><p>ç£ç›˜æ€§èƒ½å¯¹ etcd è‡³å…³é‡è¦ã€‚å®˜æ–¹å¼ºçƒˆå»ºè®®ä½¿ç”¨æœ¬åœ° NVMe SSD ç£ç›˜ã€‚è¾ƒæ…¢çš„ç£ç›˜å“åº”å¯èƒ½å¯¼è‡´é¢‘ç¹çš„é›†ç¾¤é€‰ä¸¾ï¼Œæœ€ç»ˆé™ä½ etcd æœåŠ¡çš„æ€§èƒ½ï¼Œç”šè‡³æ˜¯é›†ç¾¤çš„å´©æºƒã€‚</p><p>è¿™ä¸ªéœ€æ±‚æ¯”è¾ƒé‡è¦ï¼Œæˆ‘åˆšæ¥è§¦ Milvus æ—¶ï¼Œç”±äºæ—¶é—´æ¯”è¾ƒä»“ä¿ƒï¼Œåœ¨ç•¥çŸ¥ä¸€äºŒçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨é»˜è®¤é…ç½®éƒ¨ç½²äº†ä¸€å¥—åŠç”Ÿäº§çš„ Milvus é›†ç¾¤ã€‚</p><p>å› ä¸ºé€‰æ‹©äº† NFS å­˜å‚¨ä¸”æ²¡æœ‰æµ‹è¯•ç£ç›˜ IO æ€§èƒ½ï¼Œç»å¸¸ä¼šå‡ºç° etcd æœåŠ¡å¼‚å¸¸ï¼Œå“åº”æ…¢ï¼Œè¢« Kubernetes çš„å­˜æ´»æ£€æµ‹æœºåˆ¶åˆ¤æ–­ä¸ºä¸å¯ç”¨ï¼Œå¯¼è‡´é¢‘ç¹è‡ªåŠ¨é‡å»º etcd é›†ç¾¤ã€‚</p><p>å› æ­¤ï¼Œåœ¨ K8s ä¸Šåˆ›å»º Milvus é›†ç¾¤æ—¶æœ€å¥½å…ˆæµ‹è¯•ä¸€ä¸‹é›†ç¾¤æŒä¹…åŒ–å­˜å‚¨çš„æ€§èƒ½ã€‚</p><p>Milvus å®˜æ–¹ç»™å‡ºçš„æµ‹è¯•ç£ç›˜æ€§èƒ½çš„å·¥å…·å’Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir test-data
</span></span><span style=display:flex><span>fio --rw<span style=color:#f92672>=</span>write --ioengine<span style=color:#f92672>=</span>sync --fdatasync<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> --directory<span style=color:#f92672>=</span>test-data --size<span style=color:#f92672>=</span>2200m --bs<span style=color:#f92672>=</span><span style=color:#ae81ff>2300</span> --name<span style=color:#f92672>=</span>mytest
</span></span></code></pre></div><p>æµ‹è¯•ç»“æœï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨çš„ç£ç›˜åº”è¯¥è¾¾åˆ° <strong>500 IOPS</strong> ä»¥ä¸Šï¼Œ99th percentile fsync latency ä½äº 10msã€‚è¯·é˜…è¯» <a href=https://etcd.io/docs/v3.5/op-guide/hardware/#disks target=_blank rel="noopener noreferrer">etcd å®˜æ–¹æ–‡æ¡£</a> äº†è§£æ›´è¯¦ç»†çš„éœ€æ±‚ã€‚</p><p>å…·ä½“çš„ç£ç›˜æ€§èƒ½æµ‹è¯•è¿‡ç¨‹ï¼Œè¯·å‚è€ƒä¸‹æ–‡ã€‚</p><h3 id=24-kubernetes-é›†ç¾¤é…ç½®>2.4 Kubernetes é›†ç¾¤é…ç½®</h3><p>k8s é›†ç¾¤ä¸€å®šè¦é…ç½®é»˜è®¤å­˜å‚¨ç±»ï¼ŒMilvus çš„ Helm æ§åˆ¶ storageClass çš„å‚æ•°ä¸å¤Ÿçµæ´»ï¼Œæœ€å¥½ç›´æ¥ä½¿ç”¨é»˜è®¤å­˜å‚¨ç±»ï¼Œç®€åŒ–é…ç½®ã€‚</p><h2 id=3-æŒä¹…åŒ–å­˜å‚¨æ€§èƒ½æµ‹è¯•>3. æŒä¹…åŒ–å­˜å‚¨æ€§èƒ½æµ‹è¯•</h2><p>å®æˆ˜ç¯å¢ƒä½¿ç”¨äº†è‡ªå»ºçš„ NFS å­˜å‚¨ï¼Œéƒ¨ç½² Milvus ä¹‹å‰ï¼Œå…ˆæµ‹è¯•å­˜å‚¨æ€§èƒ½ï¼š</p><p>å®˜æ–¹å»ºè®®çš„æµ‹è¯•å·¥å…·æ˜¯ <code>fio</code> ï¼Œä¸ºäº†åœ¨ K8s ä¸­æ¨¡æ‹Ÿæµ‹è¯•ï¼Œæˆ‘é€‰æ‹©äº† openEBS å®˜æ–¹æä¾›çš„ <code>openebs/tests-fio:latest</code> ä½œä¸ºæµ‹è¯•é•œåƒï¼Œåˆ›å»ºæµ‹è¯• Podã€‚</p><h3 id=31-åˆ›å»ºæµ‹è¯•-pvc>3.1 åˆ›å»ºæµ‹è¯• pvc</h3><p>ç¼–è¾‘æµ‹è¯• PVC èµ„æºæ¸…å•ï¼Œ<code>vi test-nfs-fio-pvc.yaml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>PersistentVolumeClaim</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-nfs-fio-pvc</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>storageClassName</span>: <span style=color:#ae81ff>nfs-sc</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>accessModes</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>ReadWriteMany</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤ï¼Œåˆ›å»º PVCã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f test-nfs-fio-pvc.yaml
</span></span></code></pre></div><h3 id=32-åˆ›å»ºæµ‹è¯•-pod>3.2 åˆ›å»ºæµ‹è¯• Pod</h3><p>ç¼–è¾‘æµ‹è¯• Pod èµ„æºæ¸…å•ï¼Œ<code>vi test-nfs-fio-pod.yaml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Pod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-nfs-fio-pod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-nfs-fio-pod</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>openebs/tests-fio:latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>command</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;/bin/sh&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>args</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;-c&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;touch /mnt/SUCCESS &amp;&amp; sleep 86400&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nfs-fio-pvc</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>mountPath</span>: <span style=color:#e6db74>&#34;/mnt&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>restartPolicy</span>: <span style=color:#e6db74>&#34;Never&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nfs-fio-pvc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>persistentVolumeClaim</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>claimName</span>: <span style=color:#ae81ff>test-nfs-fio-pvc</span>
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤ï¼Œåˆ›å»º Podã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f test-nfs-fio-pod.yaml
</span></span></code></pre></div><h3 id=33-è¿æ¥æµ‹è¯•-pod-ç»ˆç«¯>3.3 è¿æ¥æµ‹è¯• Pod ç»ˆç«¯</h3><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ‰“å¼€ fio æµ‹è¯• Pod ç»ˆç«¯ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl exec -it test-nfs-fio-pod -- /bin/bash
</span></span></code></pre></div><p>æŸ¥çœ‹å·²ç»æŒ‚è½½çš„ NFS å­˜å‚¨ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bas data-lang=bas><span style=display:flex><span>root@test<span style=color:#f92672>-</span>nfs<span style=color:#f92672>-</span>fio<span style=color:#f92672>-</span>pod:<span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>#</span> df <span style=color:#f92672>-</span>h
</span></span><span style=display:flex><span>Filesystem                                                                                   Size  Used Avail Use<span style=color:#f92672>%</span> Mounted on
</span></span><span style=display:flex><span>overlay                                                                                      <span style=color:#ae81ff>100</span>G  <span style=color:#ae81ff>6.5</span>G   <span style=color:#ae81ff>94</span>G   <span style=color:#ae81ff>7</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>tmpfs                                                                                         <span style=color:#ae81ff>64</span>M     <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>64</span>M   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>dev
</span></span><span style=display:flex><span>tmpfs                                                                                        <span style=color:#ae81ff>7.6</span>G     <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>7.6</span>G   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>sys<span style=color:#f92672>/</span>fs<span style=color:#f92672>/</span>cgroup
</span></span><span style=display:flex><span>192<span style=color:#ae81ff>.168.9.97</span><span style=color:#f92672>:/</span>datanfs<span style=color:#f92672>/</span>k8s<span style=color:#f92672>/</span>default<span style=color:#f92672>-</span>test<span style=color:#f92672>-</span>nfs<span style=color:#f92672>-</span>fio<span style=color:#f92672>-</span>pvc<span style=color:#f92672>-</span>pvc<span style=color:#ae81ff>-7158</span>aa17<span style=color:#f92672>-</span>f003<span style=color:#ae81ff>-47</span>a2<span style=color:#f92672>-</span>b6d6<span style=color:#ae81ff>-07</span>c69d014178  <span style=color:#ae81ff>100</span>G  <span style=color:#ae81ff>746</span>M  <span style=color:#ae81ff>100</span>G   <span style=color:#ae81ff>1</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>mnt
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>dev<span style=color:#f92672>/</span>mapper<span style=color:#f92672>/</span>openeuler<span style=color:#f92672>-</span>root                                                                    <span style=color:#ae81ff>35</span>G  <span style=color:#ae81ff>2.3</span>G   <span style=color:#ae81ff>31</span>G   <span style=color:#ae81ff>7</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>hosts
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>dev<span style=color:#f92672>/</span>mapper<span style=color:#f92672>/</span>data<span style=color:#f92672>-</span>lvdata                                                                      <span style=color:#ae81ff>100</span>G  <span style=color:#ae81ff>6.5</span>G   <span style=color:#ae81ff>94</span>G   <span style=color:#ae81ff>7</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>hostname
</span></span><span style=display:flex><span>shm                                                                                           <span style=color:#ae81ff>64</span>M     <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>64</span>M   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>dev<span style=color:#f92672>/</span>shm
</span></span><span style=display:flex><span>tmpfs                                                                                         <span style=color:#ae81ff>14</span>G   <span style=color:#ae81ff>12</span>K   <span style=color:#ae81ff>14</span>G   <span style=color:#ae81ff>1</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>secrets<span style=color:#f92672>/</span>kubernetes<span style=color:#f92672>.</span>io<span style=color:#f92672>/</span>serviceaccount
</span></span><span style=display:flex><span>tmpfs                                                                                        <span style=color:#ae81ff>7.6</span>G     <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>7.6</span>G   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>proc<span style=color:#f92672>/</span>acpi
</span></span><span style=display:flex><span>tmpfs                                                                                        <span style=color:#ae81ff>7.6</span>G     <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>7.6</span>G   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>proc<span style=color:#f92672>/</span>scsi
</span></span><span style=display:flex><span>tmpfs                                                                                        <span style=color:#ae81ff>7.6</span>G     <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>7.6</span>G   <span style=color:#ae81ff>0</span><span style=color:#f92672>%</span> <span style=color:#f92672>/</span>sys<span style=color:#f92672>/</span>firmware
</span></span></code></pre></div><h3 id=34-æµ‹è¯•ç£ç›˜æ€§èƒ½>3.4 æµ‹è¯•ç£ç›˜æ€§èƒ½</h3><p>æ‰§è¡Œä¸‹é¢çš„æµ‹è¯•å‘½ä»¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir /mnt/test-data
</span></span><span style=display:flex><span>fio --rw<span style=color:#f92672>=</span>write --ioengine<span style=color:#f92672>=</span>sync --fdatasync<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> --directory<span style=color:#f92672>=</span>/mnt/test-data --size<span style=color:#f92672>=</span>2200m --bs<span style=color:#f92672>=</span><span style=color:#ae81ff>2300</span> --name<span style=color:#f92672>=</span>nfstest
</span></span></code></pre></div><p><strong>æµ‹è¯•ç»“æœï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@test-nfs-fio-pod:/# fio --rw<span style=color:#f92672>=</span>write --ioengine<span style=color:#f92672>=</span>sync --fdatasync<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> --directory<span style=color:#f92672>=</span>/mnt/test-data --size<span style=color:#f92672>=</span>2200m --bs<span style=color:#f92672>=</span><span style=color:#ae81ff>2300</span> --name<span style=color:#f92672>=</span>nfstest
</span></span><span style=display:flex><span>nfstest: <span style=color:#f92672>(</span>g<span style=color:#f92672>=</span>0<span style=color:#f92672>)</span>: rw<span style=color:#f92672>=</span>write, bs<span style=color:#f92672>=</span>2300-2300/2300-2300/2300-2300, ioengine<span style=color:#f92672>=</span>sync, iodepth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>fio-2.2.10
</span></span><span style=display:flex><span>Starting <span style=color:#ae81ff>1</span> process
</span></span><span style=display:flex><span>nfstest: Laying out IO file<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> file<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> / 2200MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Jobs: <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>f<span style=color:#f92672>=</span>1<span style=color:#f92672>)</span>: <span style=color:#f92672>[</span>W<span style=color:#f92672>(</span>1<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>100.0% <span style=color:#66d9ef>done</span><span style=color:#f92672>]</span> <span style=color:#f92672>[</span>0KB/956KB/0KB /s<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>0/426/0 iops<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>eta 00m:00s<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>nfstest: <span style=color:#f92672>(</span>groupid<span style=color:#f92672>=</span>0, jobs<span style=color:#f92672>=</span>1<span style=color:#f92672>)</span>: err<span style=color:#f92672>=</span> 0: pid<span style=color:#f92672>=</span>26: Tue Jul <span style=color:#ae81ff>23</span> 02:55:35 <span style=color:#ae81ff>2024</span>
</span></span><span style=display:flex><span>  write: io<span style=color:#f92672>=</span>2199.2MB, bw<span style=color:#f92672>=</span>870003B/s, iops<span style=color:#f92672>=</span>378, runt<span style=color:#f92672>=</span>2651558msec
</span></span><span style=display:flex><span>    clat <span style=color:#f92672>(</span>usec<span style=color:#f92672>)</span>: min<span style=color:#f92672>=</span>4, max<span style=color:#f92672>=</span>87472, avg<span style=color:#f92672>=</span>224.30, stdev<span style=color:#f92672>=</span>309.99
</span></span><span style=display:flex><span>     lat <span style=color:#f92672>(</span>usec<span style=color:#f92672>)</span>: min<span style=color:#f92672>=</span>4, max<span style=color:#f92672>=</span>87473, avg<span style=color:#f92672>=</span>224.71, stdev<span style=color:#f92672>=</span>310.00
</span></span><span style=display:flex><span>    clat percentiles <span style=color:#f92672>(</span>usec<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>     |  1.00th<span style=color:#f92672>=[</span>    7<span style=color:#f92672>]</span>,  5.00th<span style=color:#f92672>=[</span>    8<span style=color:#f92672>]</span>, 10.00th<span style=color:#f92672>=[</span>    8<span style=color:#f92672>]</span>, 20.00th<span style=color:#f92672>=[</span>    9<span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>     | 30.00th<span style=color:#f92672>=[</span>   10<span style=color:#f92672>]</span>, 40.00th<span style=color:#f92672>=[</span>   12<span style=color:#f92672>]</span>, 50.00th<span style=color:#f92672>=[</span>  302<span style=color:#f92672>]</span>, 60.00th<span style=color:#f92672>=[</span>  338<span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>     | 70.00th<span style=color:#f92672>=[</span>  366<span style=color:#f92672>]</span>, 80.00th<span style=color:#f92672>=[</span>  398<span style=color:#f92672>]</span>, 90.00th<span style=color:#f92672>=[</span>  442<span style=color:#f92672>]</span>, 95.00th<span style=color:#f92672>=[</span>  482<span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>     | 99.00th<span style=color:#f92672>=[</span>  588<span style=color:#f92672>]</span>, 99.50th<span style=color:#f92672>=[</span>  700<span style=color:#f92672>]</span>, 99.90th<span style=color:#f92672>=[</span> 1848<span style=color:#f92672>]</span>, 99.95th<span style=color:#f92672>=[</span> 3120<span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>     | 99.99th<span style=color:#f92672>=[</span> 7008<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    bw <span style=color:#f92672>(</span>KB  /s<span style=color:#f92672>)</span>: min<span style=color:#f92672>=</span>    1, max<span style=color:#f92672>=</span> 1078, per<span style=color:#f92672>=</span>100.00%, avg<span style=color:#f92672>=</span>873.03, stdev<span style=color:#f92672>=</span>221.69
</span></span><span style=display:flex><span>    lat <span style=color:#f92672>(</span>usec<span style=color:#f92672>)</span> : 10<span style=color:#f92672>=</span>25.84%, 20<span style=color:#f92672>=</span>16.33%, 50<span style=color:#f92672>=</span>1.64%, 100<span style=color:#f92672>=</span>0.03%, 250<span style=color:#f92672>=</span>0.23%
</span></span><span style=display:flex><span>    lat <span style=color:#f92672>(</span>usec<span style=color:#f92672>)</span> : 500<span style=color:#f92672>=</span>52.30%, 750<span style=color:#f92672>=</span>3.19%, 1000<span style=color:#f92672>=</span>0.15%
</span></span><span style=display:flex><span>    lat <span style=color:#f92672>(</span>msec<span style=color:#f92672>)</span> : 2<span style=color:#f92672>=</span>0.20%, 4<span style=color:#f92672>=</span>0.05%, 10<span style=color:#f92672>=</span>0.03%, 20<span style=color:#f92672>=</span>0.01%, 50<span style=color:#f92672>=</span>0.01%
</span></span><span style=display:flex><span>    lat <span style=color:#f92672>(</span>msec<span style=color:#f92672>)</span> : 100<span style=color:#f92672>=</span>0.01%
</span></span><span style=display:flex><span>  cpu          : usr<span style=color:#f92672>=</span>0.38%, sys<span style=color:#f92672>=</span>1.56%, ctx<span style=color:#f92672>=</span>1567342, majf<span style=color:#f92672>=</span>0, minf<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>  IO depths    : 1<span style=color:#f92672>=</span>100.0%, 2<span style=color:#f92672>=</span>0.0%, 4<span style=color:#f92672>=</span>0.0%, 8<span style=color:#f92672>=</span>0.0%, 16<span style=color:#f92672>=</span>0.0%, 32<span style=color:#f92672>=</span>0.0%, &gt;<span style=color:#f92672>=</span>64<span style=color:#f92672>=</span>0.0%
</span></span><span style=display:flex><span>     submit    : 0<span style=color:#f92672>=</span>0.0%, 4<span style=color:#f92672>=</span>100.0%, 8<span style=color:#f92672>=</span>0.0%, 16<span style=color:#f92672>=</span>0.0%, 32<span style=color:#f92672>=</span>0.0%, 64<span style=color:#f92672>=</span>0.0%, &gt;<span style=color:#f92672>=</span>64<span style=color:#f92672>=</span>0.0%
</span></span><span style=display:flex><span>     complete  : 0<span style=color:#f92672>=</span>0.0%, 4<span style=color:#f92672>=</span>100.0%, 8<span style=color:#f92672>=</span>0.0%, 16<span style=color:#f92672>=</span>0.0%, 32<span style=color:#f92672>=</span>0.0%, 64<span style=color:#f92672>=</span>0.0%, &gt;<span style=color:#f92672>=</span>64<span style=color:#f92672>=</span>0.0%
</span></span><span style=display:flex><span>     issued    : total<span style=color:#f92672>=</span>r<span style=color:#f92672>=</span>0/w<span style=color:#f92672>=</span>1002985/d<span style=color:#f92672>=</span>0, short<span style=color:#f92672>=</span>r<span style=color:#f92672>=</span>0/w<span style=color:#f92672>=</span>0/d<span style=color:#f92672>=</span>0, drop<span style=color:#f92672>=</span>r<span style=color:#f92672>=</span>0/w<span style=color:#f92672>=</span>0/d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>     latency   : target<span style=color:#f92672>=</span>0, window<span style=color:#f92672>=</span>0, percentile<span style=color:#f92672>=</span>100.00%, depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Run status group <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>all jobs<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>  WRITE: io<span style=color:#f92672>=</span>2199.2MB, aggrb<span style=color:#f92672>=</span>849KB/s, minb<span style=color:#f92672>=</span>849KB/s, maxb<span style=color:#f92672>=</span>849KB/s, mint<span style=color:#f92672>=</span>2651558msec, maxt<span style=color:#f92672>=</span>2651558msec
</span></span></code></pre></div><p><strong>æµ‹è¯•ç»“æœè¯´æ˜ï¼š</strong> æµ‹è¯•ç»“æœæ˜æ˜¾ä¸ç¬¦åˆå®˜æ–¹å»ºè®®çš„æœ€ä½å€¼ã€‚ç”±äºï¼Œæ˜¯ä¸ªäººæµ‹è¯•ç¯å¢ƒä¹Ÿå°±æ— æ‰€è°“äº†ã€‚<strong>ç”Ÿäº§ç¯å¢ƒè¯·ä¸¥è°¨æµ‹è¯•ã€è¯„ä¼°</strong>ã€‚</p><h2 id=4-ä½¿ç”¨-helm-å®‰è£…-milvus-é›†ç¾¤>4. ä½¿ç”¨ Helm å®‰è£… Milvus é›†ç¾¤</h2><p>Milvus å®˜æ–¹æä¾›äº† Operatorã€Helm ç­‰å¤šç§æ–¹å¼çš„é›†ç¾¤å®‰è£…æ–‡æ¡£ã€‚æœ¬æ–‡å®æˆ˜æ¼”ç¤ºäº† Helm çš„å®‰è£…æ–¹å¼ã€‚å…¶ä»–æ–¹å¼è¯·å‚è€ƒ <a href=https://milvus.io/docs/v2.3.x/install_cluster-milvusoperator.md target=_blank rel="noopener noreferrer">Milvus å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h3 id=41-å®‰è£…-milvus-helm-chart>4.1 å®‰è£… Milvus Helm Chart</h3><p>æ·»åŠ  Milvus Helm repositoryã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo add milvus https://zilliztech.github.io/milvus-helm/
</span></span></code></pre></div><p>æ›´æ–°æœ¬åœ° chartsã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo update milvus
</span></span></code></pre></div><h3 id=42-å®‰è£…-milvus>4.2 å®‰è£… Milvus</h3><p>å®˜æ–¹é»˜è®¤å®‰è£…å‘½ä»¤ï¼ˆ<strong>ä»…ä¾›å‚è€ƒï¼Œæœ¬æ–‡æœªç”¨</strong>ï¼‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm install my-release milvus/milvus
</span></span></code></pre></div><p>æŒ‰è§„åˆ’è®¾ç½®è‡ªå®šä¹‰é…ç½®é¡¹ï¼Œæ‰§è¡Œä¸‹é¢çš„å®‰è£…å‘½ä»¤ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm install --namespace opsxlab --create-namespace opsxlab milvus/milvus <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set image.all.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/milvus&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set image.tools.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/milvus-config-tool&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set etcd.image.registry<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;docker.io&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set etcd.image.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/etcd&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.images.broker.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.images.autorecovery.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.images.zookeeper.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.images.bookie.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.images.proxy.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.images.pulsar_manager.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar-manager&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.pulsar_metadata.image.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/pulsar&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set minio.image.repository<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;milvusdb/minio&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set etcd.persistence.storageClass<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nfs-sc&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set minio.persistence.storageClass<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nfs-sc&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.zookeeper.volumes.data.storageClassName<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nfs-sc&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --set pulsar.bookkeeper.volumes.journal.storageClassName<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nfs-sc&#34;</span>
</span></span></code></pre></div><p>è‡ªå®šä¹‰é…ç½®è¯´æ˜ï¼š</p><ul><li>æŒ‡å®šå¹¶è‡ªåŠ¨åˆ›å»ºå‘½åç©ºé—´ <strong>opsxlab</strong></li><li>è®¾ç½®ç»„ä»¶çš„é•œåƒåœ°å€ï¼Œæœ¬æ–‡ä¸ºäº†æ¼”ç¤ºä¿®æ”¹æ–¹æ³•ï¼Œä¿ç•™äº†é»˜è®¤å€¼ï¼Œ<strong>å®é™…ä½¿ç”¨ä¸­å¯ä»¥ä¿®æ”¹ä¸ºè‡ªå·±çš„é•œåƒä»“åº“åœ°å€</strong></li><li>etcd çš„é•œåƒåœ°å€æ¯”è¾ƒç‰¹æ®Šï¼Œæœ‰ä¸¤ä¸ªé…ç½®é¡¹ï¼Œè¯·æ³¨æ„</li><li>è®¾ç½®æŒä¹…åŒ–å­˜å‚¨ç±»ä¸º <code>nfs-sc</code>ï¼Œé€‚ç”¨äº k8s æœ‰å¤šç§å­˜å‚¨ç±»ï¼Œéœ€è¦éƒ¨ç½²åˆ°æŒ‡å®šå­˜å‚¨ç±»çš„åœºæ™¯</li><li>æ‰€æœ‰é…ç½®ä»…ä¾›å‚è€ƒï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£æŸ¥çœ‹æ›´è¯¦ç»†çš„é…ç½®</li></ul><p><strong>é™„å½•ï¼š</strong> é»˜è®¤å®‰è£…çš„ç»„ä»¶é•œåƒåœ°å€åŠç‰ˆæœ¬ï¼š</p><table><thead><tr><th style=text-align:center>åºå·</th><th style=text-align:center>ç»„ä»¶åç§°</th><th style=text-align:center>é»˜è®¤ repository</th><th style=text-align:center>ç»„ä»¶ç‰ˆæœ¬</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center>milvus</td><td style=text-align:center>milvusdb/milvus</td><td style=text-align:center>v2.4.6</td></tr><tr><td style=text-align:center>2</td><td style=text-align:center>milvus-config-tool</td><td style=text-align:center>milvusdb/milvus-config-tool</td><td style=text-align:center>v0.1.2</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>etcd</td><td style=text-align:center>milvusdb/etcd</td><td style=text-align:center>3.5.5-r4</td></tr><tr><td style=text-align:center>4</td><td style=text-align:center>pulsar</td><td style=text-align:center>apachepulsar/pulsar</td><td style=text-align:center>2.9.5</td></tr><tr><td style=text-align:center>5</td><td style=text-align:center>pulsar-manager</td><td style=text-align:center>apachepulsar/pulsar-manager</td><td style=text-align:center>v0.1.0</td></tr><tr><td style=text-align:center>6</td><td style=text-align:center>minio</td><td style=text-align:center>minio/minio</td><td style=text-align:center>RELEASE.2023-03-20T20-16-18Z</td></tr></tbody></table><h3 id=43-æŸ¥çœ‹å®‰è£…ç»“æœ>4.3 æŸ¥çœ‹å®‰è£…ç»“æœ</h3><p>Helm å®‰è£…å‘½ä»¤æˆåŠŸæ‰§è¡Œåï¼Œè§‚å¯Ÿ Pod è¿è¡ŒçŠ¶æ€ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get pods -n opsxlab
</span></span></code></pre></div><p><strong>å®‰è£…æˆåŠŸåï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get pods -n opsxlab
</span></span><span style=display:flex><span>NAME                                         READY   STATUS      RESTARTS        AGE
</span></span><span style=display:flex><span>opsxlab-etcd-0                               1/1     Running     <span style=color:#ae81ff>0</span>               8m9s
</span></span><span style=display:flex><span>opsxlab-etcd-1                               1/1     Running     <span style=color:#ae81ff>0</span>               8m20s
</span></span><span style=display:flex><span>opsxlab-etcd-2                               1/1     Running     <span style=color:#ae81ff>0</span>               11m
</span></span><span style=display:flex><span>opsxlab-milvus-datacoord-6cd875684d-fbkgx    1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m19s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-milvus-datanode-5c5558cbc7-r24vj     1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m40s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-milvus-indexcoord-f48d66647-52crb    1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-milvus-indexnode-c6979d59b-rvm5p     1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m44s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-milvus-proxy-79997676f9-hftdf        1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m22s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-milvus-querycoord-5d94f97dc4-tv52n   1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m43s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-milvus-querynode-59b9bd7c8b-7qljj    1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m26s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-milvus-rootcoord-745b9fbb68-mr7st    1/1     Running     <span style=color:#ae81ff>6</span> <span style=color:#f92672>(</span>9m36s ago<span style=color:#f92672>)</span>   13m
</span></span><span style=display:flex><span>opsxlab-minio-0                              1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-minio-1                              1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-minio-2                              1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-minio-3                              1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-bookie-0                      1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-bookie-1                      1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-bookie-2                      1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-bookie-init-7l4kh             0/1     Completed   <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-broker-0                      1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-proxy-0                       1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-pulsar-init-ntbh8             0/1     Completed   <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-recovery-0                    1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-zookeeper-0                   1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-zookeeper-1                   1/1     Running     <span style=color:#ae81ff>0</span>               13m
</span></span><span style=display:flex><span>opsxlab-pulsar-zookeeper-2                   1/1     Running     <span style=color:#ae81ff>0</span>               12m
</span></span></code></pre></div><p>KubeSphere ç®¡ç†æ§åˆ¶å°æŸ¥çœ‹éƒ¨ç½²çš„ç»„ä»¶ä¿¡æ¯ã€‚</p><ul><li>Depolymentï¼ˆ<strong>8 ä¸ª</strong>ï¼‰</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-deployments-v2.4.6.png alt=milvus-deployments-v2.4.6></p><ul><li>StatefulSetï¼ˆ<strong>7 ä¸ª</strong>ï¼‰</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-statefulsets-v2.4.6.png alt=milvus-statefulsets-v2.4.6></p><ul><li>Servicesï¼ˆ<strong>17 ä¸ª</strong>ï¼‰</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-services-v2.4.6.png alt=milvus-services-v2.4.6></p><p>ä»ä¸Šé¢çš„ Deploymentã€StatefulSetã€Services èµ„æºæ•°é‡æ¥çœ‹ï¼Œé»˜è®¤éƒ¨ç½²çš„ Milvus ç»„ä»¶è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼ŒåæœŸè¿ç»´æˆæœ¬æ¯”è¾ƒé«˜ã€‚</p><h3 id=44-é…ç½®è®¤è¯å¹¶å¼€å¯å¤–éƒ¨è®¿é—®>4.4 é…ç½®è®¤è¯å¹¶å¼€å¯å¤–éƒ¨è®¿é—®</h3><p>é»˜è®¤é…ç½®éƒ¨ç½²çš„ Milvusï¼Œæ²¡æœ‰å¯ç”¨å®‰å…¨è®¤è¯ï¼Œ<strong>ä»»ä½•äººéƒ½å¯ä»¥éšæ„è¯»å†™</strong>ã€‚è¿™ä¸ç¬¦åˆç”Ÿäº§ç¯å¢ƒè¦æ±‚ï¼Œå› æ­¤ï¼Œéœ€è¦å¢åŠ è®¤è¯é…ç½®ã€‚</p><p>åˆ›å»ºå¹¶ç¼–è¾‘ Helm è‡ªå®šä¹‰ values é…ç½®æ–‡ä»¶ï¼Œ<code>vi custom-milvus.yaml</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>extraConfigFiles</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>user.yaml</span>: |+<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    common:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      security:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        authorizationEnabled: true</span>
</span></span></code></pre></div><p>æ‰§è¡Œ helm å‘½ä»¤æ›´æ–°é…ç½®ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm upgrade opsxlab milvus/milvus --values custom-milvus.yaml -n opsxlab
</span></span></code></pre></div><blockquote><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœå®‰è£…æ—¶è‡ªå®šä¹‰äº†é•œåƒåœ°å€ï¼Œä¸Šé¢çš„æ“ä½œä¼šå¯¼è‡´æ‰€æœ‰ç»„ä»¶çš„é•œåƒåœ°å€è¢«<strong>è¿˜åŸæˆ helm é»˜è®¤å€¼</strong>ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p></blockquote><p>é»˜è®¤é…ç½®éƒ¨ç½²çš„ Milvus åªèƒ½è¢« K8s é›†ç¾¤å†…éƒ¨èµ„æºè®¿é—®ï¼Œå¦‚æœå¼€æ”¾ç»™é›†ç¾¤å¤–éƒ¨ï¼Œéœ€è¦å®šä¹‰å¤–éƒ¨è®¿é—®æ–¹å¼ï¼Œæœ¬æ–‡é€‰æ‹©æœ€ç®€å•çš„ NodePort æ–¹å¼ã€‚</p><p>åˆ›å»ºå¹¶ç¼–è¾‘å¤–éƒ¨è®¿é—® svc èµ„æºæ¸…å•ï¼Œ<code>vi milvus-external-svc.yaml</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>opsxlab-milvus-external</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>opsxlab</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>opsxlab-milvus-external</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>milvus</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>milvus</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>19530</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>19530</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>nodePort</span>: <span style=color:#ae81ff>31011</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/instance</span>: <span style=color:#ae81ff>opsxlab</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>milvus</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>component</span>: <span style=color:#ae81ff>proxy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterIP</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤ï¼Œåˆ›å»ºå¤–éƒ¨æœåŠ¡ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f milvus-external-svc.yaml
</span></span></code></pre></div><h3 id=45-éªŒè¯æµ‹è¯•-milvus-æœåŠ¡å¯ç”¨æ€§>4.5 éªŒè¯æµ‹è¯• Milvus æœåŠ¡å¯ç”¨æ€§</h3><p>Milvus å®˜æ–¹é»˜è®¤æä¾›äº† <code>hello_milvus.py</code> å·¥å…·ï¼Œç”¨æ¥æµ‹è¯•æ•°æ®åº“çš„è¿æ¥å’Œè¯»å†™ã€‚</p><p>å·¥å…·è·å–æ–¹å¼ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://raw.githubusercontent.com/milvus-io/pymilvus/master/examples/hello_milvus.py
</span></span></code></pre></div><p>è¯¥è„šæœ¬è¿è¡Œéœ€è¦ Python ç¯å¢ƒï¼Œä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œæˆ‘è‡ªå·±åˆ¶ä½œäº†ä¸€ä¸ª Docker é•œåƒï¼Œå¯ç”¨äºåœ¨ Dockerã€k8s ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚</p><p>åˆ›å»ºå¹¶ç¼–è¾‘ milvus æµ‹è¯• Pod èµ„æºæ¸…å•ï¼Œ<code>vi test-milvus-pod.yaml</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Pod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-milvus-pod</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>test-milvus-pod</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>opsxlab/milvus-hello:v2.3.7-amd64</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>command</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;/bin/sh&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>args</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;-c&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;sleep 86400&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>restartPolicy</span>: <span style=color:#e6db74>&#34;Never&#34;</span>
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤ï¼Œåˆ›å»ºæµ‹è¯• Podã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f test-milvus-pod.yam
</span></span></code></pre></div><p>ç™»å½•æµ‹è¯•å®¹å™¨ç»ˆç«¯ï¼ˆç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç¡®è®¤ Pod åˆ›å»ºæˆåŠŸåæ‰§è¡Œï¼‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl exec -it test-milvus-pod -- /bin/bash
</span></span></code></pre></div><p>å®˜æ–¹<code>hello_milvus.py</code> è„šæœ¬ï¼Œé»˜è®¤è¿æ¥<strong>ä¸å¸¦å¯†ç è®¤è¯</strong>çš„ Milvus é›†ç¾¤ã€‚æˆ‘ä»¬çš„é›†ç¾¤å¢åŠ äº†è®¤è¯ï¼Œéœ€è¦ä¿®æ”¹è„šæœ¬ï¼Œæ·»åŠ è®¤è¯é…ç½®ï¼Œé»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç ä¸º <code>root/Milvus</code> ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># åŸå†…å®¹ï¼ˆ32è¡Œï¼‰</span>
</span></span><span style=display:flex><span> connections<span style=color:#f92672>.</span>connect(<span style=color:#e6db74>&#34;default&#34;</span>, host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;localhost&#34;</span>, port<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;19530&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ä¿®æ”¹ä¸º</span>
</span></span><span style=display:flex><span>connections<span style=color:#f92672>.</span>connect(<span style=color:#e6db74>&#34;default&#34;</span>, host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;192.168.9.91&#34;</span>, port<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;31011&#34;</span>, user<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;root&#34;</span>, password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Milvus&#39;</span>)
</span></span></code></pre></div><p>æ‰§è¡Œæµ‹è¯•å‘½ä»¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python hello_milvus.py
</span></span></code></pre></div><p><strong>æ­£ç¡®æ‰§è¡Œåï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ :</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@test-milvus-pod:/app# python hello_milvus.py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> start connecting to Milvus     <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Does collection hello_milvus exist in Milvus: False
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Create collection <span style=color:#e6db74>`</span>hello_milvus<span style=color:#e6db74>`</span> <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start inserting entities       <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Number of entities in Milvus: 3001
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start Creating index IVF_FLAT  <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start loading                  <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start searching based on vector similarity <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hit: id: 2998, distance: 0.0, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9728033590489911<span style=color:#f92672>}</span>, random field: 0.9728033590489911
</span></span><span style=display:flex><span>hit: id: 999, distance: 0.09934990108013153, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9519034206569449<span style=color:#f92672>}</span>, random field: 0.9519034206569449
</span></span><span style=display:flex><span>hit: id: 1310, distance: 0.10135537385940552, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.26669865443188623<span style=color:#f92672>}</span>, random field: 0.26669865443188623
</span></span><span style=display:flex><span>hit: id: 2999, distance: 0.0, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.02316334456872482<span style=color:#f92672>}</span>, random field: 0.02316334456872482
</span></span><span style=display:flex><span>hit: id: 2502, distance: 0.13083189725875854, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9289998713260136<span style=color:#f92672>}</span>, random field: 0.9289998713260136
</span></span><span style=display:flex><span>hit: id: 2669, distance: 0.1590736210346222, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.6080847854541138<span style=color:#f92672>}</span>, random field: 0.6080847854541138
</span></span><span style=display:flex><span>search latency <span style=color:#f92672>=</span> 0.2742s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start querying with <span style=color:#e6db74>`</span>random &gt; 0.5<span style=color:#e6db74>`</span> <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>query result:
</span></span><span style=display:flex><span>-<span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.6378742006852851, <span style=color:#e6db74>&#39;embeddings&#39;</span>: <span style=color:#f92672>[</span>np.float32<span style=color:#f92672>(</span>0.8367804<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.20963514<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.6766955<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.39746654<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.8180806<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.1201905<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.9467144<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.6947491<span style=color:#f92672>)]</span>, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>search latency <span style=color:#f92672>=</span> 0.2361s
</span></span><span style=display:flex><span>query pagination<span style=color:#f92672>(</span>limit<span style=color:#f92672>=</span>4<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>[{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.6378742006852851, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>}</span>, <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.5763523024650556, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;100&#39;</span><span style=color:#f92672>}</span>, <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9425935891639464, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;1000&#39;</span><span style=color:#f92672>}</span>, <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.7893211256191387, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;1001&#39;</span><span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>query pagination<span style=color:#f92672>(</span>offset<span style=color:#f92672>=</span>1, limit<span style=color:#f92672>=</span>3<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>[{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.5763523024650556, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;100&#39;</span><span style=color:#f92672>}</span>, <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9425935891639464, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;1000&#39;</span><span style=color:#f92672>}</span>, <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.7893211256191387, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;1001&#39;</span><span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start hybrid searching with <span style=color:#e6db74>`</span>random &gt; 0.5<span style=color:#e6db74>`</span> <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hit: id: 2998, distance: 0.0, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9728033590489911<span style=color:#f92672>}</span>, random field: 0.9728033590489911
</span></span><span style=display:flex><span>hit: id: 999, distance: 0.09934990108013153, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9519034206569449<span style=color:#f92672>}</span>, random field: 0.9519034206569449
</span></span><span style=display:flex><span>hit: id: 1553, distance: 0.12913644313812256, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.7723335927084438<span style=color:#f92672>}</span>, random field: 0.7723335927084438
</span></span><span style=display:flex><span>hit: id: 2502, distance: 0.13083189725875854, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.9289998713260136<span style=color:#f92672>}</span>, random field: 0.9289998713260136
</span></span><span style=display:flex><span>hit: id: 2669, distance: 0.1590736210346222, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.6080847854541138<span style=color:#f92672>}</span>, random field: 0.6080847854541138
</span></span><span style=display:flex><span>hit: id: 2628, distance: 0.1914074569940567, entity: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;random&#39;</span>: 0.940077754658375<span style=color:#f92672>}</span>, random field: 0.940077754658375
</span></span><span style=display:flex><span>search latency <span style=color:#f92672>=</span> 0.2026s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Start deleting with expr <span style=color:#e6db74>`</span>pk in <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;0&#34;</span> , <span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>]</span><span style=color:#e6db74>`</span> <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>query before delete by expr<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>pk in <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;0&#34;</span> , <span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>]</span><span style=color:#e6db74>`</span> -&gt; result:
</span></span><span style=display:flex><span>-<span style=color:#f92672>{</span><span style=color:#e6db74>&#39;embeddings&#39;</span>: <span style=color:#f92672>[</span>np.float32<span style=color:#f92672>(</span>0.8367804<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.20963514<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.6766955<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.39746654<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.8180806<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.1201905<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.9467144<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.6947491<span style=color:#f92672>)]</span>, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;0&#39;</span>, <span style=color:#e6db74>&#39;random&#39;</span>: 0.6378742006852851<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>-<span style=color:#f92672>{</span><span style=color:#e6db74>&#39;embeddings&#39;</span>: <span style=color:#f92672>[</span>np.float32<span style=color:#f92672>(</span>0.27875876<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.95355743<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.976228<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.54545516<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.16776836<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.82360446<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.65080017<span style=color:#f92672>)</span>, np.float32<span style=color:#f92672>(</span>0.21096307<span style=color:#f92672>)]</span>, <span style=color:#e6db74>&#39;pk&#39;</span>: <span style=color:#e6db74>&#39;1&#39;</span>, <span style=color:#e6db74>&#39;random&#39;</span>: 0.43925103574669633<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>query after delete by expr<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>pk in <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;0&#34;</span> , <span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>]</span><span style=color:#e6db74>`</span> -&gt; result: <span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>===</span> Drop collection <span style=color:#e6db74>`</span>hello_milvus<span style=color:#e6db74>`</span> <span style=color:#f92672>===</span>
</span></span></code></pre></div><h2 id=5-éƒ¨ç½²å¯è§†åŒ–ç®¡ç†å·¥å…·-attu>5. éƒ¨ç½²å¯è§†åŒ–ç®¡ç†å·¥å…· Attu</h2><p>Milvus çš„å¯è§†åŒ–ï¼ˆGUIï¼‰ç®¡ç†å·¥å…·å®˜æ–¹æ¨è Attuã€‚å®ƒæ˜¯ä¸€æ¬¾ all-in-one çš„ Milvus ç®¡ç†å·¥å…·ã€‚ä½¿ç”¨ Attuï¼Œå¯ä»¥æ˜¾è‘—çš„é™ä½ Milvus è¿ç»´ç®¡ç†æˆæœ¬ã€‚</p><h3 id=51-å®‰è£…-attu>5.1 å®‰è£… Attu</h3><p>Milvus Helm Chart è‡ªå¸¦ Attu çš„éƒ¨ç½²èƒ½åŠ›ï¼Œé»˜è®¤æ˜¯ç¦ç”¨çš„ã€‚æˆ‘æœ¬äººæ¯”è¾ƒå–œæ¬¢æ‰‹å·¥å®‰è£…ï¼Œæ‰€ä»¥ä¸‹é¢ä»‹ç» kubectl åŸç”Ÿå®‰è£… Attu çš„æ–¹æ³•ã€‚</p><p>åˆ›å»ºå¹¶ç¼–è¾‘ Attu éƒ¨ç½²èµ„æºæ¸…å•ï¼Œ <code>vi milvus-attu.yaml</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>milvus-attu-external</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>opsxlab</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterIP</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>3000</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>3000</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>nodePort</span>: <span style=color:#ae81ff>31012</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>milvus-attu</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>opsxlab</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>image</span>: <span style=color:#ae81ff>zilliz/attu:v2.4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>IfNotPresent</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>attu</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>3000</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>MILVUS_URL</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;opsxlab-milvus:19530&#34;</span>
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤ï¼Œåˆ›å»º Attu èµ„æºã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f milvus-attu.yaml
</span></span></code></pre></div><h3 id=52-ç™»å½•-attu-ç®¡ç†æ§åˆ¶å°>5.2 ç™»å½• Attu ç®¡ç†æ§åˆ¶å°</h3><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® K8s é›†ç¾¤ä»»æ„èŠ‚ç‚¹ IP çš„ <strong>31012</strong> ç«¯å£ï¼Œä¾‹å¦‚ http://192.168.9.91:31012ï¼Œé»˜è®¤ç”¨æˆ·åå¯†ç  <code>root/Milvus</code>ã€‚<strong>ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç </strong>ã€‚</p><p>ä¸‹é¢ä»¥ä¸€ç»„ Attu ç®¡ç†ç•Œé¢çš„é¢„è§ˆæˆªå›¾ï¼Œç»“æŸæœ¬æ–‡ã€‚è¯·å„ä½è‡ªå·±æ¢ç©¶ Attu çš„å¼ºå¤§åŠŸèƒ½ã€‚</p><ul><li>ç™»å½•é¡µé¢</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-login-v2.4.png alt=milvus-attu-login-v2.4></p><ul><li>é¦–é¡µ</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-home-v2.4.png alt=milvus-attu-home-v2.4></p><ul><li>ç³»ç»Ÿè§†å›¾</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-system-v2.4.png alt=milvus-attu-system-v2.4></p><ul><li>æ•°æ®åº“-æ¦‚è§ˆ</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-databases-default-overview-v2.4.png alt=milvus-attu-databases-default-overview-v2.4></p><ul><li>æ•°æ®åº“-å‘é‡æœç´¢</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-databases-default-search-v2.4.png alt=milvus-attu-databases-default-search-v2.4></p><ul><li>æ•°æ®åº“-æ•°æ®</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-databases-default-data-v2.4.png alt=milvus-attu-databases-default-data-v2.4></p><ul><li>æ•°æ®åº“-åˆ†åŒº</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-databases-default-partitions-v2.4.png alt=milvus-attu-databases-default-partitions-v2.4></p><ul><li>æ•°æ®åº“-æ•°æ®æ®µ</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-databases-default-segments-v2.4.png alt=milvus-attu-databases-default-segments-v2.4></p><ul><li>æ•°æ®åº“-å±æ€§</li></ul><p><img src=https://opsxlab-1258881081.cos.ap-beijing.myqcloud.com//milvus-attu-databases-default-properties-v2.4.png alt=milvus-attu-databases-default-properties-v2.4></p><p><strong>å…è´£å£°æ˜ï¼š</strong></p><ul><li>ç¬”è€…æ°´å¹³æœ‰é™ï¼Œå°½ç®¡ç»è¿‡å¤šæ¬¡éªŒè¯å’Œæ£€æŸ¥ï¼Œå°½åŠ›ç¡®ä¿å†…å®¹çš„å‡†ç¡®æ€§ï¼Œ<strong>ä½†ä»å¯èƒ½å­˜åœ¨ç–æ¼ä¹‹å¤„</strong>ã€‚æ•¬è¯·ä¸šç•Œä¸“å®¶å¤§ä½¬ä¸åæŒ‡æ•™ã€‚</li><li>æœ¬æ–‡æ‰€è¿°å†…å®¹ä»…é€šè¿‡å®æˆ˜ç¯å¢ƒéªŒè¯æµ‹è¯•ï¼Œè¯»è€…å¯å­¦ä¹ ã€å€Ÿé‰´ï¼Œä½†<strong>ä¸¥ç¦ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒ</strong>ã€‚<strong>ç”±æ­¤å¼•å‘çš„ä»»ä½•é—®é¢˜ï¼Œä½œè€…æ¦‚ä¸è´Ÿè´£</strong>ï¼</li></ul></div></div><div class=share-2><div class=share><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f&text=KubeSphere%20%e9%83%a8%e7%bd%b2%e5%90%91%e9%87%8f%e6%95%b0%e6%8d%ae%e5%ba%93%20Milvus%20%e5%ae%9e%e6%88%98%e6%8c%87%e5%8d%97" target=_blank rel="noopener noreferrer"><img src=/images/share/Twitter.svg alt="twitter icon">
</a><a href="https://reddit.com/submit?url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f&title=KubeSphere%20%e9%83%a8%e7%bd%b2%e5%90%91%e9%87%8f%e6%95%b0%e6%8d%ae%e5%ba%93%20Milvus%20%e5%ae%9e%e6%88%98%e6%8c%87%e5%8d%97" target=_blank rel="noopener noreferrer"><img src=/images/share/Reddit.svg alt="reddit icon">
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Facebook.svg alt="facebook icon">
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Linkedin.svg alt="linkedin icon">
</a><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fopenksc.github.io%2fzh%2fblogs%2fdeploy-milvus-on-kubesphere%2f&t=KubeSphere%20%e9%83%a8%e7%bd%b2%e5%90%91%e9%87%8f%e6%95%b0%e6%8d%ae%e5%ba%93%20Milvus%20%e5%ae%9e%e6%88%98%e6%8c%87%e5%8d%97" target=_blank rel="noopener noreferrer"><img src=/images/share/HackerNews.svg alt="hackernews icon"></a></div></div></div><div class=aside><div class=inner-div><div class=title>ç›®å½•</div><div class=tabs><nav id=TableOfContents><ul><li><a href=#1-milvus-éƒ¨ç½²è§„åˆ’>1. Milvus éƒ¨ç½²è§„åˆ’</a></li><li><a href=#2-å‰ç½®æ¡ä»¶>2. å‰ç½®æ¡ä»¶</a><ul><li><a href=#21-ç¡¬ä»¶éœ€æ±‚>2.1 ç¡¬ä»¶éœ€æ±‚</a></li><li><a href=#22-è½¯ä»¶éœ€æ±‚>2.2 è½¯ä»¶éœ€æ±‚</a></li><li><a href=#23-ç£ç›˜éœ€æ±‚>2.3 ç£ç›˜éœ€æ±‚</a></li><li><a href=#24-kubernetes-é›†ç¾¤é…ç½®>2.4 Kubernetes é›†ç¾¤é…ç½®</a></li></ul></li><li><a href=#3-æŒä¹…åŒ–å­˜å‚¨æ€§èƒ½æµ‹è¯•>3. æŒä¹…åŒ–å­˜å‚¨æ€§èƒ½æµ‹è¯•</a><ul><li><a href=#31-åˆ›å»ºæµ‹è¯•-pvc>3.1 åˆ›å»ºæµ‹è¯• pvc</a></li><li><a href=#32-åˆ›å»ºæµ‹è¯•-pod>3.2 åˆ›å»ºæµ‹è¯• Pod</a></li><li><a href=#33-è¿æ¥æµ‹è¯•-pod-ç»ˆç«¯>3.3 è¿æ¥æµ‹è¯• Pod ç»ˆç«¯</a></li><li><a href=#34-æµ‹è¯•ç£ç›˜æ€§èƒ½>3.4 æµ‹è¯•ç£ç›˜æ€§èƒ½</a></li></ul></li><li><a href=#4-ä½¿ç”¨-helm-å®‰è£…-milvus-é›†ç¾¤>4. ä½¿ç”¨ Helm å®‰è£… Milvus é›†ç¾¤</a><ul><li><a href=#41-å®‰è£…-milvus-helm-chart>4.1 å®‰è£… Milvus Helm Chart</a></li><li><a href=#42-å®‰è£…-milvus>4.2 å®‰è£… Milvus</a></li><li><a href=#43-æŸ¥çœ‹å®‰è£…ç»“æœ>4.3 æŸ¥çœ‹å®‰è£…ç»“æœ</a></li><li><a href=#44-é…ç½®è®¤è¯å¹¶å¼€å¯å¤–éƒ¨è®¿é—®>4.4 é…ç½®è®¤è¯å¹¶å¼€å¯å¤–éƒ¨è®¿é—®</a></li><li><a href=#45-éªŒè¯æµ‹è¯•-milvus-æœåŠ¡å¯ç”¨æ€§>4.5 éªŒè¯æµ‹è¯• Milvus æœåŠ¡å¯ç”¨æ€§</a></li></ul></li><li><a href=#5-éƒ¨ç½²å¯è§†åŒ–ç®¡ç†å·¥å…·-attu>5. éƒ¨ç½²å¯è§†åŒ–ç®¡ç†å·¥å…· Attu</a><ul><li><a href=#51-å®‰è£…-attu>5.1 å®‰è£… Attu</a></li><li><a href=#52-ç™»å½•-attu-ç®¡ç†æ§åˆ¶å°>5.2 ç™»å½• Attu ç®¡ç†æ§åˆ¶å°</a></li></ul></li></ul></nav></div></div></div></div></section><div class=SubscribeForm><div class=innerBox><img class=close src=/images/home/close.svg alt=close><p class=description>é€šè¿‡é‚®ä»¶æ¥æ”¶ KubeSphere æœ€æ–°çš„æŠ€æœ¯åšå®¢ä¸äº§å“æ›´æ–°çš„é€šçŸ¥</p><div id=blog_formAddress data-actionaddress="https://www.sendcloud.net/v3/api/subInvite/subscription?invitecode=1dc5a4fb-894c-4470-b01d-ca7fa9d47a46" data-usesendcloud=true data-lang=zh><input name=EMAIL id=email-input-blog type=text placeholder>
<button id=email-submit-blog>è®¢é˜…</button>
<span id=message_blog data-message1=è¯·æä¾›æ‚¨çš„é‚®ç®± data-message2=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€! data-message3=é‚®ç®±åœ°å€å·²ç»å­˜åœ¨ style=color:red></span><span id=message1_blog style=color:#00a971 data-success=è®¢é˜…æˆåŠŸå•¦ï¼Œæˆ‘ä»¬ä¿è¯ä¸ä¼šç»™ä½ å‘åƒåœ¾é‚®ä»¶çš„å•¦></span></div></div></div><footer><div class=footer><div class="footer-main common-layout"><div class=up-main><div class=left-div><img src=/images/logo.svg alt class=foot-logo><p>é€šè¿‡é‚®ä»¶æ¥æ”¶ KubeSphere æœ€æ–°çš„æŠ€æœ¯åšå®¢ä¸äº§å“æ›´æ–°çš„é€šçŸ¥</p><div id=formAddress data-actionaddress="https://www.sendcloud.net/v3/api/subInvite/subscription?invitecode=1dc5a4fb-894c-4470-b01d-ca7fa9d47a46" data-usesendcloud=true data-lang=zh><input name=EMAIL id=email-input type=text placeholder=è¯·è¾“å…¥æ‚¨çš„é‚®ç®±åœ°å€>
<button id=email-submit>è®¢é˜…</button></div><span id=message data-message1=è¯·æä¾›æ‚¨çš„é‚®ç®± data-message2=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€! data-message3=é‚®ç®±åœ°å€å·²ç»å­˜åœ¨></span><span id=message1 style=color:#00a971 data-success=è®¢é˜…æˆåŠŸå•¦ï¼Œæˆ‘ä»¬ä¿è¯ä¸ä¼šç»™ä½ å‘åƒåœ¾é‚®ä»¶çš„å•¦></span><script>var bindSubmit=function(){var e=$("#email-input");$("#email-submit").click(function(t){t.stopPropagation();var s,o,n=e.val(),i=$("#message").data("message1"),a=$("#message").data("message2"),r=$("#message").data("message3"),c=$("#message1").data("success");if(n)if(validateEmail(n)){if(s=$("#formAddress").data("usesendcloud"),!s)return;o=$("#formAddress").data("actionaddress"),$.post({type:"post",url:o,data:{email:$("#email-input").val().toString()},success:function(){showSuccessMessage(c),setTimeout(function(){$("#email-input").val("")},1e3)},error:function(){showMessage(r)}})}else t.preventDefault(),showMessage(a);else t.preventDefault(),showMessage(i)})},validateEmail=function(e){var t=/^[A-Za-z0-9]+([_.][A-Za-z0-9]+)*@([A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/;return t.test(e)},showMessage=function(e){$("#message").html(e).show()},showSuccessMessage=function(e){$("#message1").html(e).show()},bindHideMessage=function(){$(window).click(function(){$("#message").hide(),$("#message1").hide()})},bindClose=function(){$(".formBox .close").click(function(e){e.stopPropagation(),$(".formBox").fadeOut()})};bindSubmit(),bindClose(),bindHideMessage()</script><span id=message data-message1=è¯·æä¾›æ‚¨çš„é‚®ç®± data-message2=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€!></span></div><div class=right-div><ul class=common-flex-layout><li class=nowrap-li><div class=h3>åº”ç”¨åœºæ™¯</div><a href=/zh/devops/>æ‹¥æŠ±ä¸€ç«™å¼ DevOps</a>
<a href=/zh/service-mesh/>åœ¨ K8s è¿è¡Œå¾®æœåŠ¡</a>
<a href=/zh/observability/>æ„å»ºäº‘åŸç”Ÿå¯è§‚æµ‹æ€§</a>
<a href=https://github.com/kubesphere/kubekey target=_blank rel="noopener noreferrer">K8s ä¸€é”®éƒ¨ç½²ä¸è¿ç»´</a>
<a href=https://github.com/OpenFunction/OpenFunction target=_blank rel="noopener noreferrer">æ„å»º FaaS å¹³å°ä¸ Serverless æ¶æ„</a>
<a href=https://github.com/openpitrix/openpitrix target=_blank rel="noopener noreferrer">å¤šäº‘åº”ç”¨ç®¡ç†å¹³å°</a></li><li class=nowrap-li><div class=h3>èµ„æº</div><a href=/zh/projects/>å¼€æºé¡¹ç›®</a>
<a href=/zh/blogs/>æŠ€æœ¯åšå®¢</a>
<a href=/zh/conferences/>å¼€æºå³°ä¼š</a>
<a href=/zh/videos/>è§†é¢‘èµ„æº</a>
<a href=/zh/learn/>äº‘åŸç”Ÿå®æˆ˜</a></li><li class=nowrap-li><div class=h3>æ–‡æ¡£ä¸­å¿ƒ</div><a href=/zh/docs/v4.1/01-intro/01-introduction/>äº§å“ä»‹ç»</a>
<a href=/zh/docs/v4.1/03-installation-and-upgrade/02-install-kubesphere/02-install-kubernetes-and-kubesphere/>å¦‚ä½•å®‰è£…</a>
<a href=/zh/docs/v4.1/02-quickstart/>å¿«é€Ÿå…¥é—¨</a>
<a href=/zh/docs/v3.4/reference/api-docs/>API æ–‡æ¡£</a></li><li class=nowrap-li><div class=h3>å¼€æºç¤¾åŒº</div><a href=/zh/contribution/>å‚ä¸è´¡çŒ®</a>
<a href=/zh/live/>ç¤¾åŒºæ´»åŠ¨</a>
<a href=/zh/case/>æ¡ˆä¾‹å­¦ä¹ </a>
<a href=/zh/partner/>åˆä½œä¼™ä¼´</a>
<a href=/zh/user-group/>ç”¨æˆ·å§”å‘˜ä¼š</a>
<a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md target=_blank rel="noopener noreferrer">ç‰ˆæœ¬è®¡åˆ’</a>
<a href=https://kubesphere.com.cn/ target=_blank rel="noopener noreferrer">ä¸­å›½ç«™</a>
<a href=https://ask.kubesphere.io/forum target=_blank rel="noopener noreferrer">ä¸­æ–‡è®ºå›</a>
<a href=https://kubesphere.io target=_blank rel="noopener noreferrer">å…¨çƒç«™</a></li><li class=nowrap-li><div class=h3>äº§å“ä¸æœåŠ¡</div><a href=https://aws.amazon.com/cn/quickstart/architecture/qingcloud-kubesphere/ target=_blank rel="noopener noreferrer">KubeSphere on AWS</a>
<a href=https://market.azure.cn/marketplace/apps/qingcloud.kubesphere target=_blank rel="noopener noreferrer">KubeSphere on Azure</a>
<a href=https://marketplace.digitalocean.com/apps/kubesphere target=_blank rel="noopener noreferrer">KubeSphere on DigitalOcean</a>
<a href=https://www.qingcloud.com/products/kubesphereqke target=_blank rel="noopener noreferrer">KubeSphere on QingCloud(QKE)</a>
<a href=https://kubesphere.com.cn/kse/ target=_blank rel="noopener noreferrer">KubeSphere ä¼ä¸šç‰ˆ</a>
<a href=https://kubesphere.cloud/ksv/ target=_blank rel="noopener noreferrer">KubeSphere è™šæ‹ŸåŒ–å¹³å°</a>
<a href=https://kubesphere.com.cn/marketplace/ target=_blank rel="noopener noreferrer">äº‘åŸç”Ÿæ‰©å±•ç»„ä»¶å¸‚åœº</a>
<a href=https://kubesphere.cloud target=_blank rel="noopener noreferrer">äº‘åŸç”Ÿåº”ç”¨æœåŠ¡å¹³å°</a>
<a href=https://m.qingcloud.com/p/aec50 target=_blank rel="noopener noreferrer">äº†è§£å•†ä¸šäº§å“ä¸å’¨è¯¢åˆä½œ</a></li></ul></div></div><div class=down-main><div class=img-div><a class=wechat href=javascript:void(0); aria-label=wechat><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28" height="28" viewBox="0 0 28 28"><defs><path id="a" d="M0 0h15.673v12.156H0z"/></defs><g fill="none" fill-rule="evenodd" transform="translate(1 1)"><circle cx="13" cy="13" r="13" stroke="#B6C2CD"/><g transform="translate(5 7)"><mask id="b" fill="#fff"><use xlink:href="#a"/></mask><path fill="currentColor" d="M15.673 7.898c0-2.061-2.173-3.74-4.619-3.74-2.59.0-4.625 1.679-4.625 3.74.0 2.066 2.035 3.738 4.625 3.738.542.0 1.09-.13 1.632-.256l1.493.776-.408-1.29c1.09-.776 1.902-1.81 1.902-2.968zm-6.119-.645c-.27.0-.541-.257-.541-.514.0-.256.27-.514.541-.514.41.0.681.258.681.514.0.257-.271.514-.681.514zm2.994.0c-.27.0-.541-.257-.541-.514.0-.256.27-.514.54-.514.41.0.681.258.681.514.0.257-.277.514-.68.514z" mask="url(#b)"/><path fill="currentColor" d="M10.602 3.674c.177.0.356.011.533.029C10.657 1.576 8.27.0 5.543.0 2.498.0.0 1.974.0 4.485c0 1.45.829 2.64 2.216 3.564l-.552 1.588 1.94-.929c.693.129 1.251.263 1.94.263.17.0.343-.005.515-.022a3.68 3.68.0 01-.172-1.104c0-2.302 2.081-4.171 4.715-4.171zM7.618 2.243c.417.0.693.263.693.66s-.276.66-.693.66c-.418.0-.835-.263-.835-.66.006-.398.423-.66.835-.66zm-3.88 1.319c-.417.0-.834-.263-.834-.66s.417-.66.834-.66c.418.0.695.263.695.66.0.392-.277.66-.695.66z" mask="url(#b)"/></g></g></svg><div class=hide-div><img src=/images/home/wechat.svg alt></div></a><a class=facebook-a href=https://www.facebook.com/kubesphere target=_blank aria-label=facebook></a><a class=twitter-a href=https://x.com/KubeSphere target=_blank aria-label=twitter rel="noopener noreferrer"></a><a class=linkedin-a href=https://www.linkedin.com/company/kubesphere/ target=_blank aria-label=linkedin rel="noopener noreferrer"></a><a class=bilibili-a href=https://space.bilibili.com/438908638 target=_blank aria-label=bilibili rel="noopener noreferrer"></a><a class=slack-a href=https://join.slack.com/t/kubesphere/shared_invite/zt-2b4t6rdb4-ico_4UJzCln_S2c1pcrIpQ target=_blank aria-label=slack rel="noopener noreferrer"></a><a class=github-a href=https://github.com/kubesphere/kubesphere target=_blank aria-label=github rel="noopener noreferrer"></a><a class=medium-a href=https://itnext.io/@kubesphere target=_blank aria-label=medium rel="noopener noreferrer"></a></div><p class=p1></p><p class=case><a href=http://www.beian.miit.gov.cn/ target=_blank rel="noopener noreferrer"><span>äº¬ICPå¤‡13019086å·</span>
</a><a target=_blank rel="noopener noreferrer" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502041003"><img src=/images/footer/case-icon.png alt=å¤‡æ¡ˆå›¾æ ‡>
<span>äº¬å…¬ç½‘å®‰å¤‡ 11010502041003å·</span></a></p></div></div></div><div class=cookie><div class=common-layout><p>æ‚¨çš„éšç§å¯¹æˆ‘ä»¬å¾ˆé‡è¦ã€‚æˆ‘ä»¬ä½¿ç”¨Cookieæ¥è®°ä½è®¢é˜…è¯¦ç»†ä¿¡æ¯ï¼Œä¼˜åŒ–ç½‘ç«™åŠŸèƒ½å¹¶äº¤ä»˜æ ¹æ®æ‚¨çš„å…´è¶£é‡èº«å®šåˆ¶çš„å†…å®¹ã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„<a href=/zh/privacy>éšç§æ”¿ç­–</a>.</p><button>
æ¥å—å¹¶ç»§ç»­</button></div></div></footer><script>var lazyLoad=function(e,t){for(var n,o,i,s=0;s<t;s++){if(n=e.eq(s),o=n.attr("data-loaded"),o)continue;n.offset().top<parseInt($(window).height())+parseInt($(window).scrollTop())&&(i=n.attr("src"),n.attr("src",i),n.attr("data-loaded",!0))}},bindLayLoad=function(){var e=$("img"),t=e.length;lazyLoad(e,t),$(window).scroll(function(){lazyLoad(e,t)})},bindAddPadding=function(){var e=$("#close-join");e.length>0&&$(".main-section").addClass("padding")},docCookies={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t){return!!e&&!/^(?:expires|max-age|path|domain|secure)$/i.test(e)&&(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t),!0)}},bindHideCookie=function(){var t=docCookies.getItem("hasAuth"),e=$(".cookie");t?e.hide():e.show(),e.find("button").on("click",function(){docCookies.setItem("hasAuth","1"),e.hide()})};bindAddPadding(),bindHideCookie()</script><script type=text/javascript src=/js/aside.2d6977c0f16aef4ed3e886dd66675ce74bd0efcd467c2b2bcdb30b92d5e7c7c0e5c6e0c9d8f09a883c22f58df9e6b0b6347fcdd3c9a920b7faba6d7f91a201c3.js integrity="sha512-LWl3wPFq707T6IbdZmdc50vQ781GfCsrzbMLktXnx8DlxuDJ2PCaiDwi9Y355rC2NH/N08mpILf6um1/kaIBww=="></script><script type=text/javascript src=/js/markdown-tab.17f9f46b021adebc7250ce1b07134a577b307e7a436daa4aaf388f218e8463966f53770b26a64817c06c168738a887672d47fb4c29615adfc446e11d09a344cf.js integrity="sha512-F/n0awIa3rxyUM4bBxNKV3swfnpDbapKrziPIY6EY5ZvU3cLJqZIF8BsFoc4qIdnLUf7TClhWt/ERuEdCaNEzw=="></script><script>let forbidForm=!1;var viewer=new Viewer(document.querySelector(".md-body"),{url:"src"}),blogBindSubmit=function(){var e=$("#email-input-blog");$("#email-submit-blog").click(function(t){t.stopPropagation();var s,o,n=e.val(),i=$("#message_blog").data("message1"),a=$("#message_blog").data("message2"),r=$("#message_blog").data("message3"),c=$("#message1_blog").data("success");if(n)if(validateEmail(n)){if(s=$("#blog_formAddress").data("usesendcloud"),!s)return;o=$("#blog_formAddress").data("actionaddress"),$.post({type:"post",url:o,data:{email:n.toString()},success:function(){showSuccessMessage_blog(c),setTimeout(function(){window.onscroll="",$(".SubscribeForm").hide(),$("#email-input-blog").val("")},5e3)},error:function(){showMessage_blog(r)}})}else t.preventDefault(),$("#message_blog").html(a).show();else t.preventDefault(),$("#message_blog").html(i).show()})},validateEmail=function(e){var t=/^[A-Za-z0-9]+([_.][A-Za-z0-9]+)*@([A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/;return t.test(e)},bindHideMessageBlog=function(){$(window).click(function(){$("#message_blog").hide()})},bindCloseBlog=function(){$(".SubscribeForm .close").click(function(e){e.stopPropagation(),$(".SubscribeForm").fadeOut(),window.onscroll=""})},showMessage_blog=function(e){$("#message_blog").html(e).show()},showSuccessMessage_blog=function(e){$("#message1_blog").html(e).show()};window.onscroll=()=>{var e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.scrollHeight||document.body.scrollHeight;forbidForm&&(window.onscroll=""),e+t>n-710?$(".SubscribeForm").hide():$(".SubscribeForm").show()},blogBindSubmit(),bindCloseBlog(),bindHideMessageBlog()</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>