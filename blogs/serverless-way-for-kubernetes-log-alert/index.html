<!doctype html><html lang=en-US><head><meta charset=utf-8><title>Serverless Use Case: Elastic Kubernetes Log Alerts with OpenFunction and Kafka</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This blog post offers ideas for serverless log processing, which reduces the link cost while improving flexibility."><meta name=keywords content="OpenFunction,Serverless,KubeSphere,Kubernetes,Kafka,FaaS"><meta property="og:type" content="article"><meta property="og:title" content="Serverless Use Case: Elastic Kubernetes Log Alerts with OpenFunction and Kafka"><meta property="og:description" content="This blog post offers ideas for serverless log processing, which reduces the link cost while improving flexibility."><meta property="og:image" content="https://openksc.github.io/images/blogs/en/Serverless-way-for-Kubernetes-Log-Alerting/kubesphere%20snapshot.png"><meta property="og:url" content="https://openksc.github.io/blogs/serverless-way-for-kubernetes-log-alert/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@KubeSphere"><meta property="twitter:image" content="https://openksc.github.io/images/blogs/en/Serverless-way-for-Kubernetes-Log-Alerting/kubesphere%20snapshot.png"><meta name=docsearch:language content="en-US"><meta name=docsearch:version content><link rel=canonical href=https://kubesphere.io/blogs/serverless-way-for-kubernetes-log-alert/><link rel="shortcut icon" href=/images/favicons/favicon.ico><link rel=apple-touch-icon href=/images/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/svg+xml href=/images/favicons/favicon.svg><link rel=icon type=image/png href=/images/favicons/favicon.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg color=#00ad6e><meta name=msapplication-config content='/images/favicons/browserconfig.xml'><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/fonts/Roboto/stylesheet.css><link rel=stylesheet href=/fonts/ProximaNova/stylesheet.css><link rel=stylesheet href=/css/jquery.modal.min.css><link rel=stylesheet href=/css/viewer.min.css><link rel=stylesheet href=/swiper/swiper-bundle.min.css><link rel=stylesheet href=/scss/common.min.0c3fdcc05ec210321169846714f74b11c4a1baf09a1833fa9273b2347c81e636.css><script src=/js/jquery-3.7.1.min.js></script><script src=/js/viewer.min.js></script><script src=/js/jquery.modal.min.js></script><script src=/swiper/swiper-bundle.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?0888981f1fa45d241b1fb6962da2963e",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YYCVN36HT5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YYCVN36HT5")</script><script type=text/javascript>!function(e,t,n,s,o){e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},n=t.createElement("script"),tag=t.getElementsByTagName("script")[0],n.async=1,n.src=("https:"==document.location.protocol?"https://":"http://")+s,tag.parentNode.insertBefore(n,tag)}(window,document,"script","assets.giocdn.com/2.1/gio.js","gio"),gio("init","8a24ae300cbf8b8c",{}),gio("send")</script><script type=text/javascript>_linkedin_partner_id="3131724",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id)</script><script type=text/javascript>(function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)})()</script><noscript>&lt; img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=3131724&fmt=gif" /></noscript><script>!function(e,t,n,s,o,i){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments)},s.version="1.1",s.queue=[],o=t.createElement(n),o.async=!0,o.src="//static.ads-twitter.com/uwt.js",i=t.getElementsByTagName(n)[0],i.parentNode.insertBefore(o,i))}(window,document,"script"),twq("init","o65xa"),twq("track","PageView")</script><link rel=stylesheet href=/scss/content.min.f73b326fbf8c5bd331900b0de21c7dde608a4926f482f6465f9ae1d9049b83ad.css><link rel=stylesheet href=/scss/markdown.min.db47186481122431dffae72d17dbbd51f90b66f022cc163458645709924e4eac.css></head><body><header class=navigation><div class=join-div><div class=content>ðŸš€ KubeSphere v4.1.3 with Enhancements and Bug Fixes is available now. <a href=/docs/v4.1/20-release-notes/release-v413/ target=_blank rel="noopener noreferrer">Read the release notes â†’</a>
<img id=close-join src=/images/header/close.svg alt=close></div></div><div class=common-layout><div class=header-container><a href=/ aria-label=logo><img src=/images/header/logo.svg alt class=logo></a><ul class=nav><li class=menu-li><span class=menu-span>Scenarios</span><ul class="dropdown-menu menu-2"><li><a href=/devops/>Embracing One-stop DevOps Workflow</a></li><li><a href=/service-mesh/>Running Microservices on Kubernetes</a></li><li><a href=/observability/>Building Cloud Native Observability</a></li></ul></li><li class=menu-li><span class=menu-span>Resources</span><ul class="dropdown-menu menu-3"><li><a href=/projects/>Open Source Projects</a></li><li><a href=/conferences/>KubeCon & QCon</a></li><li><a href=/blogs/>Technology Blogs</a></li><li><a href=/videos/>Video Resources</a></li></ul></li><li class=menu-li><span class=menu-span>Documentation</span><ul class="dropdown-menu menu-4"><li><a href=/docs/v4.1>v4.1 <img src=/images/header/star.svg alt=star></a></li><li><a href=/docs/v3.4>v3.4</a></li><li><a href=/docs/v3.3>v3.3</a></li><li><a href=https://dev-guide.kubesphere.io/extension-dev-guide/en/%20 target=_blank rel="noopener noreferrer">Extension Development</a></li><li><a href=https://kube.design/ target=_blank rel="noopener noreferrer">Kube Design</a></li></ul></li><li class=menu-li><span class=menu-span>Community</span><ul class="dropdown-menu menu-5"><li><a href=/contribution/>Contribution</a></li><li><a href=/case/>Case Studies</a></li><li><a href=/partner/>Partner</a></li><li><a href=/news/>News</a></li><li><a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md target=_blank rel="noopener noreferrer">RoadMap</a></li><li><a href=https://github.com/kubesphere/community/tree/master/sig-advocacy-and-outreach/ospp-2025 target=_blank rel="noopener noreferrer">OSPP 2025</a></li></ul></li></ul><div class=right-menu><ul><li class=language-menu><div><img src=/images/header/black.svg alt>
<span>English</span></div><ul class=dropdown-menu><li onclick='handleLangClick("en","/blogs/serverless-way-for-kubernetes-log-alert/")'>English</li><li onclick='handleLangClick("zh","/zh/blogs/serverless-way-for-kubernetes-log-alert/")'>ç®€ä½“ä¸­æ–‡</li></ul></li><li class=github-li><div class=github-star><a class=star-btn href=https://github.com/kubesphere/kubesphere rel="noopener noreferrer" target=_blank><span class=star-img></span>&nbsp;<span>Star</span>
</a><a class=social-count href=https://github.com/kubesphere/kubesphere/stargazers rel="noopener noreferrer" target=_blank></a></div></li><li class=menu-icon><img src=/images/header/menu.svg alt></li></ul></div></div></div><div id=modal-for-menu class=modal><ul class=nav><li data-check=0 class=menu-li><span class=menu-span>Scenarios</span><ul class=dropdown-menu><li><a href=/devops/>Embracing One-stop DevOps Workflow</a></li><li><a href=/service-mesh/>Running Microservices on Kubernetes</a></li><li><a href=/observability/>Building Cloud Native Observability</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>Resources</span><ul class=dropdown-menu><li><a href=/projects/>Open Source Projects</a></li><li><a href=/conferences/>KubeCon & QCon</a></li><li><a href=/blogs/>Technology Blogs</a></li><li><a href=/videos/>Video Resources</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>Documentation</span><ul class=dropdown-menu><li><a href=/docs/v4.1>v4.1 <img src=/images/header/star.svg alt=star></a></li><li><a href=/docs/v3.4>v3.4</a></li><li><a href=/docs/v3.3>v3.3</a></li><li><a href=https://dev-guide.kubesphere.io/extension-dev-guide/en/%20>Extension Development</a></li><li><a href=https://kube.design/>Kube Design</a></li></ul></li><li data-check=0 class=menu-li><span class=menu-span>Community</span><ul class=dropdown-menu><li><a href=/contribution/>Contribution</a></li><li><a href=/case/>Case Studies</a></li><li><a href=/partner/>Partner</a></li><li><a href=/news/>News</a></li><li><a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md>RoadMap</a></li><li><a href=https://github.com/kubesphere/community/tree/master/sig-advocacy-and-outreach/ospp-2025>OSPP 2025</a></li></ul></li></ul><div class=link-div><a href=https://join.slack.com/t/kubesphere/shared_invite/zt-2b4t6rdb4-ico_4UJzCln_S2c1pcrIpQ target=_blank rel="noopener noreferrer" aria-label=slack><img src=/images/header/slack-hover.svg alt>
</a><a href=https://x.com/KubeSphere target=_blank rel="noopener noreferrer" aria-label=twitter><img src=/images/header/twitter-hover.svg alt>
</a><a href=https://github.com/kubesphere/kubesphere target=_blank rel="noopener noreferrer" aria-label=github><img src=/images/header/github-hover.svg alt></a></div></div></header><script>var bindNavMouseEvent,bindScrollChangeHeader,bindClickShowMenu,bindClickModalLi,bindClickClose,language,handleLangClick,githubApiLink="https://api.github.com/repos/kubesphere/kubesphere",getStar=function(){$(".social-count").hide(),$.getJSON(githubApiLink,function(e){$(".social-count").show().html(e.stargazers_count)})};getStar(),bindNavMouseEvent=function(e,t){t||(t=$(e));var n=!1;t.mouseenter(function(){if(n)return!1;n=!0,$(this).find(".dropdown-menu").fadeIn(200,function(){n=!1})}),t.mouseleave(function(){$(this).find(".dropdown-menu").fadeOut(200)})},bindScrollChangeHeader=function(){var t=100,e=$("header");window.addEventListener("scroll",function(){var t=window.scrollY;t>0?e.addClass("navigationScroll"):e.removeClass("navigationScroll")})},bindClickShowMenu=function(){$(".menu-icon").click(function(){$("#modal-for-menu").modal()})},bindClickModalLi=function(){$(".modal .menu-li").click(function(){var e=$(this).data("check");e===0?($(this).data("check",1),$(this).find(".dropdown-menu").slideDown(200)):($(this).data("check",0),$(this).find(".dropdown-menu").slideUp(200)),$(this).find(".menu-span").toggleClass("up")})},bindClickClose=function(){$("#close-join").click(function(){$(".navigation .join-div").hide(),$(".main-section").removeClass("padding")})},language="en",bindClickClose(),bindScrollChangeHeader(),$(".header-container .menu-li").each(function(){bindNavMouseEvent("",$(this))}),bindNavMouseEvent(".header-container .language-menu"),bindNavMouseEvent(".header-container .btn-li"),bindClickShowMenu(),bindClickModalLi(),handleLangClick=function(e,t){try{localStorage.setItem("lang",e)}catch{}location.href=t}</script><section class=main-section><div class=common-layout><div class=breadcrumb><span><a href=/blogs/>Technology Blogs</a> > </span><span>Serverless Use Case: Elastic Kubernetes Log Alerts with OpenFunction and Kafka</span></div><div class='main-div middle-div'><div class=author>Fang Tian, Bettygogo</div><span class=date>Published onï¼š2021-08-26</span>&nbsp;&nbsp;&nbsp;
<span style=font-size:14px;color:#919aa3 id=busuanzi_container_page_pv>The number of views: <span id=busuanzi_value_page_pv></span></span><h1>Serverless Use Case: Elastic Kubernetes Log Alerts with OpenFunction and Kafka</h1><div class=share-1><div class=share><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f&text=Serverless%20Use%20Case%3a%20Elastic%20Kubernetes%20Log%20Alerts%20with%20OpenFunction%20and%20Kafka" target=_blank rel="noopener noreferrer"><img src=/images/share/Twitter.svg alt="twitter icon">
</a><a href="https://reddit.com/submit?url=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f&title=Serverless%20Use%20Case%3a%20Elastic%20Kubernetes%20Log%20Alerts%20with%20OpenFunction%20and%20Kafka" target=_blank rel="noopener noreferrer"><img src=/images/share/Reddit.svg alt="reddit icon">
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Facebook.svg alt="facebook icon">
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Linkedin.svg alt="linkedin icon">
</a><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f&t=Serverless%20Use%20Case%3a%20Elastic%20Kubernetes%20Log%20Alerts%20with%20OpenFunction%20and%20Kafka" target=_blank rel="noopener noreferrer"><img src=/images/share/HackerNews.svg alt="hackernews icon"></a></div></div><div class=content><div class=md-body><h2 id=overview>Overview</h2><p>How do you handle container logs collected by the message server? You may face a dilemma: Deploying a dedicated log processing workload can be costly, and it is difficult to assess the number of standby log processing workloads required when the quantity of logs fluctuates sharply. This blog post offers ideas for serverless log processing, which reduces the link cost while improving flexibility.</p><p>Our general design idea is to add a Kafka server as a log receiver, and then use the log input to the Kafka server as an event to drive the serverless workloads to handle logs. Roughly, the following steps are involved:</p><ol><li>Set up a Kafka server as the log receiver for Kubernetes clusters.</li><li>Deploy OpenFunction to provide serverless capabilities for log processing workloads.</li><li>Write log processing functions to grab specific logs to generate alerting messages.</li><li>Configure <a href=https://github.com/kubesphere/notification-manager/ target=_blank rel="noopener noreferrer">Notification Manager</a> to send alerts to Slack.</li></ol><p><img src=https://pek3b.qingstor.com/kubesphere-community/images/202108261124546.png alt></p><p>In this scenario, we will make use of the serverless capabilities of<a href=https://github.com/OpenFunction/OpenFunction target=_blank rel="noopener noreferrer"> OpenFunction</a>.</p><blockquote><p><a href=https://github.com/OpenFunction/OpenFunction target=_blank rel="noopener noreferrer">OpenFunction</a> is an open-source FaaS (serverless) project initiated by the KubeSphere community. It is designed to allow users to focus on their business logic without the hassle of caring about the underlying operating environment and infrastructure. Currently, the project provides the following key capabilities:</p><ul><li>Builds OCI images from Dockerfile or Buildpacks.</li><li>Runs serverless workloads using Knative Serving or OpenFunctionAsync (backed by KEDA + Dapr) as a runtime.</li><li>Equipped with a built-in event-driven framework.</li></ul></blockquote><h2 id=use-kafka-as-a-log-receiver>Use Kafka as a Log Receiver</h2><p>First, enable the <strong>logging</strong> component for the KubeSphere platform (For more information, please refer to<a href=https://kubesphere.io/docs/pluggable-components/ target=_blank rel="noopener noreferrer"> Enable Pluggable Components</a>. Next, we can use <a href=https://github.com/strimzi/strimzi-kafka-operator target=_blank rel="noopener noreferrer">strimzi-kafka-operator</a> to build a minimal Kafka server.</p><ol><li><p>In the <code>default</code> namespace, install <a href=https://github.com/strimzi/strimzi-kafka-operator target=_blank rel="noopener noreferrer">strimzi-kafka-operator.</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>helm repo add strimzi https://strimzi.io/charts/
</span></span><span style=display:flex><span>helm install kafka-operator -n default strimzi/strimzi-kafka-operator
</span></span></code></pre></div></li><li><p>Run the following commands to create a Kafka cluster and a Kafka topic in the <code>default</code> namespace. The storage type of the created Kafka and ZooKeeper clusters is <strong>ephemeral</strong>. Here, we use <code>emptyDir</code> for demonstration.</p><blockquote><p>Note that we have created a topic named <code>logs</code> for follow-up use.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#e6db74>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: kafka.strimzi.io/v1beta2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Kafka
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  name: kafka-logs-receiver
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  namespace: default
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  kafka:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    version: 2.8.0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    replicas: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    listeners:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      - name: plain
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        port: 9092
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        type: internal
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        tls: false
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      - name: tls
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        port: 9093
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        type: internal
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        tls: true
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    config:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      offsets.topic.replication.factor: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      transaction.state.log.replication.factor: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      transaction.state.log.min.isr: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      log.message.format.version: &#39;2.8&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      inter.broker.protocol.version: &#34;2.8&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    storage:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      type: ephemeral
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  zookeeper:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    replicas: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    storage:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      type: ephemeral
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  entityOperator:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    topicOperator: {}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    userOperator: {}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>---
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: kafka.strimzi.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: KafkaTopic
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  name: logs
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  namespace: default
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    strimzi.io/cluster: kafka-logs-receiver
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  partitions: 10
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  replicas: 3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  config:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    retention.ms: 7200000
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    segment.bytes: 1073741824
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></li><li><p>Run the following command to check the Pod's status and wait until Kafka and ZooKeeper runs and starts.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl get po
</span></span><span style=display:flex><span>NAME                                                   READY   STATUS        RESTARTS   AGE
</span></span><span style=display:flex><span>kafka-logs-receiver-entity-operator-568957ff84-nmtlw   3/3     Running       <span style=color:#ae81ff>0</span>          8m42s
</span></span><span style=display:flex><span>kafka-logs-receiver-kafka-0                            1/1     Running       <span style=color:#ae81ff>0</span>          9m13s
</span></span><span style=display:flex><span>kafka-logs-receiver-zookeeper-0                        1/1     Running       <span style=color:#ae81ff>0</span>          9m46s
</span></span><span style=display:flex><span>strimzi-cluster-operator-687fdd6f77-cwmgm              1/1     Running       <span style=color:#ae81ff>0</span>          11m
</span></span></code></pre></div><p>Run the following command to view metadata of the Kafka cluster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Starts a utility pod.</span>
</span></span><span style=display:flex><span>$ kubectl run utils --image<span style=color:#f92672>=</span>arunvelsriram/utils -i --tty --rm
</span></span><span style=display:flex><span><span style=color:#75715e># Checks metadata of the Kafka cluster.</span>
</span></span><span style=display:flex><span>$ kafkacat -L -b kafka-logs-receiver-kafka-brokers:9092
</span></span></code></pre></div></li></ol><p>Add this Kafka server as a log receiver.</p><ol><li><p>Log in to the web console of KubeSphere as <strong>admin</strong>. In the upper-left corner, choose <strong>Platform</strong> > <strong><strong>Cluster Management</strong></strong>.</p><blockquote><p>If you have enabled the <a href=https://kubesphere.io/docs/multicluster-management/ target=_blank rel="noopener noreferrer">multi-cluster feature</a>, you need to select a cluster.</p></blockquote></li><li><p>On the <strong><strong>Cluster Management</strong></strong> page, click <strong>Log Collections</strong> under <strong><strong>Cluster Settings</strong></strong>.</p></li><li><p>Click <strong>Add Log Receiver,</strong> and then click <strong>Kafka</strong>. Enter the service address and port number of Kafka, and then click <strong><strong>OK</strong></strong>.</p></li></ol><p><img src=/images/blogs/en/Serverless-way-for-Kubernetes-Log-Alerting/add-log-receiver.png alt=add-log-receiver></p><ol start=4><li><p>Run the following commands to verify that Kafka clusters can collect logs from Fluent Bit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Starts a utility pod.</span>
</span></span><span style=display:flex><span>$ kubectl run utils --image<span style=color:#f92672>=</span>arunvelsriram/utils -i --tty --rm 
</span></span><span style=display:flex><span><span style=color:#75715e># Checks logs in the `logs` topic</span>
</span></span><span style=display:flex><span>$ kafkacat -C -b kafka-logs-receiver-kafka-0.kafka-logs-receiver-kafka-brokers.default.svc:9092 -t logs
</span></span></code></pre></div></li></ol><h2 id=deploy-openfunction>Deploy OpenFunction</h2><p>According to the design in Overview, we need to deploy OpenFunction first. As OpenFunction has referenced multiple third-party projects, such as Knative, Tekton, ShipWright, Dapr, and KEDA, it is cumbersome if you manually deploy it. It is recommended that you refer to <a href=https://github.com/OpenFunction/OpenFunction#prerequisites target=_blank rel="noopener noreferrer">Prerequisites</a> to quickly deploy dependencies of OpenFunction.</p><blockquote><p>In the command, <code>--with-shipwright</code> means that Shipwright is deployed as the build driver for the function; <code>--with-openFuncAsync</code> means that OpenFuncAsync Runtime is deployed as the load driver for the function. When you have limited access to GitHub and Google, you can add the <code>--poor-network</code> parameter to download related components.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sh hack/deploy.sh --with-shipwright --with-openFuncAsync --poor-network
</span></span></code></pre></div><p>Deploy OpenFunction.</p><blockquote><p>We install the latest stable version here. Alternatively, you can use the development version. For more information, please refer to the<a href=https://github.com/OpenFunction/OpenFunction#install target=_blank rel="noopener noreferrer"> Install OpenFunction</a> section.</p><p>To make sure that Shipwright works properly, we provide a default build policy, and you can run the following commands to set the policy.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/OpenFunction/OpenFunction/main/config/strategy/openfunction.yaml
</span></span></code></pre></div></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl apply -f https://github.com/OpenFunction/OpenFunction/releases/download/v0.3.0/bundle.yaml
</span></span></code></pre></div><h2 id=write-a-log-processing-function>Write a Log Processing Function</h2><p>In this example, we install WordPress as the log producer. The application's workload resides in the <code>demo-project</code> namespace and the Pod's name is <code>wordpress-v1-f54f697c5-hdn2z</code>.</p><p>When a request returns <strong>404</strong>, the log content is as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{<span style=color:#f92672>&#34;@timestamp&#34;</span>:<span style=color:#ae81ff>1629856477.226758</span>,<span style=color:#f92672>&#34;log&#34;</span>:<span style=color:#e6db74>&#34;*.*.*.* - - [25/Aug/2021:01:54:36 +0000] \&#34;GET /notfound HTTP/1.1\&#34; 404 49923 \&#34;-\&#34; \&#34;curl/7.58.0\&#34;\n&#34;</span>,<span style=color:#f92672>&#34;time&#34;</span>:<span style=color:#e6db74>&#34;2021-08-25T01:54:37.226757612Z&#34;</span>,<span style=color:#f92672>&#34;kubernetes&#34;</span>:{<span style=color:#f92672>&#34;pod_name&#34;</span>:<span style=color:#e6db74>&#34;wordpress-v1-f54f697c5-hdn2z&#34;</span>,<span style=color:#f92672>&#34;namespace_name&#34;</span>:<span style=color:#e6db74>&#34;demo-project&#34;</span>,<span style=color:#f92672>&#34;container_name&#34;</span>:<span style=color:#e6db74>&#34;container-nrdsp1&#34;</span>,<span style=color:#f92672>&#34;docker_id&#34;</span>:<span style=color:#e6db74>&#34;bb7b48e2883be0c05b22c04b1d1573729dd06223ae0b1676e33a4fac655958a5&#34;</span>,<span style=color:#f92672>&#34;container_image&#34;</span>:<span style=color:#e6db74>&#34;wordpress:4.8-apache&#34;</span>}}
</span></span></code></pre></div><p>Here are our needs: When a request returns <strong>404</strong>, the Notification Manager sends a notification to the receiver (Configure a Slack alert receiver according to <a href=https://kubesphere.io/docs/cluster-administration/platform-settings/notification-management/configure-slack/ target=_blank rel="noopener noreferrer">Configure Slack Notifications</a>, and records the namespace, Pod name, request path, request method, and other information. Therefore, we write a simple function:</p><blockquote><p>You can learn how to use <code>openfunction-context</code> from <a href=https://github.com/OpenFunction/functions-framework/blob/main/docs/v0.3.0/OpenFunction-context-specs.md target=_blank rel="noopener noreferrer">OpenFunction Context Spec,</a> which is a tool library provided by OpenFunction for writing functions. You can learn more about OpenFunction functions from <a href=https://github.com/OpenFunction/samples target=_blank rel="noopener noreferrer">OpenFunction Samples.</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>logshandler</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;encoding/json&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;log&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;regexp&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ofctx</span> <span style=color:#e6db74>&#34;github.com/OpenFunction/functions-framework-go/openfunction-context&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>alert</span> <span style=color:#e6db74>&#34;github.com/prometheus/alertmanager/template&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> (
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>HTTPCodeNotFound</span> = <span style=color:#e6db74>&#34;404&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Namespace</span>        = <span style=color:#e6db74>&#34;demo-project&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>PodName</span>          = <span style=color:#e6db74>&#34;wordpress-v1-[A-Za-z0-9]{9}-[A-Za-z0-9]{5}&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>AlertName</span>        = <span style=color:#e6db74>&#34;404 Request&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Severity</span>         = <span style=color:#e6db74>&#34;warning&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// The ctx parameter of the LogHandler function provides a context handle for user functions in the cluster. For example, ctx.SendTo is used to send data to a specified destination.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// The in parameter in the LogsHandle function is used to pass byte data (if any) from the input to the function.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>LogsHandler</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ofctx</span>.<span style=color:#a6e22e>OpenFunctionContext</span>, <span style=color:#a6e22e>in</span> []<span style=color:#66d9ef>byte</span>) <span style=color:#66d9ef>int</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>content</span> <span style=color:#f92672>:=</span> string(<span style=color:#a6e22e>in</span>)
</span></span><span style=display:flex><span>	<span style=color:#75715e>// We set three regular expressions here for matching the HTTP status code, resource namespace, and Pod name of resources, respectively.</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>matchHTTPCode</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>MatchString</span>(<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34; %s &#34;</span>, <span style=color:#a6e22e>HTTPCodeNotFound</span>), <span style=color:#a6e22e>content</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>matchNamespace</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>MatchString</span>(<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;namespace_name\&#34;:\&#34;%s&#34;</span>, <span style=color:#a6e22e>Namespace</span>), <span style=color:#a6e22e>content</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>matchPodName</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>MustCompile</span>(<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>`(%s)`</span>, <span style=color:#a6e22e>PodName</span>)).<span style=color:#a6e22e>FindStringSubmatch</span>(<span style=color:#a6e22e>content</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>matchHTTPCode</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>matchNamespace</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>matchPodName</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;Match log - Content: %s&#34;</span>, <span style=color:#a6e22e>content</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// If the input data matches all three regular expressions above, we need to extract some log information to be used in the alert.</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// The alert contains the following information: HTTP method of the 404 request, HTTP path, and Pod name.</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>match</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>MustCompile</span>(<span style=color:#e6db74>`([A-Z]+) (/\S*) HTTP`</span>).<span style=color:#a6e22e>FindStringSubmatch</span>(<span style=color:#a6e22e>content</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>match</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>500</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>path</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>match</span>[len(<span style=color:#a6e22e>match</span>)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>method</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>match</span>[len(<span style=color:#a6e22e>match</span>)<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>podName</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>matchPodName</span>[len(<span style=color:#a6e22e>matchPodName</span>)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// After we collect major information, we can use the data struct of altermanager to compose an alert.</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>notify</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>Data</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Receiver</span>:          <span style=color:#e6db74>&#34;notification_manager&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Status</span>:            <span style=color:#e6db74>&#34;firing&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Alerts</span>:            <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>Alerts</span>{},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>GroupLabels</span>:       <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>KV</span>{<span style=color:#e6db74>&#34;alertname&#34;</span>: <span style=color:#a6e22e>AlertName</span>, <span style=color:#e6db74>&#34;namespace&#34;</span>: <span style=color:#a6e22e>Namespace</span>},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>CommonLabels</span>:      <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>KV</span>{<span style=color:#e6db74>&#34;alertname&#34;</span>: <span style=color:#a6e22e>AlertName</span>, <span style=color:#e6db74>&#34;namespace&#34;</span>: <span style=color:#a6e22e>Namespace</span>, <span style=color:#e6db74>&#34;severity&#34;</span>: <span style=color:#a6e22e>Severity</span>},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>CommonAnnotations</span>: <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>KV</span>{},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>ExternalURL</span>:       <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>alt</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>Alert</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Status</span>: <span style=color:#e6db74>&#34;firing&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Labels</span>: <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>KV</span>{
</span></span><span style=display:flex><span>				<span style=color:#e6db74>&#34;alertname&#34;</span>: <span style=color:#a6e22e>AlertName</span>,
</span></span><span style=display:flex><span>				<span style=color:#e6db74>&#34;namespace&#34;</span>: <span style=color:#a6e22e>Namespace</span>,
</span></span><span style=display:flex><span>				<span style=color:#e6db74>&#34;severity&#34;</span>:  <span style=color:#a6e22e>Severity</span>,
</span></span><span style=display:flex><span>				<span style=color:#e6db74>&#34;pod&#34;</span>:       <span style=color:#a6e22e>podName</span>,
</span></span><span style=display:flex><span>				<span style=color:#e6db74>&#34;path&#34;</span>:      <span style=color:#a6e22e>path</span>,
</span></span><span style=display:flex><span>				<span style=color:#e6db74>&#34;method&#34;</span>:    <span style=color:#a6e22e>method</span>,
</span></span><span style=display:flex><span>			},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Annotations</span>:  <span style=color:#a6e22e>alert</span>.<span style=color:#a6e22e>KV</span>{},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>StartsAt</span>:     <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>(),
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>EndsAt</span>:       <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>{},
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>GeneratorURL</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Fingerprint</span>:  <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>notify</span>.<span style=color:#a6e22e>Alerts</span> = append(<span style=color:#a6e22e>notify</span>.<span style=color:#a6e22e>Alerts</span>, <span style=color:#a6e22e>alt</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>notifyBytes</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>json</span>.<span style=color:#a6e22e>Marshal</span>(<span style=color:#a6e22e>notify</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Use ctx.SendTo to send the content to the &#34;notification-manager&#34; output (you can find its definition in the following logs-handler-function.yaml function configuration file.</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>SendTo</span>(<span style=color:#a6e22e>notifyBytes</span>, <span style=color:#e6db74>&#34;notification-manager&#34;</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;Send log to notification manager.&#34;</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Upload this function to the code repository and record the <strong><strong>URL of the code repository</strong></strong> and the <strong>path of the code in the repository</strong>, which will be used in the <strong>Create a function</strong> step.</p><blockquote><p>You can find this case in <a href=https://github.com/OpenFunction/samples/tree/main/functions/async/logs-handler-function target=_blank rel="noopener noreferrer">OpenFunction Samples</a>.</p></blockquote><h2 id=create-a-function>Create a Function</h2><p>Use OpenFunction to build the above function. First, set up a key file <code>push-secret</code> to access the image repository (After the OCI image is constructed using the code, OpenFunction will upload the image to the image repository for subsequent load startup.):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>REGISTRY_SERVER<span style=color:#f92672>=</span>https://index.docker.io/v1/ REGISTRY_USER<span style=color:#f92672>=</span>&lt;your username&gt; REGISTRY_PASSWORD<span style=color:#f92672>=</span>&lt;your password&gt;
</span></span><span style=display:flex><span>kubectl create secret docker-registry push-secret <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --docker-server<span style=color:#f92672>=</span>$REGISTRY_SERVER <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --docker-username<span style=color:#f92672>=</span>$REGISTRY_USER <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --docker-password<span style=color:#f92672>=</span>$REGISTRY_PASSWORD
</span></span></code></pre></div><p>Apply the function configuration file <code>logs-handler-function.yaml</code>.</p><blockquote><p>The function definition explains the use of two key components:</p><p><a href=https://dapr.io/ target=_blank rel="noopener noreferrer">Dapr</a> shields complex middleware from applications, making it easy for the <code>logs-handler</code> function to handle Kafka events.</p><p><a href=https://keda.sh/ target=_blank rel="noopener noreferrer">KEDA</a> drives the startup of the <code>logs-handler</code> function by monitoring event traffic in the message server, and dynamically extends the <code>logs-handler</code> instance based on the consumption delay of Kafka messages.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>core.openfunction.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Function</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>logs-handler</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;v1.0.0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Defines the upload path for the built image.</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>openfunctiondev/logs-async-handler:v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>imageCredentials</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>push-secret</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>builder</span>: <span style=color:#ae81ff>openfunctiondev/go115-builder:v0.2.0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>FUNC_NAME</span>: <span style=color:#e6db74>&#34;LogsHandler&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Defines the path of the source code.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># url specifies the URL of the above-mentioned code repository.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># sourceSubPath specifies the path of the code in the repository.</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>srcRepo</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#e6db74>&#34;https://github.com/OpenFunction/samples.git&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>sourceSubPath</span>: <span style=color:#e6db74>&#34;functions/OpenFuncAsync/logs-handler-function/&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>serving</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># OpenFuncAsync is an event-driven, asynchronous runtime implemented in OpenFunction by using KEDA_Dapr.</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runtime</span>: <span style=color:#e6db74>&#34;OpenFuncAsync&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>openFuncAsync</span>:
</span></span><span style=display:flex><span>      <span style=color:#75715e># This section defines the function input (kafka-receiver) and the output (notification-manager), which correspond to definitions in the components section.</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>dapr</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-receiver</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bindings</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>notification-manager</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bindings</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>params</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>operation</span>: <span style=color:#e6db74>&#34;post&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>type</span>: <span style=color:#e6db74>&#34;bindings&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>dapr.io/log-level</span>: <span style=color:#e6db74>&#34;debug&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># This section defines the above-mentioned input and output (that is, Dapr Components).</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>components</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-receiver</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bindings.kafka</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>version</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>brokers</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;kafka-logs-receiver-kafka-brokers:9092&#34;</span>
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>authRequired</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;false&#34;</span>
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>publishTopic</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;logs&#34;</span>
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>topics</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;logs&#34;</span>
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>consumerGroup</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;logs-handler&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># This is the URL of KubeSphere notification-manager.</span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>notification-manager</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bindings.http</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>version</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>url</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#ae81ff>http://notification-manager-svc.kubesphere-monitoring-system.svc.cluster.local:19093/api/v2/alerts</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>keda</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>scaledObject</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>pollingInterval</span>: <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>minReplicaCount</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>maxReplicaCount</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>cooldownPeriod</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># This section defines the trigger of the function, that is, the log topic of the Kafka server.</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># This section also defines the message lag threshold (the value is 10), which means that when the number of lagged messages exceeds 10, the number of logs-handler instances will automatically scale out.</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>triggers</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>type</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>topic</span>: <span style=color:#ae81ff>logs</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>bootstrapServers</span>: <span style=color:#ae81ff>kafka-logs-receiver-kafka-brokers.default.svc.cluster.local:9092</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>consumerGroup</span>: <span style=color:#ae81ff>logs-handler</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>lagThreshold</span>: <span style=color:#e6db74>&#34;10&#34;</span>
</span></span></code></pre></div><h2 id=demonstrate-the-result>Demonstrate the Result</h2><p>Disable the Kafka log receiver first: On the <strong><strong>Log Collections</strong></strong> page, click <strong>Kafka</strong> to go to the details page, and choose <strong>More</strong> > <strong>Change Status</strong> > <strong>Close</strong>.</p><p>Wait for a while, and then it can be observed that number of instances of the <code>logs-handler</code> function has reduced to 0.</p><p>Then set the status of the Kafka log receiver to <strong>Collecting</strong>, and <code>logs-handler</code> also starts.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>~# kubectl get po --watch
</span></span><span style=display:flex><span>NAME                                                     READY   STATUS        RESTARTS   AGE
</span></span><span style=display:flex><span>kafka-logs-receiver-entity-operator-568957ff84-tdrrx     3/3     Running       <span style=color:#ae81ff>0</span>          7m27s
</span></span><span style=display:flex><span>kafka-logs-receiver-kafka-0                              1/1     Running       <span style=color:#ae81ff>0</span>          7m48s
</span></span><span style=display:flex><span>kafka-logs-receiver-zookeeper-0                          1/1     Running       <span style=color:#ae81ff>0</span>          8m12s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-b9d6f   2/2     Terminating   <span style=color:#ae81ff>0</span>          34s
</span></span><span style=display:flex><span>strimzi-cluster-operator-687fdd6f77-kc8cv                1/1     Running       <span style=color:#ae81ff>0</span>          10m
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-b9d6f   2/2     Terminating   <span style=color:#ae81ff>0</span>          36s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-b9d6f   0/2     Terminating   <span style=color:#ae81ff>0</span>          37s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-b9d6f   0/2     Terminating   <span style=color:#ae81ff>0</span>          38s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-b9d6f   0/2     Terminating   <span style=color:#ae81ff>0</span>          38s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-9kj2c   0/2     Pending       <span style=color:#ae81ff>0</span>          0s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-9kj2c   0/2     Pending       <span style=color:#ae81ff>0</span>          0s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-9kj2c   0/2     ContainerCreating   <span style=color:#ae81ff>0</span>          0s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-9kj2c   0/2     ContainerCreating   <span style=color:#ae81ff>0</span>          2s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-9kj2c   1/2     Running             <span style=color:#ae81ff>0</span>          4s
</span></span><span style=display:flex><span>logs-handler-serving-kpngc-v100-zcj4q-5f46996f8c-9kj2c   2/2     Running             <span style=color:#ae81ff>0</span>          11s
</span></span></code></pre></div><p>Next, initialize a request for a non-existent path of the WordPress application:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl http://&lt;wp-svc-address&gt;/notfound
</span></span></code></pre></div><p>You can see that Slack has received this message (Slack will not receive an alert message when we visit the WordPress site properly).</p><p><img src=https://i.imgur.com/YQc5uOq.png alt></p><h3 id=explore-more-possibilities>Explore More Possibilities</h3><p>We can further discuss a solution using synchronous functions:</p><p>To use Knative Serving properly, we need to set the load balancer address of its gateway. (You can use the local address as a workaround.)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Repalce the following &#34;1.2.3.4&#34; with the actual values.</span>
</span></span><span style=display:flex><span>$ kubectl patch svc -n kourier-system kourier <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-p <span style=color:#e6db74>&#39;{&#34;spec&#34;: {&#34;type&#34;: &#34;LoadBalancer&#34;, &#34;externalIPs&#34;: [&#34;1.2.3.4&#34;]}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl patch configmap/config-domain -n knative-serving <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-type merge --patch <span style=color:#e6db74>&#39;{&#34;data&#34;:{&#34;1.2.3.4.sslip.io&#34;:&#34;&#34;}}&#39;</span>
</span></span></code></pre></div><p>OpenFunction drives the running of the <code>Knative</code> function in two ways: (1) Use the Kafka server in asynchronous mode; (2) Use its own event framework to connect to the Kafka server, and then operate in Sink mode. You can refer to the case in <a href=https://github.com/OpenFunction/samples/tree/main/functions/knative/logs-handler-function target=_blank rel="noopener noreferrer">OpenFunction Samples</a>.</p><p>In this solution, the processing speed of synchronous functions is lower than that of asynchronous functions. We can also use KEDA to trigger the concurrency mechanism of Knative Serving, but it is not as convenient as asynchronous functions. (In the future, we will optimize the OpenFunction event framework to make up for the shortcomings of synchronous functions.)</p><p>It can be seen that different types of serverless functions have their unique advantages depending on task scenarios. For example, when it comes to handling an orderly control flow function, a synchronous function outperforms an asynchronous function.</p><h2 id=summary>Summary</h2><p>Serverless matches our expectations for rapid disassembly and reconstruction of business scenarios.</p><p>As you can see in this case, OpenFunction not only increases flexibility of log processing and alert notification links by using the serverless technology, but also uses a function framework to simplify complex setups typically required to connect to Kafka into semantically clear code. Moreover, we are also continuously developing OpenFunction so that components can be powered by our own serverless capabilities in follow-up releases.</p></div></div><div class=share-2><div class=share><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f&text=Serverless%20Use%20Case%3a%20Elastic%20Kubernetes%20Log%20Alerts%20with%20OpenFunction%20and%20Kafka" target=_blank rel="noopener noreferrer"><img src=/images/share/Twitter.svg alt="twitter icon">
</a><a href="https://reddit.com/submit?url=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f&title=Serverless%20Use%20Case%3a%20Elastic%20Kubernetes%20Log%20Alerts%20with%20OpenFunction%20and%20Kafka" target=_blank rel="noopener noreferrer"><img src=/images/share/Reddit.svg alt="reddit icon">
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Facebook.svg alt="facebook icon">
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f" target=_blank rel="noopener noreferrer"><img src=/images/share/Linkedin.svg alt="linkedin icon">
</a><a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fopenksc.github.io%2fblogs%2fserverless-way-for-kubernetes-log-alert%2f&t=Serverless%20Use%20Case%3a%20Elastic%20Kubernetes%20Log%20Alerts%20with%20OpenFunction%20and%20Kafka" target=_blank rel="noopener noreferrer"><img src=/images/share/HackerNews.svg alt="hackernews icon"></a></div></div></div><div class=aside><div class=inner-div><div class=title>Table of Contents</div><div class=tabs><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#use-kafka-as-a-log-receiver>Use Kafka as a Log Receiver</a></li><li><a href=#deploy-openfunction>Deploy OpenFunction</a></li><li><a href=#write-a-log-processing-function>Write a Log Processing Function</a></li><li><a href=#create-a-function>Create a Function</a></li><li><a href=#demonstrate-the-result>Demonstrate the Result</a><ul><li><a href=#explore-more-possibilities>Explore More Possibilities</a></li></ul></li><li><a href=#summary>Summary</a></li></ul></nav></div></div></div></div></section><div class=SubscribeForm><div class=innerBox><img class=close src=/images/home/close.svg alt=close><p class=description>Receive the latest news, articles and updates from KubeSphere</p><div id=blog_formAddress data-usesendcloud=false><form action="https://kubesphere.us10.list-manage.com/subscribe/post?u=c85ea2b944b08b951f607bdd4&amp;id=83f673a2d9" method=post target=_blank novalidate><input name=EMAIL id=email-input-blog type=text placeholder='Please enter your email address'>
<button type=submit id=email-submit-blog>Subscribe</button></form><span id=message_blog data-message1='email is required!' data-message2='Please enter a valid email address!'></span></div></div></div><footer><div class=footer><div class="footer-main common-layout"><div class=up-main><div class=left-div><img src=/images/logo.svg alt class=foot-logo><p>Receive the latest news, articles and updates from KubeSphere</p><div id=formAddress data-usesendcloud=false><form action="https://kubesphere.us10.list-manage.com/subscribe/post?u=c85ea2b944b08b951f607bdd4&amp;id=83f673a2d9" method=post target=_blank novalidate><input name=EMAIL id=email-input type=text placeholder='Please enter your email address'>
<button type=submit id=email-submit>Subscribe</button></form></div><span id=message data-message1='email is required!' data-message2='Please enter a valid email address!'></span>
<script>var bindSubmit=function(){var e=$("#email-input");$("#email-submit").click(function(t){t.stopPropagation();var s,o,n=e.val(),i=$("#message").data("message1"),a=$("#message").data("message2"),r=$("#message").data("message3"),c=$("#message1").data("success");if(n)if(validateEmail(n)){if(s=$("#formAddress").data("usesendcloud"),!s)return;o=$("#formAddress").data("actionaddress"),$.post({type:"post",url:o,data:{email:$("#email-input").val().toString()},success:function(){showSuccessMessage(c),setTimeout(function(){$("#email-input").val("")},1e3)},error:function(){showMessage(r)}})}else t.preventDefault(),showMessage(a);else t.preventDefault(),showMessage(i)})},validateEmail=function(e){var t=/^[A-Za-z0-9]+([_.][A-Za-z0-9]+)*@([A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/;return t.test(e)},showMessage=function(e){$("#message").html(e).show()},showSuccessMessage=function(e){$("#message1").html(e).show()},bindHideMessage=function(){$(window).click(function(){$("#message").hide(),$("#message1").hide()})},bindClose=function(){$(".formBox .close").click(function(e){e.stopPropagation(),$(".formBox").fadeOut()})};bindSubmit(),bindClose(),bindHideMessage()</script><span id=message data-message1='email is required!' data-message2='Please enter a valid email address!'></span></div><div class=right-div><ul class=common-flex-layout><li class=nowrap-li><div class=h3>Scenarios</div><a href=/devops/>Kubernetes DevOps and GitOps</a>
<a href=/service-mesh/>Microservices with Service Mesh</a>
<a href=/observability/>Cloud Native Observability</a>
<a href=https://github.com/OpenFunction/OpenFunction target=_blank rel="noopener noreferrer">Functions-as-a-Service Platform and Serverless</a>
<a href=https://github.com/openpitrix/openpitrix target=_blank rel="noopener noreferrer">Multi-cloud Apps Mgmt</a></li><li class=nowrap-li><div class=h3>Resources</div><a href=/projects/>Projects</a>
<a href=/blogs/>Blogs</a>
<a href=/conferences/>KubeCon & QCon</a>
<a href=/videos/>Videos</a></li><li class=nowrap-li><div class=h3>KubeSphere Docs</div><a href=/docs/v4.1/01-intro/01-introduction/>Introduction</a>
<a href=/docs/v4.1/03-installation-and-upgrade/02-install-kubesphere/02-install-kubernetes-and-kubesphere/>Installation</a>
<a href=/docs/v4.1/02-quickstart/>Tutorial</a>
<a href=/docs/v3.4/reference/api-docs/>API Documentation</a></li><li class=nowrap-li><div class=h3>Community</div><a href=/contribution/>Contribution</a>
<a href=/case/>Case Studies</a>
<a href=/partner/>Partners</a>
<a href=https://github.com/kubesphere/kubesphere/blob/master/docs/roadmap.md target=_blank rel="noopener noreferrer">Roadmap</a>
<a href=https://kubesphere.io target=_blank rel="noopener noreferrer">Global Site</a>
<a href=https://kubesphere.com.cn/ target=_blank rel="noopener noreferrer">China Site</a></li><li class=nowrap-li><div class=h3>Products and Services</div><a href=https://aws.amazon.com/quickstart/architecture/qingcloud-kubesphere/ target=_blank rel="noopener noreferrer">KubeSphere on AWS</a>
<a href=https://market.azure.cn/marketplace/apps/qingcloud.kubesphere target=_blank rel="noopener noreferrer">KubeSphere on Azure</a>
<a href=https://marketplace.digitalocean.com/apps/kubesphere target=_blank rel="noopener noreferrer">KubeSphere on DigitalOcean</a>
<a href=https://www.qingcloud.com/products/kubesphereqke target=_blank rel="noopener noreferrer">KubeSphere on QingCloud(QKE)</a>
<a href=https://kubesphere.co/kse/ target=_blank rel="noopener noreferrer">KubeSphere Enterprise</a>
<a href=https://kubesphere.co/marketplace/ target=_blank rel="noopener noreferrer">KubeSphere Extensions Marketplace</a>
<a href=https://kubesphere.co/ksv/ target=_blank rel="noopener noreferrer">KubeSphere Virtualization Platform</a>
<a href=https://kubesphere.cloud target=_blank rel="noopener noreferrer">Cloud Native Services and Support</a>
<a href=https://jinshuju.net/f/bDS8me target=_blank rel="noopener noreferrer">Contact Us</a></li></ul></div></div><div class=down-main><div class=img-div><a class=wechat href=javascript:void(0); aria-label=wechat><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28" height="28" viewBox="0 0 28 28"><defs><path id="a" d="M0 0h15.673v12.156H0z"/></defs><g fill="none" fill-rule="evenodd" transform="translate(1 1)"><circle cx="13" cy="13" r="13" stroke="#B6C2CD"/><g transform="translate(5 7)"><mask id="b" fill="#fff"><use xlink:href="#a"/></mask><path fill="currentColor" d="M15.673 7.898c0-2.061-2.173-3.74-4.619-3.74-2.59.0-4.625 1.679-4.625 3.74.0 2.066 2.035 3.738 4.625 3.738.542.0 1.09-.13 1.632-.256l1.493.776-.408-1.29c1.09-.776 1.902-1.81 1.902-2.968zm-6.119-.645c-.27.0-.541-.257-.541-.514.0-.256.27-.514.541-.514.41.0.681.258.681.514.0.257-.271.514-.681.514zm2.994.0c-.27.0-.541-.257-.541-.514.0-.256.27-.514.54-.514.41.0.681.258.681.514.0.257-.277.514-.68.514z" mask="url(#b)"/><path fill="currentColor" d="M10.602 3.674c.177.0.356.011.533.029C10.657 1.576 8.27.0 5.543.0 2.498.0.0 1.974.0 4.485c0 1.45.829 2.64 2.216 3.564l-.552 1.588 1.94-.929c.693.129 1.251.263 1.94.263.17.0.343-.005.515-.022a3.68 3.68.0 01-.172-1.104c0-2.302 2.081-4.171 4.715-4.171zM7.618 2.243c.417.0.693.263.693.66s-.276.66-.693.66c-.418.0-.835-.263-.835-.66.006-.398.423-.66.835-.66zm-3.88 1.319c-.417.0-.834-.263-.834-.66s.417-.66.834-.66c.418.0.695.263.695.66.0.392-.277.66-.695.66z" mask="url(#b)"/></g></g></svg><div class=hide-div><img src=/images/home/wechat.svg alt></div></a><a class=facebook-a href=https://www.facebook.com/kubesphere target=_blank aria-label=facebook></a><a class=twitter-a href=https://x.com/KubeSphere target=_blank aria-label=twitter rel="noopener noreferrer"></a><a class=linkedin-a href=https://www.linkedin.com/company/kubesphere/ target=_blank aria-label=linkedin rel="noopener noreferrer"></a><a class=youtube-a href=https://www.youtube.com/c/KubeSphere target=_blank aria-label=youtube rel="noopener noreferrer"></a><a class=slack-a href=https://join.slack.com/t/kubesphere/shared_invite/zt-2b4t6rdb4-ico_4UJzCln_S2c1pcrIpQ target=_blank aria-label=slack rel="noopener noreferrer"></a><a class=github-a href=https://github.com/kubesphere/kubesphere target=_blank aria-label=github rel="noopener noreferrer"></a><a class=medium-a href=https://itnext.io/@kubesphere target=_blank aria-label=medium rel="noopener noreferrer"></a></div><p class=p1></p></div></div></div><div class=cookie><div class=common-layout><p>Your privacy is important to us. We use cookies to remember subscription details, optimize site functionality, and deliver content tailored to your interests. To find out more, see our <a href=/privacy>privacy policy</a>.</p><button>
Accept and continue</button></div></div></footer><script>var lazyLoad=function(e,t){for(var n,o,i,s=0;s<t;s++){if(n=e.eq(s),o=n.attr("data-loaded"),o)continue;n.offset().top<parseInt($(window).height())+parseInt($(window).scrollTop())&&(i=n.attr("src"),n.attr("src",i),n.attr("data-loaded",!0))}},bindLayLoad=function(){var e=$("img"),t=e.length;lazyLoad(e,t),$(window).scroll(function(){lazyLoad(e,t)})},bindAddPadding=function(){var e=$("#close-join");e.length>0&&$(".main-section").addClass("padding")},docCookies={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t){return!!e&&!/^(?:expires|max-age|path|domain|secure)$/i.test(e)&&(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t),!0)}},bindHideCookie=function(){var t=docCookies.getItem("hasAuth"),e=$(".cookie");t?e.hide():e.show(),e.find("button").on("click",function(){docCookies.setItem("hasAuth","1"),e.hide()})};bindAddPadding(),bindHideCookie()</script><script type=text/javascript src=/js/aside.2d6977c0f16aef4ed3e886dd66675ce74bd0efcd467c2b2bcdb30b92d5e7c7c0e5c6e0c9d8f09a883c22f58df9e6b0b6347fcdd3c9a920b7faba6d7f91a201c3.js integrity="sha512-LWl3wPFq707T6IbdZmdc50vQ781GfCsrzbMLktXnx8DlxuDJ2PCaiDwi9Y355rC2NH/N08mpILf6um1/kaIBww=="></script><script type=text/javascript src=/js/markdown-tab.17f9f46b021adebc7250ce1b07134a577b307e7a436daa4aaf388f218e8463966f53770b26a64817c06c168738a887672d47fb4c29615adfc446e11d09a344cf.js integrity="sha512-F/n0awIa3rxyUM4bBxNKV3swfnpDbapKrziPIY6EY5ZvU3cLJqZIF8BsFoc4qIdnLUf7TClhWt/ERuEdCaNEzw=="></script><script>let forbidForm=!1;var viewer=new Viewer(document.querySelector(".md-body"),{url:"src"}),blogBindSubmit=function(){var e=$("#email-input-blog");$("#email-submit-blog").click(function(t){t.stopPropagation();var s,o,n=e.val(),i=$("#message_blog").data("message1"),a=$("#message_blog").data("message2"),r=$("#message_blog").data("message3"),c=$("#message1_blog").data("success");if(n)if(validateEmail(n)){if(s=$("#blog_formAddress").data("usesendcloud"),!s)return;o=$("#blog_formAddress").data("actionaddress"),$.post({type:"post",url:o,data:{email:n.toString()},success:function(){showSuccessMessage_blog(c),setTimeout(function(){window.onscroll="",$(".SubscribeForm").hide(),$("#email-input-blog").val("")},5e3)},error:function(){showMessage_blog(r)}})}else t.preventDefault(),$("#message_blog").html(a).show();else t.preventDefault(),$("#message_blog").html(i).show()})},validateEmail=function(e){var t=/^[A-Za-z0-9]+([_.][A-Za-z0-9]+)*@([A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/;return t.test(e)},bindHideMessageBlog=function(){$(window).click(function(){$("#message_blog").hide()})},bindCloseBlog=function(){$(".SubscribeForm .close").click(function(e){e.stopPropagation(),$(".SubscribeForm").fadeOut(),window.onscroll=""})},showMessage_blog=function(e){$("#message_blog").html(e).show()},showSuccessMessage_blog=function(e){$("#message1_blog").html(e).show()};window.onscroll=()=>{var e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.scrollHeight||document.body.scrollHeight;forbidForm&&(window.onscroll=""),e+t>n-710?$(".SubscribeForm").hide():$(".SubscribeForm").show()},blogBindSubmit(),bindCloseBlog(),bindHideMessageBlog()</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>